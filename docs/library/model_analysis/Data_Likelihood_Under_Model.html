<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.2.281">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>compmemlearn – data_likelihood_under_model</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../../">
  <script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../../site_libs/quarto-search/quarto-search.js"></script>
  <script src="../../site_libs/quarto-html/quarto.js"></script>
  <script src="../../site_libs/quarto-html/popper.min.js"></script>
  <script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <link rel="stylesheet" href="../../styles.css">
</head>
<body class="docked">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-light ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">compmemlearn</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">(Untitled)</h1>
      <button type="button" class="quarto-btn-toggle btn">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
  <div class="sidebar-menu-container"> 
  <ul class="list-unstyled mt-1">
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#datasets-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Datasets</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="datasets-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../../library/datasets/Murdock1962.html" class="">Murdock1962 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/MurdockOkada1970.html" class="">MurdockOkada1970 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/Lohnas2014.html" class="">Lohnas2014 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/HowaKaha05.html" class="">HowaKaha05 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/Data_Simulation.html" class="">Data Simulation</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/ClairExpt6.html" class="">ClaireExpt6 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/PEERS.html" class="">PEERS Dataset</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#models-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Models</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="models-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../../library/models/Classic_CMR.html" class="">Classic CMR</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/models/Instance_CMR.html" class="">Context Maintenance and Retrieval within an Instance-Based Architecture</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/models/Noisy_CMR.html" class="">Noisy CMR</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/models/Trace_Reinstatement_CMR.html" class="">Trace-Based Reinstatement</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#dataanalysis-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Data Analysis</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="dataanalysis-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../../library/analyses/Serial_Position_Effect.html" class="">Serial Position Effect</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Probability_of_First_Recall.html" class="">Probability of First Recall</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Lag_Contiguity_Effect.html" class="">The Lag-Contiguity Effect</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Conditional_Stop_Probability.html" class="">Conditional Stop Probability</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Alternative_Contiguity.html" class="">Alternative Contiguity Analysis</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Recall_Probability_by_Spacing.html" class="">Recall Probability by Spacing</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Serial_Position_Effect_in_Repetition_Datasets.html" class="">Measuring the Serial Position Effect in Repetition Data</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Probability_of_First_Recall_in_Repetition_Data.html" class="">Probability of First Recall in Repetition Data</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#modelanalysis-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Model Analysis</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="modelanalysis-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../../library/model_analysis/Data_Likelihood_Under_Model.html" class="active">Data Likelihood Under Model</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/model_analysis/Contiguity_Tracing.html" class="">Contiguity Tracing</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/model_analysis/Model_Characterization.html" class="">Model Characterization</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
  </ul>
  </div>
</nav>
<!-- toc -->
    <nav id="TOC" role="doc-toc" class="sidebar sidebar-toc">
<h2 id="toc-title">On this page</h2>
<ul>
<li><a href="#data-likelihood-under-model" class="nav-link active" data-scroll-target="#data-likelihood-under-model">Data Likelihood Under Model</a>
<ul class="collapse">
<li><a href="#testing-the-likelihood-functions" class="nav-link" data-scroll-target="#testing-the-likelihood-functions">Testing the Likelihood Functions</a>
<ul class="collapse">
<li><a href="#murdock_data_likelihood" class="nav-link" data-scroll-target="#murdock_data_likelihood"><code>murdock_data_likelihood</code></a></li>
<li><a href="#lohnas_data_likelihood" class="nav-link" data-scroll-target="#lohnas_data_likelihood"><code>lohnas_data_likelihood</code></a></li>
</ul></li>
<li><a href="#fitting-pure-lists-with-murdock_data_likelihood" class="nav-link" data-scroll-target="#fitting-pure-lists-with-murdock_data_likelihood">Fitting Pure Lists with <code>murdock_data_likelihood</code></a>
<ul class="collapse">
<li><a href="#loading-and-optimizing-along-cost-function" class="nav-link" data-scroll-target="#loading-and-optimizing-along-cost-function">Loading and Optimizing Along Cost Function</a></li>
<li><a href="#visualizing-fit" class="nav-link" data-scroll-target="#visualizing-fit">Visualizing Fit</a></li>
<li><a href="#why-arent-the-fits-better" class="nav-link" data-scroll-target="#why-arent-the-fits-better">Why aren’t the fits better?</a></li>
</ul></li>
<li><a href="#fitting-pure-lists-with-lohnas_data_likelihood" class="nav-link" data-scroll-target="#fitting-pure-lists-with-lohnas_data_likelihood">Fitting Pure Lists with <code>lohnas_data_likelihood</code></a>
<ul class="collapse">
<li><a href="#loading-and-optimizing-along-cost-function-1" class="nav-link" data-scroll-target="#loading-and-optimizing-along-cost-function-1">Loading and Optimizing Along Cost Function</a></li>
<li><a href="#lets-compare-this-result-with-what-wed-obtain-if-we-fit-using-murdock_data_likelihood." class="nav-link" data-scroll-target="#lets-compare-this-result-with-what-wed-obtain-if-we-fit-using-murdock_data_likelihood.">Let’s compare this result with what we’d obtain if we fit using <code>murdock_data_likelihood</code>.</a></li>
</ul></li>
<li><a href="#fitting-mixed-lists-with-lohnas_data_likelihood" class="nav-link" data-scroll-target="#fitting-mixed-lists-with-lohnas_data_likelihood">Fitting Mixed Lists with <code>lohnas_data_likelihood</code></a>
<ul class="collapse">
<li><a href="#loading-and-optimizing-along-cost-function-2" class="nav-link" data-scroll-target="#loading-and-optimizing-along-cost-function-2">Loading and Optimizing Along Cost Function</a></li>
<li><a href="#all-conditions" class="nav-link" data-scroll-target="#all-conditions">All Conditions</a></li>
<li><a href="#differential-encoding" class="nav-link" data-scroll-target="#differential-encoding">Differential Encoding</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<!-- main -->
<main class="content">

<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default_exp fitting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="data-likelihood-under-model" class="level1">
<h1>Data Likelihood Under Model</h1>
<p>To fit a model to some dataset, we select a cost function that scales against the likelihood that the model with a specified parameter configuration could have generated the specified dataset. We’ll demonstrate the process of designing a log-likelihood cost function and applying it to fit model parameters here.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># export</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hide</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit, prange</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.typed <span class="im">import</span> Dict</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.core <span class="im">import</span> types</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>, parallel<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> murdock_data_likelihood(data_to_fit, item_counts, model_class, parameters):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> prange(<span class="bu">len</span>(item_counts)):</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> item_counts[i]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        trials <span class="op">=</span> data_to_fit[i]</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        likelihood <span class="op">=</span> np.ones((<span class="bu">len</span>(trials), item_count))</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, item_count, parameters)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trials)):</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            trial <span class="op">=</span> trials[trial_index]</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            model.force_recall()</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> recall_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trial) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                <span class="co"># identify index of item recalled; if zero then recall is over</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> recall_index <span class="op">==</span> <span class="bu">len</span>(trial) <span class="kw">and</span> <span class="bu">len</span>(trial) <span class="op">&lt;</span> item_count:</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                    recall <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                    recall <span class="op">=</span> trial[recall_index]</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>                <span class="co"># store probability of and simulate recall of indexed item </span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>                likelihood[trial_index, recall_index] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>                    model.outcome_probabilities()[recall] <span class="op">+</span> <span class="fl">10e-7</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> recall <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                model.force_recall(recall)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># reset model to its pre-retrieval (but post-encoding) state</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            model.force_recall(<span class="dv">0</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        result <span class="op">-=</span> np.<span class="bu">sum</span>(np.log(likelihood))</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> murdock_objective_function(data_to_fit, item_counts, model_class, fixed_parameters, free_parameters):</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="co">    Configures cmr_likelihood for search over specified free/fixed parameters.</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> Dict.empty(key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, value <span class="kw">in</span> fixed_parameters.items():</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        parameters[name] <span class="op">=</span> value</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> objective_function(x):</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(free_parameters)):</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>            parameters[free_parameters[i]] <span class="op">=</span> x[i]</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> murdock_data_likelihood(data_to_fit, item_counts, model_class, parameters)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> objective_function</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># export</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hide</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit, prange</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.models <span class="im">import</span> Classic_CMR</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.typed <span class="im">import</span> Dict</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.core <span class="im">import</span> types</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>, parallel<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lohnas_data_likelihood(trials, presentations, model_class, parameters):</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    list_length <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    likelihood <span class="op">=</span> np.ones((<span class="bu">len</span>(trials), list_length))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index <span class="kw">in</span> prange(<span class="bu">len</span>(trials)):</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentations[trial_index])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        trial <span class="op">=</span> trials[trial_index]</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, list_length, parameters)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentations[trial_index]])</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        model.force_recall()</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> recall_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trial) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># identify index of item recalled; if zero then recall is over</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> recall_index <span class="op">==</span> <span class="bu">len</span>(trial) <span class="kw">and</span> <span class="bu">len</span>(trial) <span class="op">&lt;</span> item_count:</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                recall <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> trial[recall_index] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                recall <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                recall <span class="op">=</span> presentations[trial_index][trial[recall_index]<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># store probability of and simulate recalling item with this index</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>            likelihood[trial_index, recall_index] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                model.outcome_probabilities()[recall] <span class="op">+</span> <span class="fl">10e-7</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> recall <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>            model.force_recall(recall)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reset model to its pre-retrieval (but post-encoding) state</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        model.force_recall(<span class="dv">0</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>np.<span class="bu">sum</span>(np.log(likelihood))</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lohnas_objective_function(data_to_fit, presentations, model_class, fixed_parameters, free_parameters):</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="co">    Generates and returns an objective function for input to support search </span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="co">    through parameter space for model fit using an optimization function.</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns a function that accepts a vector x specifying arbitrary values for </span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co">    free parameters and returns evaluation of likelihood using the model </span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co">    class, all parameters, and provided data.</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> Dict.empty(key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, value <span class="kw">in</span> fixed_parameters.items():</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        parameters[name] <span class="op">=</span> value</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> objective_function(x):</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(free_parameters)):</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>            parameters[free_parameters[i]] <span class="op">=</span> x[i]</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lohnas_data_likelihood(data_to_fit, presentations, model_class, parameters)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> objective_function</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="testing-the-likelihood-functions" class="level2">
<h2 class="anchored" data-anchor-id="testing-the-likelihood-functions">Testing the Likelihood Functions</h2>
<p>We’ll make sure the likelihood functions still return expected values depending on pre-fitted parameters from our Murdock, 1962 and Lohnas &amp; Kahana, 2014 dataset analyses.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.models <span class="im">import</span> Classic_CMR</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.typed <span class="im">import</span> List, Dict</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> prepare_murdock1962_data, prepare_lohnas2014_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="murdock_data_likelihood" class="level3">
<h3 class="anchored" data-anchor-id="murdock_data_likelihood"><code>murdock_data_likelihood</code></h3>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>murd_trials0, murd_events0, murd_length0 <span class="op">=</span> prepare_murdock1962_data(<span class="st">'../../data/MurdData_clean.mat'</span>, <span class="dv">0</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>murd_trials1, murd_events1, murd_length1 <span class="op">=</span> prepare_murdock1962_data(<span class="st">'../../data/MurdData_clean.mat'</span>, <span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>murd_trials2, murd_events2, murd_length2 <span class="op">=</span> prepare_murdock1962_data(<span class="st">'../../data/MurdData_clean.mat'</span>, <span class="dv">2</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>free_parameters <span class="op">=</span> (</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>fit_values <span class="op">=</span> np.array([<span class="fl">5.88304182e-01</span>, <span class="fl">3.76144942e-02</span>, <span class="fl">7.51294302e-01</span>, <span class="fl">2.91680115e-01</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>       <span class="fl">1.00000000e+00</span>, <span class="fl">1.39633721e-01</span>, <span class="fl">5.62625588e+00</span>, <span class="fl">4.28789782e+01</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.40537436e-02</span>, <span class="fl">2.61824232e-01</span>, <span class="fl">5.32941045e+00</span>, <span class="fl">9.34036191e-01</span>])</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>cmr_parameters <span class="op">=</span> Dict.empty(key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fit_values)):</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    cmr_parameters[free_parameters[i]] <span class="op">=</span> fit_values[i]</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>cmr_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>cmr_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>cmr_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>cmr_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_cmr(item_count, presentation_count, parameters):</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Classic_CMR(item_count, presentation_count, parameters)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'murdock, 1962 == 80052.6888735279'</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(murdock_data_likelihood(</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    (murd_trials0, murd_trials1, murd_trials2), </span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    (murd_length0,murd_length1, murd_length2), </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    init_cmr, cmr_parameters))</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit murdock_data_likelihood(List([murd_trials0, murd_trials1, murd_trials2]), List([murd_length0,murd_length1, murd_length2]), init_cmr, cmr_parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>murdock, 1962 == 80052.6888735279
80052.6888735276
59.4 ms ± 961 µs per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
</section>
<section id="lohnas_data_likelihood" class="level3">
<h3 class="anchored" data-anchor-id="lohnas_data_likelihood"><code>lohnas_data_likelihood</code></h3>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_lohnas2014_data(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../../data/repFR.mat'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fit_values <span class="op">=</span> np.array([<span class="fl">8.52979921e-01</span>, <span class="fl">9.68207643e-02</span>, <span class="fl">9.64470531e-01</span>, <span class="fl">3.73838044e-02</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.22044605e-16</span>, <span class="fl">4.62850531e-01</span>, <span class="fl">3.18792422e+00</span>, <span class="fl">8.62357681e+01</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.13805131e-02</span>, <span class="fl">1.06861707e-01</span>, <span class="fl">1.18381379e+00</span>, <span class="fl">9.83789369e-01</span>])</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fit_values)):</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    cmr_parameters[free_parameters[i]] <span class="op">=</span> fit_values[i]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'lohnas, 2014 == 17271.524963186363'</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lohnas_data_likelihood(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    trials[list_types <span class="op">==</span> <span class="dv">4</span>], </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    presentations[list_types <span class="op">==</span> <span class="dv">4</span>], </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    init_cmr, cmr_parameters))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>timeit lohnas_data_likelihood(trials[list_types <span class="op">==</span> <span class="dv">4</span>], presentations[list_types <span class="op">==</span> <span class="dv">4</span>], init_cmr, cmr_parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>lohnas, 2014 == 17271.524963186363
17271.524963184707
39.4 ms ± 2.65 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
</section>
</section>
<section id="fitting-pure-lists-with-murdock_data_likelihood" class="level2">
<h2 class="anchored" data-anchor-id="fitting-pure-lists-with-murdock_data_likelihood">Fitting Pure Lists with <code>murdock_data_likelihood</code></h2>
<p>With the runtime of the cost function established, we’ll now use it with scipy’s <code>differential_evolution</code> function to find the best fit parameters for the model to the single subject we’re examining.</p>
<section id="loading-and-optimizing-along-cost-function" class="level3">
<h3 class="anchored" data-anchor-id="loading-and-optimizing-along-cost-function">Loading and Optimizing Along Cost Function</h3>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>bounds <span class="op">=</span> (</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> murdock_objective_function(</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    (murd_trials0, murd_trials1, murd_trials2), </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    (murd_length0,murd_length1, murd_length2), </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    free_parameters)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> differential_evolution(cost_function, bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 97308.5
differential_evolution step 2: f(x)= 91013.4
differential_evolution step 3: f(x)= 91013.4
differential_evolution step 4: f(x)= 91013.4
differential_evolution step 5: f(x)= 91013.4
differential_evolution step 6: f(x)= 88452
differential_evolution step 7: f(x)= 86792
differential_evolution step 8: f(x)= 84293.4
differential_evolution step 9: f(x)= 84293.4
differential_evolution step 10: f(x)= 84293.4
differential_evolution step 11: f(x)= 82942.1
differential_evolution step 12: f(x)= 82942.1
differential_evolution step 13: f(x)= 82942.1
differential_evolution step 14: f(x)= 82518
differential_evolution step 15: f(x)= 82311.4
differential_evolution step 16: f(x)= 81474.7
differential_evolution step 17: f(x)= 81474.7
differential_evolution step 18: f(x)= 81474.7
differential_evolution step 19: f(x)= 81474.7
differential_evolution step 20: f(x)= 81474.7
differential_evolution step 21: f(x)= 81474.7
differential_evolution step 22: f(x)= 81474.7
differential_evolution step 23: f(x)= 81474.7
differential_evolution step 24: f(x)= 81474.7
differential_evolution step 25: f(x)= 81474.7
differential_evolution step 26: f(x)= 81474.7
differential_evolution step 27: f(x)= 81474.7
differential_evolution step 28: f(x)= 81036.4
differential_evolution step 29: f(x)= 81036.4
differential_evolution step 30: f(x)= 81036.4
differential_evolution step 31: f(x)= 81036.4
differential_evolution step 32: f(x)= 81036.4
differential_evolution step 33: f(x)= 81036.4
differential_evolution step 34: f(x)= 81036.4
differential_evolution step 35: f(x)= 81036.4
differential_evolution step 36: f(x)= 81036.4
differential_evolution step 37: f(x)= 81036.4
differential_evolution step 38: f(x)= 80813.8
differential_evolution step 39: f(x)= 80813.8
differential_evolution step 40: f(x)= 80591.5
differential_evolution step 41: f(x)= 80591.5
     fun: 80047.41028350465
     jac: array([-1.34896253e+00,  4.80213202e-01,  1.85682437e+00, -5.99829946e+00,
       -1.40143674e+02,  3.74129741e+00,  1.29512046e-01,  0.00000000e+00,
       -1.22934580e+01, -8.96397979e-01,  4.49654183e-01, -2.86818248e+00])
 message: 'Optimization terminated successfully.'
    nfev: 9419
     nit: 41
 success: True
       x: array([6.00473229e-01, 3.32875358e-02, 7.50604203e-01, 2.27164284e-01,
       1.00000000e+00, 1.30584257e-01, 6.45835896e+00, 6.06522276e+01,
       2.40310219e-02, 2.61880252e-01, 4.39924093e+00, 9.34438836e-01])</code></pre>
</div>
</div>
<p>We expect these results:</p>
<pre><code>     fun: 80052.68887354505
     jac: array([  10.6170773 ,   17.17708073,   -2.77505022,   -2.50875019,
       -123.24599022,   17.89885574,   -2.93221094,    0.        ,
        118.13972376,   26.6605639 ,    7.70960473,    7.07950672])
 message: 'Optimization terminated successfully.'
    nfev: 7882
     nit: 36
 success: True
       x: array([5.88304182e-01, 3.76144942e-02, 7.51294302e-01, 2.91680115e-01,
       1.00000000e+00, 1.39633721e-01, 5.62625588e+00, 4.28789782e+01,
       2.40537436e-02, 2.61824232e-01, 5.32941045e+00, 9.34036191e-01])</code></pre>
<p>The <code>x</code> attribute of the result object contains the best parameter configuration found, while the <code>fun</code> attribute represents the overall cost of the configuration as computed with our specified cost function.</p>
</section>
<section id="visualizing-fit" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-fit">Visualizing Fit</h3>
<p>Next we’ll visualize the fit of the model and its parameters to the data. We’ll do this by simulating a dataset using the models and our parameters found above and plotting its simulated benchmark recall phenomena (serial position curve, lag-CRP, and probability of first recall) against the actual data. A new helper function called <code>apply_and_concatenate</code> helps streamline the process of setting up tables for comparison of an analysis outcome between simulated and real data.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># export</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> apply_and_concatenate(function, df1, df2, contrast_name<span class="op">=</span><span class="st">'contrast'</span>, labels<span class="op">=</span><span class="st">'AB'</span>):</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Concatenates the results of a function applied to two dataframes and creates a new column identifying the contrast.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat([function(df1), function(df2)], keys<span class="op">=</span>labels, names<span class="op">=</span>[contrast_name]).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now let’s create some simulated data with our model and fitted parameters.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> simulate_df</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(result.x)):</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[free_parameters[i]] <span class="op">=</span> result.x[i]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>model0 <span class="op">=</span> Classic_CMR(murd_length0, murd_length0, fitted_parameters)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> Classic_CMR(murd_length1, murd_length1, fitted_parameters)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> Classic_CMR(murd_length2, murd_length2, fitted_parameters)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>sim_df0 <span class="op">=</span> simulate_df(model0, <span class="dv">1000</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>sim_df1 <span class="op">=</span> simulate_df(model1, <span class="dv">1000</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>sim_df2 <span class="op">=</span> simulate_df(model2, <span class="dv">1000</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>true_df0 <span class="op">=</span> murd_events0.copy()</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>true_df1 <span class="op">=</span> murd_events1.copy()</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>true_df2 <span class="op">=</span> murd_events2.copy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then extract summary statistics…</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>cmr_spc0 <span class="op">=</span> apply_and_concatenate(fr.spc, sim_df0, true_df0, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cmr_lag_crp0 <span class="op">=</span> apply_and_concatenate(fr.lag_crp, sim_df0, true_df0, <span class="st">'source'</span>, [<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>cmr_pfr0 <span class="op">=</span> apply_and_concatenate(fr.pnr, sim_df0, true_df0, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>cmr_pfr0 <span class="op">=</span> cmr_pfr0.query(<span class="st">'output &lt;= 1'</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>cmr_spc1 <span class="op">=</span> apply_and_concatenate(fr.spc, sim_df1, true_df1, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>cmr_lag_crp1 <span class="op">=</span> apply_and_concatenate(fr.lag_crp, sim_df1, true_df1, <span class="st">'source'</span>, [<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>cmr_pfr1 <span class="op">=</span> apply_and_concatenate(fr.pnr, sim_df1, true_df1, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>cmr_pfr1 <span class="op">=</span> cmr_pfr1.query(<span class="st">'output &lt;= 1'</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>cmr_spc2 <span class="op">=</span> apply_and_concatenate(fr.spc, sim_df2, true_df2, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>cmr_lag_crp2 <span class="op">=</span> apply_and_concatenate(fr.lag_crp, sim_df2, true_df2, <span class="st">'source'</span>, [<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>cmr_pfr2 <span class="op">=</span> apply_and_concatenate(fr.pnr, sim_df2, true_df2, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>cmr_pfr2 <span class="op">=</span> cmr_pfr2.query(<span class="st">'output &lt;= 1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And plot the result…</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span><span class="op">/</span><span class="fl">1.5</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># serial position curve</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>], data<span class="op">=</span>cmr_spc0, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'recall'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Recall Rate'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">1</span>, murd_length0<span class="op">+</span><span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], data<span class="op">=</span>cmr_spc1, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'recall'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Recall Rate'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="dv">1</span>, murd_length1<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">2</span>], data<span class="op">=</span>cmr_spc2, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'recall'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">2</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Recall Rate'</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">2</span>].set_xticks(np.arange(<span class="dv">1</span>, murd_length2<span class="op">+</span><span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">2</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># lag CRP</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>max_lag <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>max_lag<span class="sc">}</span><span class="ss"> &lt;= lag &lt; 0'</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; lag &lt;= </span><span class="sc">{</span>max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>cmr_lag_crp0.query(filt_neg), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>cmr_lag_crp0.query(filt_pos), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Lag From Last Recalled Item'</span>, ylabel<span class="op">=</span><span class="st">'Conditional Recall Rate'</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>))</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>cmr_lag_crp1.query(filt_neg), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>cmr_lag_crp1.query(filt_pos), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"Lag From Last Recalled Item"</span>, ylabel<span class="op">=</span><span class="st">'Conditional Recall Rate'</span>)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>))</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">2</span>], data<span class="op">=</span>cmr_lag_crp2.query(filt_neg), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">2</span>], data<span class="op">=</span>cmr_lag_crp2.query(filt_pos), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">2</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Lag From Last Recalled Item'</span>, ylabel<span class="op">=</span><span class="st">'Conditional Recall Rate'</span>)</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">2</span>].set_xticks(np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>))</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">2</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>cmr_pfr0, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'prob'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Probability of First Recall'</span>)</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">1</span>, murd_length0<span class="op">+</span><span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>cmr_pfr1, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'prob'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Probability of First Recall'</span>)</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="dv">1</span>, murd_length1<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>cmr_pfr2, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'prob'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">2</span>], hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">2</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Probability of First Recall'</span>)</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">2</span>].set_xticks(np.arange(<span class="dv">1</span>, murd_length2<span class="op">+</span><span class="dv">1</span>, <span class="dv">4</span>))</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">2</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a><span class="co"># set legend of axis 2 outside the plot, to the right</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">2</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Data_Likelihood_Under_Model_files\figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="why-arent-the-fits-better" class="level3">
<h3 class="anchored" data-anchor-id="why-arent-the-fits-better">Why aren’t the fits better?</h3>
<p>The model doesn’t actually do a good job of capturing some of the quirks in the data – namely the graded probability of first recall curve in that last plot. CMR predicts a much sharper curve than the actual data and its struggle to account for something different results in worse apparent fits to other benchmark recall phenomena visualized here too. At least, that’s our best guess about what’s behind the failure.</p>
</section>
</section>
<section id="fitting-pure-lists-with-lohnas_data_likelihood" class="level2">
<h2 class="anchored" data-anchor-id="fitting-pure-lists-with-lohnas_data_likelihood">Fitting Pure Lists with <code>lohnas_data_likelihood</code></h2>
<p><code>lohnas_data_likelihood</code> is almost always slower than <code>murdock_data_likelihood</code> when it comes to fitting pure lists, but it’s useful to confirm that the functions work similarly in the use cases under which they overlap.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_lohnas2014_data(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../../data/repFR.mat'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>free_parameters <span class="op">=</span> (</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="loading-and-optimizing-along-cost-function-1" class="level3">
<h3 class="anchored" data-anchor-id="loading-and-optimizing-along-cost-function-1">Loading and Optimizing Along Cost Function</h3>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>bounds <span class="op">=</span> (</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    trials[list_types <span class="op">==</span> <span class="dv">1</span>], </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    presentations[list_types <span class="op">==</span> <span class="dv">1</span>], </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    free_parameters)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>lohnas_result <span class="op">=</span> differential_evolution(cost_function, bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lohnas_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 22456.8
differential_evolution step 2: f(x)= 21794.3
differential_evolution step 3: f(x)= 21794.3
differential_evolution step 4: f(x)= 21794.3
differential_evolution step 5: f(x)= 21794.3
differential_evolution step 6: f(x)= 21794.3
differential_evolution step 7: f(x)= 21794.3
differential_evolution step 8: f(x)= 20789
differential_evolution step 9: f(x)= 20711.1
differential_evolution step 10: f(x)= 20552.2
differential_evolution step 11: f(x)= 20552.2
differential_evolution step 12: f(x)= 19784.7
differential_evolution step 13: f(x)= 19524.3
differential_evolution step 14: f(x)= 19524.3
differential_evolution step 15: f(x)= 19524.3
differential_evolution step 16: f(x)= 19262.8
differential_evolution step 17: f(x)= 19194.9
differential_evolution step 18: f(x)= 19194.9
differential_evolution step 19: f(x)= 19194.9
differential_evolution step 20: f(x)= 19194.9
differential_evolution step 21: f(x)= 19194.9
differential_evolution step 22: f(x)= 19043.8
differential_evolution step 23: f(x)= 19043.8
differential_evolution step 24: f(x)= 19038.3
differential_evolution step 25: f(x)= 19038.3
differential_evolution step 26: f(x)= 19038.3
differential_evolution step 27: f(x)= 19038.3
differential_evolution step 28: f(x)= 18939.9
differential_evolution step 29: f(x)= 18939.9
differential_evolution step 30: f(x)= 18939.9
differential_evolution step 31: f(x)= 18939.9
differential_evolution step 32: f(x)= 18878.9
differential_evolution step 33: f(x)= 18878.9
differential_evolution step 34: f(x)= 18878.9
differential_evolution step 35: f(x)= 18878.9
differential_evolution step 36: f(x)= 18878.9
differential_evolution step 37: f(x)= 18878.9
differential_evolution step 38: f(x)= 18878.9
differential_evolution step 39: f(x)= 18878.9
differential_evolution step 40: f(x)= 18878.9
     fun: 18810.058985583455
     jac: array([ 2.22415109e+01, -6.99197695e+01,  2.76399076e+01,  2.91838660e+01,
        1.67485268e+01, -4.66279741e+01, -1.05916114e+01,  0.00000000e+00,
        4.38329152e+01, -1.48027539e+02, -2.56040950e+00, -3.63797881e-04])
 message: 'Optimization terminated successfully.'
    nfev: 8524
     nit: 40
 success: True
       x: array([7.33635729e-01, 5.46844102e-01, 9.32757477e-01, 4.54648984e-01,
       5.28712166e-02, 1.00000000e+00, 5.75890108e-01, 8.17565974e+01,
       2.52220993e-02, 8.70307405e-02, 6.42673177e+00, 2.22044605e-16])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> simulate_df</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lohnas_result.x)):</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[free_parameters[i]] <span class="op">=</span> lohnas_result.x[i]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>model0 <span class="op">=</span> Classic_CMR(<span class="dv">40</span>, <span class="dv">40</span>, fitted_parameters)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>sim_df0 <span class="op">=</span> simulate_df(model0, <span class="dv">1000</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>true_df0 <span class="op">=</span> events.loc[events.condition<span class="op">==</span><span class="dv">1</span>]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>cmr_spc0 <span class="op">=</span> apply_and_concatenate(fr.spc, sim_df0, true_df0, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>cmr_lag_crp0 <span class="op">=</span> apply_and_concatenate(fr.lag_crp, sim_df0, true_df0, <span class="st">'source'</span>, [<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>cmr_pfr0 <span class="op">=</span> apply_and_concatenate(fr.pnr, sim_df0, true_df0, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>cmr_pfr0 <span class="op">=</span> cmr_pfr0.query(<span class="st">'output &lt;= 1'</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span><span class="op">/</span><span class="dv">3</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co"># serial position curve</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>], data<span class="op">=</span>cmr_spc0, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'recall'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Recall Rate'</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">1</span>, list_length<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co"># lag CRP</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>max_lag <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>max_lag<span class="sc">}</span><span class="ss"> &lt;= lag &lt; 0'</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; lag &lt;= </span><span class="sc">{</span>max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>cmr_lag_crp0.query(filt_neg), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>cmr_lag_crp0.query(filt_pos), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Lag From Last Recalled Item'</span>, ylabel<span class="op">=</span><span class="st">'Conditional Recall Rate'</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>))</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>cmr_pfr0, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'prob'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, ax<span class="op">=</span>axes[<span class="dv">2</span>], hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Probability of First Recall'</span>)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xticks(np.arange(<span class="dv">1</span>, list_length<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a><span class="co"># set legend of axis 2 outside the plot, to the right</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Data_Likelihood_Under_Model_files\figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="lets-compare-this-result-with-what-wed-obtain-if-we-fit-using-murdock_data_likelihood." class="level3">
<h3 class="anchored" data-anchor-id="lets-compare-this-result-with-what-wed-obtain-if-we-fit-using-murdock_data_likelihood.">Let’s compare this result with what we’d obtain if we fit using <code>murdock_data_likelihood</code>.</h3>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>bounds <span class="op">=</span> (</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> murdock_objective_function(</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    (trials[list_types<span class="op">==</span><span class="dv">1</span>], ), </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">40</span>, ), </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    free_parameters)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>murdock_result <span class="op">=</span> differential_evolution(cost_function, bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(murdock_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 25374.1
differential_evolution step 2: f(x)= 22149.1
differential_evolution step 3: f(x)= 22149.1
differential_evolution step 4: f(x)= 22149.1
differential_evolution step 5: f(x)= 22149.1
differential_evolution step 6: f(x)= 21726.2
differential_evolution step 7: f(x)= 21186.5
differential_evolution step 8: f(x)= 20212.4
differential_evolution step 9: f(x)= 20212.4
differential_evolution step 10: f(x)= 20212.4
differential_evolution step 11: f(x)= 20212.4
differential_evolution step 12: f(x)= 19736.4
differential_evolution step 13: f(x)= 19736.4
differential_evolution step 14: f(x)= 19315.3
differential_evolution step 15: f(x)= 19315.3
differential_evolution step 16: f(x)= 19310.9
differential_evolution step 17: f(x)= 19166.4
differential_evolution step 18: f(x)= 19166.4
differential_evolution step 19: f(x)= 19166.4
differential_evolution step 20: f(x)= 19166.4
differential_evolution step 21: f(x)= 19166.4
differential_evolution step 22: f(x)= 19161.6
differential_evolution step 23: f(x)= 19161.6
differential_evolution step 24: f(x)= 19136.2
differential_evolution step 25: f(x)= 19113.5
differential_evolution step 26: f(x)= 18970.4
differential_evolution step 27: f(x)= 18931.5
differential_evolution step 28: f(x)= 18931.5
differential_evolution step 29: f(x)= 18931.5
differential_evolution step 30: f(x)= 18925.5
differential_evolution step 31: f(x)= 18925.5
differential_evolution step 32: f(x)= 18925.5
differential_evolution step 33: f(x)= 18925.5
differential_evolution step 34: f(x)= 18925.5
differential_evolution step 35: f(x)= 18899.1
differential_evolution step 36: f(x)= 18899.1
differential_evolution step 37: f(x)= 18899.1
differential_evolution step 38: f(x)= 18899.1
     fun: 18807.983211993796
     jac: array([ 1.09866959e-01, -1.17142917e-01, -9.85892252e-02, -1.12049747e-01,
        1.20442564e+01, -4.45139447e+01, -2.14640749e-02,  0.00000000e+00,
        1.42608769e-01, -3.45607987e-02,  9.45874496e-03,  0.00000000e+00])
 message: 'Optimization terminated successfully.'
    nfev: 8385
     nit: 38
 success: True
       x: array([7.34343133e-01, 5.77169827e-01, 9.32322680e-01, 3.95403975e-01,
       2.22044605e-16, 1.00000000e+00, 5.52537331e-01, 5.21590857e+01,
       2.36174418e-02, 9.12284879e-02, 5.76055376e+00, 2.22044605e-16])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> simulate_df</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(murdock_result.x)):</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[free_parameters[i]] <span class="op">=</span> murdock_result.x[i]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>model0 <span class="op">=</span> Classic_CMR(<span class="dv">40</span>, <span class="dv">40</span>, fitted_parameters)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>sim_df0 <span class="op">=</span> simulate_df(model0, <span class="dv">1000</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>true_df0 <span class="op">=</span> events.loc[events.condition<span class="op">==</span><span class="dv">1</span>]</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>cmr_spc0 <span class="op">=</span> apply_and_concatenate(fr.spc, sim_df0, true_df0, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>cmr_lag_crp0 <span class="op">=</span> apply_and_concatenate(fr.lag_crp, sim_df0, true_df0, <span class="st">'source'</span>, [<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>cmr_pfr0 <span class="op">=</span> apply_and_concatenate(fr.pnr, sim_df0, true_df0, contrast_name<span class="op">=</span><span class="st">'source'</span>, labels<span class="op">=</span>[<span class="st">'PrototypeCMR'</span>, <span class="st">'data'</span>])</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>cmr_pfr0 <span class="op">=</span> cmr_pfr0.query(<span class="st">'output &lt;= 1'</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span><span class="op">/</span><span class="dv">3</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># serial position curve</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>], data<span class="op">=</span>cmr_spc0, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'recall'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Recall Rate'</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">1</span>, list_length<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="co"># lag CRP</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>max_lag <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>max_lag<span class="sc">}</span><span class="ss"> &lt;= lag &lt; 0'</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; lag &lt;= </span><span class="sc">{</span>max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>cmr_lag_crp0.query(filt_neg), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>cmr_lag_crp0.query(filt_pos), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, </span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>             err_style<span class="op">=</span><span class="st">'bars'</span>, hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Lag From Last Recalled Item'</span>, ylabel<span class="op">=</span><span class="st">'Conditional Recall Rate'</span>)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">1</span>))</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data<span class="op">=</span>cmr_pfr0, x<span class="op">=</span><span class="st">'input'</span>, y<span class="op">=</span><span class="st">'prob'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, ax<span class="op">=</span>axes[<span class="dv">2</span>], hue<span class="op">=</span><span class="st">'source'</span>, legend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Study Position'</span>, ylabel<span class="op">=</span><span class="st">'Probability of First Recall'</span>)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_xticks(np.arange(<span class="dv">1</span>, list_length<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_ylim((<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a><span class="co"># set legend of axis 2 outside the plot, to the right</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Data_Likelihood_Under_Model_files\figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="fitting-mixed-lists-with-lohnas_data_likelihood" class="level2">
<h2 class="anchored" data-anchor-id="fitting-mixed-lists-with-lohnas_data_likelihood">Fitting Mixed Lists with <code>lohnas_data_likelihood</code></h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_lohnas2014_data(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../../data/repFR.mat'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>free_parameters <span class="op">=</span> (</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="loading-and-optimizing-along-cost-function-2" class="level3">
<h3 class="anchored" data-anchor-id="loading-and-optimizing-along-cost-function-2">Loading and Optimizing Along Cost Function</h3>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>bounds <span class="op">=</span> (</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    trials[list_types <span class="op">==</span> <span class="dv">4</span>], </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    presentations[list_types <span class="op">==</span> <span class="dv">4</span>], </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    free_parameters)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>lohnas_result <span class="op">=</span> differential_evolution(cost_function, bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lohnas_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 21960.7
differential_evolution step 2: f(x)= 19692
differential_evolution step 3: f(x)= 19692
differential_evolution step 4: f(x)= 19692
differential_evolution step 5: f(x)= 19692
differential_evolution step 6: f(x)= 19692
differential_evolution step 7: f(x)= 19692
differential_evolution step 8: f(x)= 19692
differential_evolution step 9: f(x)= 19106
differential_evolution step 10: f(x)= 19106
differential_evolution step 11: f(x)= 19106
differential_evolution step 12: f(x)= 19012.4
differential_evolution step 13: f(x)= 19012.4
differential_evolution step 14: f(x)= 18122.3
differential_evolution step 15: f(x)= 18122.3
differential_evolution step 16: f(x)= 18122.3
differential_evolution step 17: f(x)= 18122.3
differential_evolution step 18: f(x)= 18035.6
differential_evolution step 19: f(x)= 18035.6
differential_evolution step 20: f(x)= 17991.2
differential_evolution step 21: f(x)= 17770.7
differential_evolution step 22: f(x)= 17711
differential_evolution step 23: f(x)= 17711
differential_evolution step 24: f(x)= 17657.4
differential_evolution step 25: f(x)= 17433.7
differential_evolution step 26: f(x)= 17433.7
differential_evolution step 27: f(x)= 17433.7
differential_evolution step 28: f(x)= 17433.7
differential_evolution step 29: f(x)= 17433.7
differential_evolution step 30: f(x)= 17433.7
differential_evolution step 31: f(x)= 17433.7
differential_evolution step 32: f(x)= 17433.7
differential_evolution step 33: f(x)= 17433.7
differential_evolution step 34: f(x)= 17433.7
differential_evolution step 35: f(x)= 17433.7
differential_evolution step 36: f(x)= 17433.7
differential_evolution step 37: f(x)= 17433.7
differential_evolution step 38: f(x)= 17433.7
differential_evolution step 39: f(x)= 17360
     fun: 17170.906872565276
     jac: array([-3.17231750e-01,  4.29281499e-02,  2.78305377e-01, -1.91357685e-01,
        2.77457730e+01, -2.11002771e-02,  4.72937248e-03,  8.58562999e-02,
       -4.09636414e+00, -7.53061613e-01,  1.41881174e-02,  0.00000000e+00])
 message: 'Optimization terminated successfully.'
    nfev: 9553
     nit: 39
 success: True
       x: array([8.37481840e-01, 3.33421728e-01, 9.66834627e-01, 5.95371489e-02,
       2.22044605e-16, 4.45280033e-01, 4.47215803e+00, 4.07037005e-01,
       2.13742105e-02, 1.06866782e-01, 1.31660740e+00, 8.61694026e-09])</code></pre>
</div>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> simulate_array_from_presentations</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.analyses <span class="im">import</span> fast_rpl</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lohnas_result.x)):</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[free_parameters[j]] <span class="op">=</span> lohnas_result.x[j]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>new_sim_array <span class="op">=</span> simulate_array_from_presentations(init_cmr, fitted_parameters, presentations[list_types<span class="op">==</span><span class="dv">4</span>], experiment_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.matlib</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> fast_rpl(np.matlib.repmat(presentations[list_types<span class="op">==</span><span class="dv">4</span>], experiment_count, <span class="dv">1</span>), new_sim_array)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (result[<span class="dv">2</span>] <span class="op">+</span> result[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (result[<span class="dv">4</span>] <span class="op">+</span> result[<span class="dv">5</span>] <span class="op">+</span> result[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (result[<span class="dv">7</span>] <span class="op">+</span> result[<span class="dv">8</span>] <span class="op">+</span> result[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(binned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[0.37778061 0.45604643 0.48747679 0.50164762 0.50651667]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>fit_sources <span class="op">=</span> [<span class="st">'lohnas_4'</span>]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>fit_rpls <span class="op">=</span> [binned]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fit_sources)):</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(fit_rpls[i], label<span class="op">=</span>fit_sources[i])</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> fast_rpl(presentations[list_types<span class="op">==</span><span class="dv">4</span>], trials[list_types<span class="op">==</span><span class="dv">4</span>])</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (result[<span class="dv">2</span>] <span class="op">+</span> result[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (result[<span class="dv">4</span>] <span class="op">+</span> result[<span class="dv">5</span>] <span class="op">+</span> result[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (result[<span class="dv">7</span>] <span class="op">+</span> result[<span class="dv">8</span>] <span class="op">+</span> result[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>plt.plot(binned, label<span class="op">=</span><span class="st">'data'</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>lags <span class="op">=</span> [<span class="st">'N/A'</span>, <span class="st">'0'</span>, <span class="st">'1-2'</span>, <span class="st">'3-5'</span>, <span class="st">'6-8'</span>]</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>plt.xticks(np.arange(<span class="bu">len</span>(lags)), lags)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend at 0x125811f0d90&gt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Data_Likelihood_Under_Model_files\figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="all-conditions" class="level3">
<h3 class="anchored" data-anchor-id="all-conditions">All Conditions</h3>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>bounds <span class="op">=</span> (</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    trials[list_types <span class="op">&gt;=</span> <span class="dv">1</span>], </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    presentations[list_types <span class="op">&gt;=</span> <span class="dv">1</span>], </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    free_parameters)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>lohnas_result <span class="op">=</span> differential_evolution(cost_function, bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lohnas_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 94631.7
differential_evolution step 2: f(x)= 79692.9
differential_evolution step 3: f(x)= 70885.6
differential_evolution step 4: f(x)= 69762
differential_evolution step 5: f(x)= 67176.3
differential_evolution step 6: f(x)= 67176.3
differential_evolution step 7: f(x)= 67176.3
differential_evolution step 8: f(x)= 66556.1
differential_evolution step 9: f(x)= 66556.1
differential_evolution step 10: f(x)= 65542
differential_evolution step 11: f(x)= 65542
differential_evolution step 12: f(x)= 64378.7
differential_evolution step 13: f(x)= 64378.7
differential_evolution step 14: f(x)= 63249.4
differential_evolution step 15: f(x)= 62687.4
differential_evolution step 16: f(x)= 62687.4
differential_evolution step 17: f(x)= 62365.9
differential_evolution step 18: f(x)= 62365.9
differential_evolution step 19: f(x)= 62302.4
differential_evolution step 20: f(x)= 62004.3
differential_evolution step 21: f(x)= 62004.3
differential_evolution step 22: f(x)= 62004.3
differential_evolution step 23: f(x)= 62004.3
differential_evolution step 24: f(x)= 61902.9
differential_evolution step 25: f(x)= 61902.9
differential_evolution step 26: f(x)= 61849.5
differential_evolution step 27: f(x)= 61722.5
differential_evolution step 28: f(x)= 61620.5
differential_evolution step 29: f(x)= 61620.5
differential_evolution step 30: f(x)= 61541.9
differential_evolution step 31: f(x)= 61541.9
differential_evolution step 32: f(x)= 61490
differential_evolution step 33: f(x)= 61490
differential_evolution step 34: f(x)= 61490
     fun: 60797.2210129435
     jac: array([-2.640445  , -0.65556378,  2.33558238, -2.81143002, -0.37325663,
        0.38999133, -0.0174623 ,  0.        ,  3.73474904,  5.01822797,
       -0.2757588 , -3.82788128])
 message: 'Optimization terminated successfully.'
    nfev: 8913
     nit: 34
 success: True
       x: array([8.65844790e-01, 2.26172120e-01, 9.52083253e-01, 2.63516673e-02,
       5.43072905e-07, 4.31711566e-01, 2.64505857e+00, 4.38402542e+01,
       2.51585067e-02, 1.01418425e-01, 1.02244712e+00, 9.80136664e-01])</code></pre>
</div>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> simulate_array_from_presentations</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.analyses <span class="im">import</span> fast_rpl</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lohnas_result.x)):</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[free_parameters[j]] <span class="op">=</span> lohnas_result.x[j]</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>new_sim_array <span class="op">=</span> simulate_array_from_presentations(init_cmr, fitted_parameters, presentations[list_types<span class="op">&gt;=</span><span class="dv">1</span>], experiment_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.matlib</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> fast_rpl(np.matlib.repmat(presentations[list_types<span class="op">&gt;=</span><span class="dv">1</span>], experiment_count, <span class="dv">1</span>), new_sim_array)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (result[<span class="dv">2</span>] <span class="op">+</span> result[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (result[<span class="dv">4</span>] <span class="op">+</span> result[<span class="dv">5</span>] <span class="op">+</span> result[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (result[<span class="dv">7</span>] <span class="op">+</span> result[<span class="dv">8</span>] <span class="op">+</span> result[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(binned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[0.3343702  0.60605876 0.58105782 0.58587598 0.58480437]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>fit_sources <span class="op">=</span> [<span class="st">'fit_to_full_dataset'</span>]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>fit_rpls <span class="op">=</span> [binned]</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fit_sources)):</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(fit_rpls[i], label<span class="op">=</span>fit_sources[i])</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> fast_rpl(presentations[list_types<span class="op">&gt;=</span><span class="dv">1</span>], trials[list_types<span class="op">&gt;=</span><span class="dv">1</span>])</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (result[<span class="dv">2</span>] <span class="op">+</span> result[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (result[<span class="dv">4</span>] <span class="op">+</span> result[<span class="dv">5</span>] <span class="op">+</span> result[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (result[<span class="dv">7</span>] <span class="op">+</span> result[<span class="dv">8</span>] <span class="op">+</span> result[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>plt.plot(binned, label<span class="op">=</span><span class="st">'data'</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>lags <span class="op">=</span> [<span class="st">'N/A'</span>, <span class="st">'0'</span>, <span class="st">'1-2'</span>, <span class="st">'3-5'</span>, <span class="st">'6-8'</span>]</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>plt.xticks(np.arange(<span class="bu">len</span>(lags)), lags)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend at 0x12580e20ac0&gt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Data_Likelihood_Under_Model_files\figure-html/cell-26-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="differential-encoding" class="level3">
<h3 class="anchored" data-anchor-id="differential-encoding">Differential Encoding</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_lohnas2014_data(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../../data/repFR.mat'</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>free_parameters <span class="op">=</span> (</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span>,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mfc_familiarity_scale'</span>,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mcf_familiarity_scale'</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'drift_familiarity_scale'</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>bounds <span class="op">=</span> (</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    (lb, ub)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    trials[list_types <span class="op">==</span> <span class="dv">4</span>], </span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    presentations[list_types <span class="op">==</span> <span class="dv">4</span>], </span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'sampling_rule'</span>: <span class="dv">0</span>}, </span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    free_parameters)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>lohnas_result <span class="op">=</span> differential_evolution(cost_function, bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(lohnas_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 22294.2
differential_evolution step 2: f(x)= 22294.2
differential_evolution step 3: f(x)= 19887.7
differential_evolution step 4: f(x)= 19618.8
differential_evolution step 5: f(x)= 19618.8
differential_evolution step 6: f(x)= 19618.8
differential_evolution step 7: f(x)= 19618.8
differential_evolution step 8: f(x)= 19347.4
differential_evolution step 9: f(x)= 18814.7
differential_evolution step 10: f(x)= 18814.7
differential_evolution step 11: f(x)= 18139.3
differential_evolution step 12: f(x)= 18139.3
differential_evolution step 13: f(x)= 18139.3
differential_evolution step 14: f(x)= 18139.3
differential_evolution step 15: f(x)= 17855.5
differential_evolution step 16: f(x)= 17827.9
differential_evolution step 17: f(x)= 17827.9
differential_evolution step 18: f(x)= 17655
differential_evolution step 19: f(x)= 17655
differential_evolution step 20: f(x)= 17655
differential_evolution step 21: f(x)= 17538.4
differential_evolution step 22: f(x)= 17538.4
differential_evolution step 23: f(x)= 17538.4
differential_evolution step 24: f(x)= 17538.4
differential_evolution step 25: f(x)= 17538.4
differential_evolution step 26: f(x)= 17520.4
differential_evolution step 27: f(x)= 17520.4
differential_evolution step 28: f(x)= 17471.6
differential_evolution step 29: f(x)= 17471.6
differential_evolution step 30: f(x)= 17465.5
differential_evolution step 31: f(x)= 17462.6
differential_evolution step 32: f(x)= 17462.6
differential_evolution step 33: f(x)= 17429.5
differential_evolution step 34: f(x)= 17429.5
differential_evolution step 35: f(x)= 17429.5
differential_evolution step 36: f(x)= 17429.5
     fun: 17152.738785919926
     jac: array([ 8.36007526e-01,  2.67027645e-01, -1.85973476e+00,  6.17073965e+00,
        4.68331564e+01, -1.02118065e+00,  2.87400328e-02,  5.11499821e-01,
        8.13815859e-01, -1.51376298e+00, -1.09866961e-01,  4.61295710e-01,
       -6.80302037e-01, -7.06495485e-01, -1.57826434e+01])
 message: 'Optimization terminated successfully.'
    nfev: 14677
     nit: 36
 success: True
       x: array([8.45399329e-01, 8.94309837e-02, 9.63793630e-01, 2.43252487e-02,
       2.22044605e-16, 5.95712778e-01, 3.25658220e+00, 2.53201152e-01,
       2.14029202e-02, 1.06789857e-01, 1.22711302e+00, 9.29194808e-01,
       4.90150172e-01, 4.58480657e-01, 1.00000000e+00])</code></pre>
</div>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> simulate_array_from_presentations</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.analyses <span class="im">import</span> fast_rpl</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(lohnas_result.x)):</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[free_parameters[j]] <span class="op">=</span> lohnas_result.x[j]</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>new_sim_array <span class="op">=</span> simulate_array_from_presentations(init_cmr, fitted_parameters, presentations[list_types<span class="op">==</span><span class="dv">4</span>], experiment_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.matlib</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> fast_rpl(np.matlib.repmat(presentations[list_types<span class="op">==</span><span class="dv">4</span>], experiment_count, <span class="dv">1</span>), new_sim_array)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (result[<span class="dv">2</span>] <span class="op">+</span> result[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (result[<span class="dv">4</span>] <span class="op">+</span> result[<span class="dv">5</span>] <span class="op">+</span> result[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (result[<span class="dv">7</span>] <span class="op">+</span> result[<span class="dv">8</span>] <span class="op">+</span> result[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(binned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[0.37035927 0.48302143 0.52116429 0.54002976 0.54700595]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>fit_sources <span class="op">=</span> [<span class="st">'lohnas_4'</span>]</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>fit_rpls <span class="op">=</span> [binned]</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(fit_sources)):</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(fit_rpls[i], label<span class="op">=</span>fit_sources[i])</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> fast_rpl(presentations[list_types<span class="op">==</span><span class="dv">4</span>], trials[list_types<span class="op">==</span><span class="dv">4</span>])</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> result[<span class="dv">0</span>]</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> result[<span class="dv">1</span>]</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (result[<span class="dv">2</span>] <span class="op">+</span> result[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (result[<span class="dv">4</span>] <span class="op">+</span> result[<span class="dv">5</span>] <span class="op">+</span> result[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (result[<span class="dv">7</span>] <span class="op">+</span> result[<span class="dv">8</span>] <span class="op">+</span> result[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>plt.plot(binned, label<span class="op">=</span><span class="st">'data'</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>lags <span class="op">=</span> [<span class="st">'N/A'</span>, <span class="st">'0'</span>, <span class="st">'1-2'</span>, <span class="st">'3-5'</span>, <span class="st">'6-8'</span>]</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>plt.xticks(np.arange(<span class="bu">len</span>(lags)), lags)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend at 0x1258219d0d0&gt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Data_Likelihood_Under_Model_files\figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>
</section>
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</main> <!-- /main -->
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->


</body></html>