<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.2.281">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>compmemlearn â€“ model_characterization</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../../">
  <script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../../site_libs/quarto-search/quarto-search.js"></script>
  <script src="../../site_libs/quarto-html/quarto.js"></script>
  <script src="../../site_libs/quarto-html/popper.min.js"></script>
  <script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <link rel="stylesheet" href="../../styles.css">
</head>
<body>
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-light ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">compmemlearn</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- toc -->
    <nav id="TOC" role="doc-toc" class="sidebar sidebar-toc">
<h2 id="toc-title">On this page</h2>
<ul>
<li><a href="#model-characterization" class="nav-link active" data-scroll-target="#model-characterization">Model Characterization</a>
<ul class="collapse">
<li><a href="#initial-fitting-and-memory-visualization" class="nav-link" data-scroll-target="#initial-fitting-and-memory-visualization">Initial Fitting and Memory Visualization</a>
<ul class="collapse">
<li><a href="#instancecmr" class="nav-link" data-scroll-target="#instancecmr">InstanceCMR</a></li>
<li><a href="#tr-cmr" class="nav-link" data-scroll-target="#tr-cmr">TR-CMR</a></li>
</ul></li>
<li><a href="#benchmark-evaluation" class="nav-link" data-scroll-target="#benchmark-evaluation">Benchmark Evaluation</a>
<ul class="collapse">
<li><a href="#instancecmr-1" class="nav-link" data-scroll-target="#instancecmr-1">InstanceCMR</a></li>
<li><a href="#trace-reinstatement-cmr" class="nav-link" data-scroll-target="#trace-reinstatement-cmr">Trace-Reinstatement CMR</a></li>
<li><a href="#trace-reinstatement-cmr-1" class="nav-link" data-scroll-target="#trace-reinstatement-cmr-1">Trace-Reinstatement CMR</a></li>
</ul></li>
<li><a href="#latent-mfc-mcf-mfc---mcf-mff" class="nav-link" data-scroll-target="#latent-mfc-mcf-mfc---mcf-mff">Latent MFC, MCF, MFC -&gt; MCF (MFF)</a>
<ul class="collapse">
<li><a href="#instancecmr-2" class="nav-link" data-scroll-target="#instancecmr-2">InstanceCMR</a></li>
<li><a href="#trace-reinstatement-cmr-2" class="nav-link" data-scroll-target="#trace-reinstatement-cmr-2">Trace-Reinstatement CMR</a></li>
</ul></li>
<li><a href="#memory-connectivity-by-lag" class="nav-link" data-scroll-target="#memory-connectivity-by-lag">Memory Connectivity by Lag</a>
<ul class="collapse">
<li><a href="#instancecmr-3" class="nav-link" data-scroll-target="#instancecmr-3">InstanceCMR</a></li>
<li><a href="#trace-reinstatement-cmr-3" class="nav-link" data-scroll-target="#trace-reinstatement-cmr-3">Trace-Reinstatement CMR</a></li>
</ul></li>
<li><a href="#pure-list-parameter-shifting" class="nav-link" data-scroll-target="#pure-list-parameter-shifting">Pure List Parameter Shifting</a>
<ul class="collapse">
<li><a href="#instancecmr-4" class="nav-link" data-scroll-target="#instancecmr-4">InstanceCMR</a></li>
<li><a href="#trace-reinstatement-cmr-4" class="nav-link" data-scroll-target="#trace-reinstatement-cmr-4">Trace-Reinstatement CMR</a></li>
</ul></li>
<li><a href="#repetition-lag-connectivity-analysis" class="nav-link" data-scroll-target="#repetition-lag-connectivity-analysis">Repetition Lag-Connectivity Analysis</a>
<ul class="collapse">
<li><a href="#instancecmr-5" class="nav-link" data-scroll-target="#instancecmr-5">InstanceCMR</a></li>
<li><a href="#trace-reinstatement-cmr-5" class="nav-link" data-scroll-target="#trace-reinstatement-cmr-5">Trace-Reinstatement CMR</a></li>
</ul></li>
<li><a href="#mixed-list-parameter-shifting" class="nav-link" data-scroll-target="#mixed-list-parameter-shifting">Mixed List Parameter Shifting</a>
<ul class="collapse">
<li><a href="#instance_cmr" class="nav-link" data-scroll-target="#instance_cmr">Instance_CMR</a></li>
<li><a href="#trace-reinstatement-cmr-6" class="nav-link" data-scroll-target="#trace-reinstatement-cmr-6">Trace-Reinstatement CMR</a></li>
</ul></li>
<li><a href="#repetition-contiguity-parameter-shifting-experiments" class="nav-link" data-scroll-target="#repetition-contiguity-parameter-shifting-experiments">Repetition Contiguity Parameter Shifting Experiments</a>
<ul class="collapse">
<li><a href="#instancecmr-6" class="nav-link" data-scroll-target="#instancecmr-6">InstanceCMR</a></li>
<li><a href="#trace-reinstatement-cmr-7" class="nav-link" data-scroll-target="#trace-reinstatement-cmr-7">Trace-Reinstatement CMR</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<!-- main -->
<main class="content">

<section id="model-characterization" class="level1">
<h1>Model Characterization</h1>
<p>Here, we try to configure a more complete characterization of how InstanceCMR (and by extension, CMR) configures the lag-contiguity and deficient repetition contiguity effects in terms of its internal representations and mechanisms.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.analyses <span class="im">import</span> flex_mixed_spc, flex_mixed_crp, flex_mixed_pfr, fast_csp, alternative_contiguity, fast_rpl</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.analyses <span class="im">import</span> fast_spc, fast_crp, fast_pfr</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> prepare_lohnas2014_data</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.models <span class="im">import</span> Classic_CMR, Instance_CMR, Trace_Reinstatement_CMR</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.model_analysis <span class="im">import</span> matrix_heatmap, icmr_memory_heatmap, connectivity_by_lag, mfc_heatmap</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> matlib</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.linalg <span class="im">import</span> norm</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> psifr <span class="im">import</span> fr</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> int32</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.typed <span class="im">import</span> Dict</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.core <span class="im">import</span> types</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit, prange</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [<span class="st">'Control'</span>, <span class="st">'Massed'</span>, <span class="st">'Spaced'</span>, <span class="st">'Mixed'</span>]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_lohnas2014_data(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../../data/repFR.mat'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> latent_mfc_mcf_mff(model, items<span class="op">=</span><span class="va">None</span>, postprocessing<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#TODO: Make sure variable item representations explored in TR-CMR are being handled right!</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> items <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        items <span class="op">=</span> model.items</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># start by finding latent mfc: the contextual representation cued when each orthogonal $f_i$ is cued</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    latent_mfc <span class="op">=</span> np.zeros((model.item_count, <span class="bu">len</span>(model.context)))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(model.item_count):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        latent_mfc[i] <span class="op">=</span> model.echo(items[i])[<span class="bu">len</span>(model.context):]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> postprocessing:</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            latent_mfc[i] <span class="op">/=</span> norm(latent_mfc[i])</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># then latent mcf: the item feature representation cued when each orthogonal $c_i$ is cued</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># no extra normalization is applied after echo retrieval in the model, but results are subsetted differently</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    latent_mcf <span class="op">=</span> np.zeros((model.item_count, model.item_count))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    context_units <span class="op">=</span> np.hstack(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        (np.zeros((model.item_count, <span class="bu">len</span>(model.context))), </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>         np.eye(model.item_count, <span class="bu">len</span>(model.context), <span class="dv">1</span>))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(model.item_count):</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        latent_mcf[i] <span class="op">=</span> model.echo(context_units[i])[<span class="dv">1</span>:model.item_count<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> postprocessing:</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            latent_mcf[i] <span class="op">=</span> np.power(latent_mcf[i], model.choice_sensitivity)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            latent_mcf[i] <span class="op">/=</span> np.<span class="bu">sum</span>(latent_mcf[i])</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># then latent mff: the item feature representation cued as a result of reinstating each orthogonal $f_i$</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: add version for CMR</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    latent_mff <span class="op">=</span> np.zeros((model.item_count, model.item_count))</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    context_units <span class="op">=</span> np.hstack(</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        (np.zeros((model.item_count, <span class="bu">len</span>(model.context))), </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>         latent_mfc)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(model.item_count):</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> postprocessing:</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>            context_units[i, <span class="bu">len</span>(model.context):] <span class="op">/=</span> norm(context_units[i, <span class="bu">len</span>(model.context):])</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        latent_mff[i] <span class="op">=</span> model.echo(context_units[i])[<span class="dv">1</span>:model.item_count<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> postprocessing:</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>            latent_mff[i] <span class="op">=</span> np.power(latent_mff[i], model.choice_sensitivity)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            latent_mff[i] <span class="op">/=</span> np.<span class="bu">sum</span>(latent_mff[i])</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> latent_mfc, latent_mcf, latent_mff</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mixed_connectivity_by_lag(item_connections, presentation):</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    lag_range <span class="op">=</span> <span class="bu">len</span>(presentation) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    total_connectivity <span class="op">=</span> np.zeros(lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    total_possible_lags <span class="op">=</span> np.zeros(lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    item_positions <span class="op">=</span> np.arange(<span class="bu">len</span>(presentation), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> item <span class="kw">in</span> <span class="bu">range</span>(item_count):</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only consider items that are repeated</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        current_positions <span class="op">=</span> np.nonzero(presentation <span class="op">==</span> item)[<span class="dv">0</span>]</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we consider each study position of repeated items separately</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> position_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(current_positions)):</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># lag of each item from current item is item_positions - current_position, </span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and will always be in range [-lag_range, lag_range] so we keep position by adding lag_range</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>            item_lags <span class="op">=</span> item_positions <span class="op">-</span> current_positions[position_index] <span class="op">+</span> lag_range</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>            total_connectivity[item_lags[presentation <span class="op">!=</span> item]] <span class="op">+=</span> item_connections[item, presentation[presentation <span class="op">!=</span> item]]</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>            total_possible_lags[item_lags[presentation <span class="op">!=</span> item]] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># divide by possible lags to get average connectivity</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    total_possible_lags[total_connectivity <span class="op">==</span> <span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    connectivity <span class="op">=</span> total_connectivity <span class="op">/</span> total_possible_lags</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> connectivity</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mixed_connectivity_by_lag(item_connections, presentation):</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    lag_range <span class="op">=</span> <span class="bu">len</span>(presentation) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    total_connectivity <span class="op">=</span> np.zeros(lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    total_possible_lags <span class="op">=</span> np.zeros(lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    item_positions <span class="op">=</span> np.arange(<span class="bu">len</span>(presentation), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> item <span class="kw">in</span> <span class="bu">range</span>(item_count):</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only consider items that are repeated</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>        current_positions <span class="op">=</span> np.nonzero(presentation <span class="op">==</span> item)[<span class="dv">0</span>]</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we consider each study position of repeated items separately</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> position_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(current_positions)):</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>            <span class="co"># lag of each item from current item is item_positions - current_position, </span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and will always be in range [-lag_range, lag_range] so we keep position by adding lag_range</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>            item_lags <span class="op">=</span> item_positions <span class="op">-</span> current_positions[position_index] <span class="op">+</span> lag_range</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>            total_connectivity[item_lags] <span class="op">+=</span> item_connections[item, presentation]</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>            total_possible_lags[item_lags] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># divide by possible lags to get average connectivity</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    total_possible_lags[total_connectivity <span class="op">==</span> <span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>    connectivity <span class="op">=</span> total_connectivity <span class="op">/</span> total_possible_lags</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> connectivity</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> alternative_connectivity_by_lag(item_connections, presentation, minimum_lag<span class="op">=</span><span class="dv">6</span>, max_repeats<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    lag_range <span class="op">=</span> <span class="bu">len</span>(presentation) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>    total_connectivity <span class="op">=</span> np.zeros((max_repeats, lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    total_possible_lags <span class="op">=</span> np.zeros((max_repeats, lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    item_positions <span class="op">=</span> np.arange(<span class="bu">len</span>(presentation), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> item <span class="kw">in</span> <span class="bu">range</span>(item_count):</span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only consider items that are repeated</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>        current_positions <span class="op">=</span> np.nonzero(presentation <span class="op">==</span> item)[<span class="dv">0</span>]</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(current_positions) <span class="op">&lt;</span> max_repeats:</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only consider items with repeats of lag &gt;= minimum_lag</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span>(current_positions[<span class="dv">1</span>] <span class="op">&gt;</span> current_positions[<span class="dv">0</span>])</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_positions[<span class="dv">1</span>] <span class="op">-</span> current_positions[<span class="dv">0</span>] <span class="op">&lt;</span> minimum_lag:</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we consider each study position of repeated items separately</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> position_index <span class="kw">in</span> <span class="bu">range</span>(max_repeats):</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>            <span class="co"># lag of each item from current item is item_positions - current_position, </span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and will always be in range [-lag_range, lag_range] so we keep position by adding lag_range</span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>            item_lags <span class="op">=</span> item_positions <span class="op">-</span> current_positions[position_index] <span class="op">+</span> lag_range</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>            total_connectivity[position_index, item_lags] <span class="op">+=</span> item_connections[item, presentation]</span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>            total_possible_lags[position_index, item_lags] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># divide by possible lags to get average connectivity</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>    total_possible_lags[total_connectivity <span class="op">==</span> <span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    connectivity <span class="op">=</span> total_connectivity <span class="op">/</span> total_possible_lags</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> connectivity</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>, parallel<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lohnas_data_likelihood(trials, presentations, model_class, parameters):</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>    list_length <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>    likelihood <span class="op">=</span> np.ones((<span class="bu">len</span>(trials), list_length<span class="op">-</span><span class="dv">1</span>)) </span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index <span class="kw">in</span> prange(<span class="bu">len</span>(trials)):</span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentations[trial_index])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>        trial <span class="op">=</span> trials[trial_index]</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, list_length, parameters)</span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentations[trial_index]])</span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>        model.force_recall()</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> recall_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trial) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>            <span class="co"># identify index of item recalled; if zero then recall is over</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> recall_index <span class="op">==</span> <span class="bu">len</span>(trial) <span class="kw">and</span> <span class="bu">len</span>(trial) <span class="op">&lt;</span> item_count:</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>                recall <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> trial[recall_index] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>                recall <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>                recall <span class="op">=</span> presentations[trial_index][trial[recall_index]<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>            <span class="co"># store probability of and simulate recalling item with this index</span></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> recall_index <span class="op">&gt;</span> <span class="dv">0</span>:                        </span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>                likelihood[trial_index, recall_index<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>                    model.outcome_probabilities()[recall] <span class="op">+</span> <span class="fl">10e-7</span></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> recall <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>            model.force_recall(recall)</span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reset model to its pre-retrieval (but post-encoding) state</span></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>        model.force_recall(<span class="dv">0</span>)</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>np.<span class="bu">sum</span>(np.log(likelihood))</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lohnas_objective_function(data_to_fit, presentations, model_class, fixed_parameters, free_parameters):</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a><span class="co">    Generates and returns an objective function for input to support search </span></span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a><span class="co">    through parameter space for model fit using an optimization function.</span></span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns a function that accepts a vector x specifying arbitrary values for </span></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a><span class="co">    free parameters and returns evaluation of likelihood using the model </span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a><span class="co">    class, all parameters, and provided data.</span></span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> Dict.empty(key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, value <span class="kw">in</span> fixed_parameters.items():</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>        parameters[name] <span class="op">=</span> value</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> objective_function(x):</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(free_parameters)):</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>            parameters[free_parameters[i]] <span class="op">=</span> x[i]</span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lohnas_data_likelihood(data_to_fit, presentations, model_class, parameters)</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> objective_function</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_df(model, experiment_count, first_recall_item<span class="op">=</span>np.array([])):</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a><span class="co">    Initialize a model with specified parameters and experience sequences and </span></span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a><span class="co">    then populate a psifr-formatted dataframe with the outcomes of performing `free recall`. </span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a><span class="co">    **Required model attributes**:</span></span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a><span class="co">    - item_count: specifies number of items encoded into memory</span></span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a><span class="co">    - context: vector representing an internal contextual state</span></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a><span class="co">    - experience: adding a new trace to the memory model</span></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a><span class="co">    - free_recall: function that freely recalls a given number of items or until recall stops</span></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>    <span class="co"># encode items</span></span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>    model.experience(model.items)</span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate retrieval for the specified number of times, tracking results in df</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>    trial_count <span class="op">=</span> experiment_count</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> first_recall_item.size <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>        trial_count <span class="op">=</span> experiment_count <span class="op">*</span> first_recall_item.size</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> []</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(trial_count):</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>        data <span class="op">+=</span> [[trial_index, <span class="dv">0</span>, <span class="st">'study'</span>, i <span class="op">+</span> <span class="dv">1</span>, i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(model.item_count)]</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(trial_count):</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> first_recall_item.size <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>            experiment <span class="op">=</span> <span class="bu">int</span>(trial_index<span class="op">/</span>first_recall_item.size)</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>            model.force_recall(first_recall_item[trial_index <span class="op">-</span> (experiment <span class="op">*</span> first_recall_item.size)])</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>        data <span class="op">+=</span> [[trial_index, <span class="dv">0</span>, <span class="st">'recall'</span>, i <span class="op">+</span> <span class="dv">1</span>, o] <span class="cf">for</span> i, o <span class="kw">in</span> <span class="bu">enumerate</span>(model.free_recall())]</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'subject'</span>, <span class="st">'list'</span>, <span class="st">'trial_type'</span>, <span class="st">'position'</span>, <span class="st">'item'</span>])</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>    merged <span class="op">=</span> fr.merge_free_recall(data)</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> merged</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>simulate_data <span class="op">=</span> simulate_df</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_array(model, experiment_count, first_recall_item<span class="op">=</span>np.array([])):</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>    <span class="co"># encode items</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>    model.experience(model.items)</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate retrieval for the specified number of times, tracking results in array</span></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> first_recall_item.size <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>        experiment_count <span class="op">*=</span> first_recall_item.size</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>    trials <span class="op">=</span> np.zeros((experiment_count, <span class="bu">len</span>(model.items)), dtype<span class="op">=</span>int32)</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trials)):</span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> first_recall_item.size <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>            experiment <span class="op">=</span> <span class="bu">int</span>(trial_index<span class="op">/</span>first_recall_item.size)</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>            model.force_recall(</span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>                first_recall_item[trial_index <span class="op">-</span> (</span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>                    experiment <span class="op">*</span> first_recall_item.size)])</span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>        recalled <span class="op">=</span> model.free_recall()</span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>        trials[trial_index, :<span class="bu">len</span>(recalled)] <span class="op">=</span> recalled <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> trials</span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a><span class="co">#@njit(nogil=True)</span></span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate_array_from_presentations(</span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>    model_class, parameters, presentations, experiment_count,  first_recall_item):</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simulate retrieval for the specified number of times, tracking results in trials array</span></span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>    trials <span class="op">=</span> np.zeros((experiment_count <span class="op">*</span> <span class="bu">len</span>(presentations), np.<span class="bu">max</span>(presentations)<span class="op">+</span><span class="dv">1</span>), dtype<span class="op">=</span><span class="bu">int</span>) <span class="co">#TODO: change back to int32</span></span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>    counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> experiment <span class="kw">in</span> <span class="bu">range</span>(experiment_count):</span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(presentations)):</span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>            <span class="co"># retrieve presentation sequence for this trial and measure number of unique items</span></span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>            presentation <span class="op">=</span> presentations[trial_index]</span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>            item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate recall and identify first study position of each recalled item</span></span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), parameters)</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>            model.experience(model.items[presentation])</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>            model.force_recall(first_recall_item[trial_index])</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>            recalled <span class="op">=</span> model.free_recall()</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(recalled)):</span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>                trials[counter, i] <span class="op">=</span> find_first(recalled[i], presentation) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>            counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> trials</span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_first(item, vec):</span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""return the index of the first occurence of item in vec"""</span></span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(vec)):</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> item <span class="op">==</span> vec[i]:</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> i</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="initial-fitting-and-memory-visualization" class="level2">
<h2 class="anchored" data-anchor-id="initial-fitting-and-memory-visualization">Initial Fitting and Memory Visualization</h2>
<section id="instancecmr" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr">InstanceCMR</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>icmr_free_parameters <span class="op">=</span> (</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    'choice_sensitivity',</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'context_sensitivity'</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    'feature_sensitivity'</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>icmr_bounds <span class="op">=</span> [</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10),</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10)</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_icmr(item_count, presentation_count, parameters):</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Instance_CMR(item_count, presentation_count, parameters)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> condition</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    init_icmr,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'choice_sensitivity'</span>: <span class="dv">1</span>, <span class="st">'feature_sensitivity'</span>: <span class="dv">1</span>}, </span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    icmr_free_parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="4">
<div class="sourceCode" id="cb4"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>icmr_result <span class="op">=</span> differential_evolution(cost_function, icmr_bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>icmr_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 33720.1
differential_evolution step 2: f(x)= 30743.7
differential_evolution step 3: f(x)= 30743.7
differential_evolution step 4: f(x)= 23444.6
differential_evolution step 5: f(x)= 19831.3
differential_evolution step 6: f(x)= 19400.9
differential_evolution step 7: f(x)= 19400.9
differential_evolution step 8: f(x)= 18531.7
differential_evolution step 9: f(x)= 18285.1
differential_evolution step 10: f(x)= 18274.3
differential_evolution step 11: f(x)= 18194.7
differential_evolution step 12: f(x)= 18125.7
differential_evolution step 13: f(x)= 18125.7
differential_evolution step 14: f(x)= 17241
differential_evolution step 15: f(x)= 17241
differential_evolution step 16: f(x)= 17241
differential_evolution step 17: f(x)= 17241
differential_evolution step 18: f(x)= 16361
differential_evolution step 19: f(x)= 16361
differential_evolution step 20: f(x)= 16361
differential_evolution step 21: f(x)= 16361
differential_evolution step 22: f(x)= 16361
differential_evolution step 23: f(x)= 16361
differential_evolution step 24: f(x)= 16361
differential_evolution step 25: f(x)= 16361
differential_evolution step 26: f(x)= 16361
differential_evolution step 27: f(x)= 16361
differential_evolution step 28: f(x)= 16200.5
differential_evolution step 29: f(x)= 15919.8
differential_evolution step 30: f(x)= 15919.8
differential_evolution step 31: f(x)= 15919.8
differential_evolution step 32: f(x)= 15919.8
differential_evolution step 33: f(x)= 15919.8
differential_evolution step 34: f(x)= 15919.8
differential_evolution step 35: f(x)= 15919.8
differential_evolution step 36: f(x)= 15919.8
differential_evolution step 37: f(x)= 15906.9
differential_evolution step 38: f(x)= 15906.9
differential_evolution step 39: f(x)= 15873.1
differential_evolution step 40: f(x)= 15873.1
differential_evolution step 41: f(x)= 15873.1
differential_evolution step 42: f(x)= 15855
differential_evolution step 43: f(x)= 15855
differential_evolution step 44: f(x)= 15840
differential_evolution step 45: f(x)= 15840
differential_evolution step 46: f(x)= 15840
differential_evolution step 47: f(x)= 15840
differential_evolution step 48: f(x)= 15840
differential_evolution step 49: f(x)= 15840
differential_evolution step 50: f(x)= 15840
differential_evolution step 51: f(x)= 15790.8
differential_evolution step 52: f(x)= 15790.8
differential_evolution step 53: f(x)= 15790.8
differential_evolution step 54: f(x)= 15790.8
differential_evolution step 55: f(x)= 15790.8
differential_evolution step 56: f(x)= 15790.8
differential_evolution step 57: f(x)= 15790.8
differential_evolution step 58: f(x)= 15790.8
differential_evolution step 59: f(x)= 15790.8
differential_evolution step 60: f(x)= 15790.8
differential_evolution step 61: f(x)= 15789.2</code></pre>
</div>
<div class="cell-output-display" data-execution_count="4">
<pre><code>     fun: 15639.52630931897
     jac: array([-4.40741130e-01, -2.41743692e-01, -7.29232848e-01, -5.62577043e+00,
       -6.25277604e+00,  1.09394022e+00, -5.82076613e-03, -2.20279618e-01,
       -2.04709067e+00, -3.06499715e-01, -4.07453629e-02, -1.16415321e-02])
 message: 'Optimization terminated successfully.'
    nfev: 15112
     nit: 61
 success: True
       x: array([0.81354362, 0.13186679, 0.92156226, 0.01638355, 1.        ,
       0.51789751, 2.51054862, 1.07486145, 0.02249255, 0.10414492,
       2.10982446, 0.96461678])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode" id="cb7"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># static_icmr_fit_result = np.array([8.32809463e-01, 4.85458609e-02, 9.61140398e-01, 1.19908530e-03,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#        1.31621512e-01, 2.45449928e-01, 3.33484776e+00, 2.09892365e+01,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#        2.15080187e-02, 1.06720819e-01, 1.32169006e+00, 9.94120769e-01])</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># icmr_fitted_parameters = Dict.empty(</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         key_type=types.unicode_type, value_type=types.float64)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for j in range(len(static_icmr_fit_result)):</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     icmr_fitted_parameters[icmr_free_parameters[j]] =static_icmr_fit_result.x[j]</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>icmr_fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(icmr_result.x)):</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    icmr_fitted_parameters[icmr_free_parameters[j]] <span class="op">=</span>icmr_result.x[j]</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>icmr_fitted_parameters[<span class="st">'choice_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>icmr_fitted_parameters[<span class="st">'feature_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Instance_CMR(list_length, list_length, icmr_fitted_parameters)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>simulate_df(model, <span class="dv">1</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>icmr_memory_heatmap(model, just_experimental<span class="op">=</span><span class="va">True</span>, just_context<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>item_count <span class="op">=</span> np.<span class="bu">max</span>(presentations[<span class="dv">0</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Instance_CMR(item_count, list_length, icmr_fitted_parameters)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>model.experience(model.items[presentations[<span class="dv">0</span>]])</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>icmr_memory_heatmap(model, just_experimental<span class="op">=</span><span class="va">True</span>, just_context<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(presentations[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-6-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-stdout">
<pre><code>[ 0  1  2  3  4  5  6  7  8  9 10 11 11 12 13 14 15 16  9 17 18 19 18 20
 21 22 19 23 24 25 21 26 27 23 28 29 30 31 32 33]</code></pre>
</div>
</div>
</section>
<section id="tr-cmr" class="level3">
<h3 class="anchored" data-anchor-id="tr-cmr">TR-CMR</h3>
<p>A cell to reload the model in case Iâ€™ve updated the specification:</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode" id="cb9"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remember to run nbdev_build_lib first! </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>nbdev_build_lib</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> compmemlearn</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> importlib</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>importlib.<span class="bu">reload</span>(compmemlearn.models)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.models <span class="im">import</span> Trace_Reinstatement_CMR, Instance_CMR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>Converted Alternative_Contiguity.ipynb.
Converted Conditional_Stop_Probability.ipynb.
Converted Lag_Contiguity_Effect.ipynb.
Converted Lag_Contiguity_with_Repetition_Data.ipynb.
Converted Measuring_Repetition_Effects.ipynb.
Converted Probability_of_First_Recall.ipynb.
Converted Probability_of_First_Recall_in_Repetition_Data.ipynb.
Converted Recall_Probability_by_Spacing.ipynb.
Converted Serial_Position_Effect.ipynb.
Converted Serial_Position_Effect_in_Repetition_Datasets.ipynb.
Converted Shared_Contiguity.ipynb.
Converted ClairExpt6.ipynb.
Converted Data_Simulation.ipynb.
Converted HowaKaha05.ipynb.
Converted Lohnas2014.ipynb.
Converted Murdock1962.ipynb.
Converted MurdockOkada1970.ipynb.
Converted PEERS.ipynb.
Converted index.ipynb.
Converted Alternative_Contiguity_Tracing.ipynb.
Converted Contiguity_Tracing.ipynb.
Converted Data_Likelihood_Under_Model.ipynb.
Converted Model_Characterization.ipynb.
Converted Model_Visualization.ipynb.
Converted Classic_CMR.ipynb.
Converted Instance_CMR.ipynb.
Converted Noisy_CMR.ipynb.
Converted Scalar_CMR.ipynb.
Converted Trace_Reinstatement_CMR.ipynb.</code></pre>
</div>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>trcmr_free_parameters <span class="op">=</span> (</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    'choice_sensitivity',</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'context_sensitivity'</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    'feature_sensitivity'</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature_drift_rate'</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co">#    'context_reinstatement'</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>trcmr_bounds <span class="op">=</span> [</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10),</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10)</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10)</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_trcmr(item_count, presentation_count, parameters):</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Trace_Reinstatement_CMR(item_count, presentation_count, parameters)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> condition</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    init_trcmr,</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'choice_sensitivity'</span>: <span class="dv">1</span>, <span class="st">'feature_sensitivity'</span>: <span class="dv">1</span>, <span class="st">'context_reinstatement'</span>: <span class="dv">0</span>}, </span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    trcmr_free_parameters)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="co"># will throw error if i haven't already fitted</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co">#print(init_trcmr(20, 20, trcmr_fitted_parameters).items[0])</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: When holding variable constant, 1) comment out the variable in free parameters, 2) comment out its bounds, and 3) add constant variable to the dict argument in cost_function, and 4) make sure initial simulation code also sets constant parameter's value (or you won't get far)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="85">
<div class="sourceCode" id="cb12"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>trcmr_result <span class="op">=</span> differential_evolution(cost_function, trcmr_bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>trcmr_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 20113.2
differential_evolution step 2: f(x)= 20113.2
differential_evolution step 3: f(x)= 18436.3
differential_evolution step 4: f(x)= 18436.3
differential_evolution step 5: f(x)= 18436.3
differential_evolution step 6: f(x)= 18436.3
differential_evolution step 7: f(x)= 18287.8
differential_evolution step 8: f(x)= 18287.8
differential_evolution step 9: f(x)= 18006.6
differential_evolution step 10: f(x)= 18006.6
differential_evolution step 11: f(x)= 18006.6
differential_evolution step 12: f(x)= 17808.6
differential_evolution step 13: f(x)= 17808.6
differential_evolution step 14: f(x)= 17808.6
differential_evolution step 15: f(x)= 17808.6
differential_evolution step 16: f(x)= 16763.6
differential_evolution step 17: f(x)= 16763.6
differential_evolution step 18: f(x)= 16658.6
differential_evolution step 19: f(x)= 16658.6
differential_evolution step 20: f(x)= 16658.6
differential_evolution step 21: f(x)= 16658.6
differential_evolution step 22: f(x)= 16658.6
differential_evolution step 23: f(x)= 16658.6
differential_evolution step 24: f(x)= 16658.6
differential_evolution step 25: f(x)= 16658.6
differential_evolution step 26: f(x)= 16658.6
differential_evolution step 27: f(x)= 16600.2
differential_evolution step 28: f(x)= 16600.2
differential_evolution step 29: f(x)= 16162.4
differential_evolution step 30: f(x)= 16162.4
differential_evolution step 31: f(x)= 16162.4
differential_evolution step 32: f(x)= 16162.4
differential_evolution step 33: f(x)= 16067.9
differential_evolution step 34: f(x)= 15965.1
differential_evolution step 35: f(x)= 15965.1
differential_evolution step 36: f(x)= 15965.1
differential_evolution step 37: f(x)= 15933.2
differential_evolution step 38: f(x)= 15933.2
differential_evolution step 39: f(x)= 15933.2
differential_evolution step 40: f(x)= 15867.8
differential_evolution step 41: f(x)= 15867.8
differential_evolution step 42: f(x)= 15867.8
differential_evolution step 43: f(x)= 15867.8
differential_evolution step 44: f(x)= 15867.8
differential_evolution step 45: f(x)= 15867.8
differential_evolution step 46: f(x)= 15867.8
differential_evolution step 47: f(x)= 15834.9
differential_evolution step 48: f(x)= 15834.9
differential_evolution step 49: f(x)= 15834.9
differential_evolution step 50: f(x)= 15834.9
differential_evolution step 51: f(x)= 15781.9
differential_evolution step 52: f(x)= 15775.5
differential_evolution step 53: f(x)= 15775.5
differential_evolution step 54: f(x)= 15775.5</code></pre>
</div>
<div class="cell-output-display" data-execution_count="85">
<pre><code>     fun: 15699.843571126987
     jac: array([-1.44409568,  0.10204531, -0.67611836,  2.73339538, -9.39544402,
       -0.16279955,  0.14388206,  0.        ,  1.54122972, -0.43346518,
       -0.0165528 , -0.82709448,  0.79999154])
 message: 'Optimization terminated successfully.'
    nfev: 15359
     nit: 54
 success: True
       x: array([8.39314620e-01, 1.63618629e-01, 9.23936537e-01, 1.55520938e-02,
       1.00000000e+00, 5.23221127e-01, 2.35838577e+00, 9.93512212e+01,
       2.25120491e-02, 1.04097390e-01, 2.06938199e+00, 9.93062277e-01,
       1.54392061e-01])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="86">
<div class="sourceCode" id="cb15"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># static_trcmr_result = np.array([8.38888699e-01, 5.11712122e-04, 9.42814559e-01, 6.43556899e-03, # temporarily set to 0</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#        6.45214269e-01, 4.81647177e-01, 4.00131827e+00, 1.98252428e+00,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#        2.83758432e-02, 9.60298353e-02, 1.58539149e+00, 9.99999887e-01,</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#        3.61675064e-01])</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># trcmr_fitted_parameters = Dict.empty(</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#         key_type=types.unicode_type, value_type=types.float64)</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># for j in range(len(static_trcmr_result)):</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     trcmr_fitted_parameters[trcmr_free_parameters[j]] = static_trcmr_result[j]</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trcmr_result.x)):</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    trcmr_fitted_parameters[trcmr_free_parameters[j]] <span class="op">=</span> trcmr_result.x[j]</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters[<span class="st">'choice_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters[<span class="st">'feature_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co"># trcmr_fitted_parameters['shared_support'] = 0</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters[<span class="st">'context_reinstatement'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#trcmr_fitted_parameters['feature_drift_rate'] = 1</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Trace_Reinstatement_CMR(<span class="dv">20</span>, <span class="dv">20</span>, trcmr_fitted_parameters).items[<span class="dv">0</span>]) </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>item_count <span class="op">=</span> np.<span class="bu">max</span>(presentations[<span class="dv">0</span>])<span class="op">+</span><span class="dv">1</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Trace_Reinstatement_CMR(item_count, list_length, trcmr_fitted_parameters)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>model.experience(model.items[presentations[<span class="dv">0</span>]])</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>icmr_memory_heatmap(model, just_experimental<span class="op">=</span><span class="va">True</span>, just_context<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(presentations[<span class="dv">0</span>])</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Trace_Reinstatement_CMR(list_length, list_length, trcmr_fitted_parameters)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>simulate_df(model, <span class="dv">1</span>)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>icmr_memory_heatmap(model, just_experimental<span class="op">=</span><span class="va">True</span>, just_context<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-stdout">
<pre><code>[ 0  1  2  3  4  5  6  7  8  9 10 11 11 12 13 14 15 16  9 17 18 19 18 20
 21 22 19 23 24 25 21 26 27 23 28 29 30 31 32 33]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-10-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="benchmark-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="benchmark-evaluation">Benchmark Evaluation</h2>
<section id="instancecmr-1" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr-1">InstanceCMR</h3>
<div class="cell" data-execution_count="76">
<div class="sourceCode" id="cb18"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'InstanceCMR'</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># identify first recalled item for each trial</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>first_recalls <span class="op">=</span> np.zeros(<span class="bu">len</span>(presentations), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(presentations)):</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    first_recalls[i] <span class="op">=</span> presentations[i][trials[i, <span class="dv">0</span>]<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>icmr_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    init_icmr, icmr_fitted_parameters, presentations[list_types<span class="op">==</span>condition], experiment_count, first_recalls[list_types<span class="op">==</span>condition])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>icmr_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>condition], experiment_count, <span class="dv">1</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># spc</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>data_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>icmr_spc <span class="op">=</span> flex_mixed_spc(icmr_trials, icmr_presentations)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_spc)), data_spc, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(icmr_spc)), icmr_spc, label<span class="op">=</span>model_name)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>data_pfr <span class="op">=</span> flex_mixed_pfr(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>icmr_pfr <span class="op">=</span> flex_mixed_pfr(icmr_trials, icmr_presentations)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_pfr)), data_pfr, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(icmr_pfr)), icmr_pfr, label<span class="op">=</span>model_name)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co"># crp</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>lag_range <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>data_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>data_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>icmr_crp <span class="op">=</span> flex_mixed_crp(icmr_trials, icmr_presentations)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>icmr_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_crp)), data_crp, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(icmr_crp)), icmr_crp, label<span class="op">=</span>model_name)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>))</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>) <span class="op">-</span> lag_range)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'CRP'</span>)</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="co"># rpl</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> data_rpl[<span class="dv">0</span>]</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> data_rpl[<span class="dv">1</span>]</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (data_rpl[<span class="dv">2</span>] <span class="op">+</span> data_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (data_rpl[<span class="dv">4</span>] <span class="op">+</span> data_rpl[<span class="dv">5</span>] <span class="op">+</span> data_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (data_rpl[<span class="dv">7</span>] <span class="op">+</span> data_rpl[<span class="dv">8</span>] <span class="op">+</span> data_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>icmr_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    icmr_trials, icmr_presentations, max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> icmr_rpl[<span class="dv">0</span>]</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> icmr_rpl[<span class="dv">1</span>]</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (icmr_rpl[<span class="dv">2</span>] <span class="op">+</span> icmr_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (icmr_rpl[<span class="dv">4</span>] <span class="op">+</span> icmr_rpl[<span class="dv">5</span>] <span class="op">+</span> icmr_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (icmr_rpl[<span class="dv">7</span>] <span class="op">+</span> icmr_rpl[<span class="dv">8</span>] <span class="op">+</span> icmr_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>icmr_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_rpl)), data_rpl, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(icmr_rpl)), icmr_rpl, label<span class="op">=</span>model_name)</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Recall Probability by Lag'</span>)</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'Repetition Contiguity -- Data'</span>)</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>icmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>    icmr_trials, icmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>icmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), icmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), icmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'Repetition Contiguity -- '</span> <span class="op">+</span> model_name)</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode" id="cb19"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'InstanceCMR'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>lag_range <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>cmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    icmr_trials, icmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>cmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>axes.plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>]<span class="op">-</span>data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>axes.plot(np.arange(<span class="dv">7</span>), cmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>]<span class="op">-</span>cmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span>model_name)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>axes.set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>axes.set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>axes.set_title(<span class="st">'Positional Contiguity Difference'</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>axes.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display" data-execution_count="77">
<pre><code>&lt;matplotlib.legend.Legend at 0x22a9946fa90&gt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace-reinstatement-cmr" class="level3">
<h3 class="anchored" data-anchor-id="trace-reinstatement-cmr">Trace-Reinstatement CMR</h3>
<div class="cell" data-execution_count="87">
<div class="sourceCode" id="cb21"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'Trace Reinstatement CMR'</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>first_recalls <span class="op">=</span> np.zeros(<span class="bu">len</span>(presentations), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(presentations)):</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    first_recalls[i] <span class="op">=</span> presentations[i][trials[i, <span class="dv">0</span>]<span class="op">-</span><span class="dv">1</span>]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>trcmr_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    init_trcmr, trcmr_fitted_parameters, presentations[list_types<span class="op">==</span>condition], experiment_count, first_recalls[list_types<span class="op">==</span>condition])</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>trcmr_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>condition], experiment_count, <span class="dv">1</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># spc</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>data_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>trcmr_spc <span class="op">=</span> flex_mixed_spc(trcmr_trials, trcmr_presentations)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_spc)), data_spc, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(trcmr_spc)), trcmr_spc, label<span class="op">=</span>model_name)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>data_pfr <span class="op">=</span> flex_mixed_pfr(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>trcmr_pfr <span class="op">=</span> flex_mixed_pfr(trcmr_trials, trcmr_presentations)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_pfr)), data_pfr, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(trcmr_pfr)), trcmr_pfr, label<span class="op">=</span>model_name)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co"># crp</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>lag_range <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>data_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>data_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>trcmr_crp <span class="op">=</span> flex_mixed_crp(trcmr_trials, trcmr_presentations)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>trcmr_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_crp)), data_crp, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(trcmr_crp)), trcmr_crp, label<span class="op">=</span>model_name)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>))</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>) <span class="op">-</span> lag_range)</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'CRP'</span>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="co"># rpl</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> data_rpl[<span class="dv">0</span>]</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> data_rpl[<span class="dv">1</span>]</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (data_rpl[<span class="dv">2</span>] <span class="op">+</span> data_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (data_rpl[<span class="dv">4</span>] <span class="op">+</span> data_rpl[<span class="dv">5</span>] <span class="op">+</span> data_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (data_rpl[<span class="dv">7</span>] <span class="op">+</span> data_rpl[<span class="dv">8</span>] <span class="op">+</span> data_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>trcmr_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>    trcmr_trials, trcmr_presentations, max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> trcmr_rpl[<span class="dv">0</span>]</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> trcmr_rpl[<span class="dv">1</span>]</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">2</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">4</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">5</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">7</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">8</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>trcmr_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_rpl)), data_rpl, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(trcmr_rpl)), trcmr_rpl, label<span class="op">=</span>model_name)</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Recall Probability by Lag'</span>)</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'Repetition Contiguity -- Data'</span>)</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>trcmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>    trcmr_trials, trcmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>trcmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), trcmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), trcmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'Repetition Contiguity -- '</span> <span class="op">+</span> model_name)</span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode" id="cb22"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'Trace Reinstatement CMR'</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>cmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    trcmr_trials, trcmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>cmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>axes.plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>]<span class="op">-</span>data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>axes.plot(np.arange(<span class="dv">7</span>), cmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>]<span class="op">-</span>cmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span>model_name)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>axes.set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>axes.set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>axes.set_title(<span class="st">'Positional Contiguity Difference'</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>axes.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display" data-execution_count="83">
<pre><code>&lt;matplotlib.legend.Legend at 0x22a9ee6a6d0&gt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace-reinstatement-cmr-1" class="level3">
<h3 class="anchored" data-anchor-id="trace-reinstatement-cmr-1">Trace-Reinstatement CMR</h3>
</section>
</section>
<section id="latent-mfc-mcf-mfc---mcf-mff" class="level2">
<h2 class="anchored" data-anchor-id="latent-mfc-mcf-mfc---mcf-mff">Latent MFC, MCF, MFC -&gt; MCF (MFF)</h2>
<p>This time, weâ€™ll do extra processing to the modelâ€™s internal representations to build a more accurate picture of the proximate input into the next step of model processing. For MFC, this mainly means adding a normalization step to processing. For MCF, we assume stop_probability is 0 and no items have been recalled and compute what would be the corresponding output from <code>model.outcome_probabilities</code>. This means scaling retrieved activations with the exponent <code>model.choice_sensitivity</code> and enforcing the sum of entries in the output vector to the value 1.</p>
<p>Furthermore, we wish to characterize how MFC and MCF interact to determine transitions during simulated free recall. This is found by passing each relevant item feature representation through MFC to retrieve contextual associations and then further passing these retrieved contextual associations through MCF to obtain correspond item feature associations. Though in practice the extent of the link between MFC and MCF is mediated by the contextual drift rate parameter, this provides insight into the directional effect of recalling an item on the probability distribution for the following one. Weâ€™ll call this mapping MFF.</p>
<section id="instancecmr-2" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr-2">InstanceCMR</h3>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Instance_CMR(list_length, list_length, icmr_fitted_parameters)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>simulate_df(model, <span class="dv">1</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>latent_mfc, latent_mcf, latent_mff <span class="op">=</span> latent_mfc_mcf_mff(model, model.items)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>mfc_heatmap(latent_mfc)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>mfc_heatmap(latent_mcf)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>mfc_heatmap(latent_mff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-15-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace-reinstatement-cmr-2" class="level3">
<h3 class="anchored" data-anchor-id="trace-reinstatement-cmr-2">Trace-Reinstatement CMR</h3>
<div class="cell" data-execution_count="45">
<div class="sourceCode" id="cb25"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Trace_Reinstatement_CMR(list_length, list_length, trcmr_fitted_parameters)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>simulate_df(model, <span class="dv">1</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>latent_mfc, latent_mcf, latent_mff <span class="op">=</span> latent_mfc_mcf_mff(model, model.recall_items)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>mfc_heatmap(latent_mfc)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>mfc_heatmap(latent_mcf)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>mfc_heatmap(latent_mff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-16-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="memory-connectivity-by-lag" class="level2">
<h2 class="anchored" data-anchor-id="memory-connectivity-by-lag">Memory Connectivity by Lag</h2>
<section id="instancecmr-3" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr-3">InstanceCMR</h3>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Instance_CMR</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> icmr_fitted_parameters</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]:</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        lag_range <span class="op">=</span> item_count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>            <span class="co">#TODO: Update for Classic CMR</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>            latent_mfc, mcf_connections, mff_connections <span class="op">=</span> latent_mfc_mcf_mff(model, model.items)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        mff_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mfc_alternative_connectivities += alternative_connectivity_by_lag(mfc_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mcf_alternative_connectivities += alternative_connectivity_by_lag(mcf_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity <span class="op">=</span> mff_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">5</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[0].plot(np.arange(len(mcf_alternative_connectivity[1])), mcf_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[1].plot(np.arange(len(mfc_alternative_connectivity[1])), mfc_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFF</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(np.arange(<span class="bu">len</span>(mff_alternative_connectivity[<span class="dv">0</span>])), mff_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[2].plot(np.arange(len(mff_alternative_connectivity[1])), mff_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_title(<span class="st">'MFF'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-17-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-17-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace-reinstatement-cmr-3" class="level3">
<h3 class="anchored" data-anchor-id="trace-reinstatement-cmr-3">Trace-Reinstatement CMR</h3>
<div class="cell" data-execution_count="46">
<div class="sourceCode" id="cb27"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Trace_Reinstatement_CMR</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> trcmr_fitted_parameters</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]:</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        lag_range <span class="op">=</span> item_count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>            <span class="co">#TODO: Update for Classic CMR</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>            latent_mfc, mcf_connections, mff_connections <span class="op">=</span> latent_mfc_mcf_mff(model, model.recall_items)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>        mff_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mfc_alternative_connectivities += alternative_connectivity_by_lag(mfc_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mcf_alternative_connectivities += alternative_connectivity_by_lag(mcf_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity <span class="op">=</span> mff_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">5</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[0].plot(np.arange(len(mcf_alternative_connectivity[1])), mcf_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[1].plot(np.arange(len(mfc_alternative_connectivity[1])), mfc_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFF</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(np.arange(<span class="bu">len</span>(mff_alternative_connectivity[<span class="dv">0</span>])), mff_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[2].plot(np.arange(len(mff_alternative_connectivity[1])), mff_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_title(<span class="st">'MFF'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-18-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-18-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="pure-list-parameter-shifting" class="level2">
<h2 class="anchored" data-anchor-id="pure-list-parameter-shifting">Pure List Parameter Shifting</h2>
<section id="instancecmr-4" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr-4">InstanceCMR</h3>
<div class="cell" data-execution_count="31">
<div class="sourceCode" id="cb28"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>max_lag <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>score_ranges <span class="op">=</span> {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.005</span>, <span class="fl">.001</span>),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.01</span>, <span class="fl">.001</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>: np.arange(<span class="fl">.001</span>, <span class="dv">5</span>, <span class="fl">.5</span>),</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model_class <span class="kw">in</span> [Instance_CMR]:</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> cmr_fitted_parameters</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Instance_CMR'</span>:</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> icmr_fitted_parameters</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> trcmr_fitted_parameters</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> varied_parameter <span class="kw">in</span> score_ranges.keys():</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(varied_parameter, parameters[varied_parameter])</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        crps <span class="op">=</span> []</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        spcs <span class="op">=</span> []</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        pfrs <span class="op">=</span> []</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        mfc_connectivities <span class="op">=</span> []</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        mcf_connectivities <span class="op">=</span> []</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>        mff_connectivities <span class="op">=</span> []</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> parameter_value <span class="kw">in</span> tqdm(score_ranges[varied_parameter]):</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate data with this parameter value modified</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>            sub_params <span class="op">=</span> parameters.copy()</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>            sub_params[varied_parameter] <span class="op">=</span> parameter_value</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> model_class(list_length, list_length, sub_params)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>            simulation <span class="op">=</span> simulate_array(model, <span class="dv">10000</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># accumulate spcs, crps, pfrs</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>            spc <span class="op">=</span> fast_spc(simulation, list_length)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>            spc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Study Position'</span>: np.arange(<span class="bu">len</span>(spc)), <span class="st">'Recall Rate'</span>: spc, varied_parameter: parameter_value})</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>            spcs.append(spc)</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>            crp <span class="op">=</span> fast_crp(simulation, list_length)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>            crp[list_length<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>            crp <span class="op">=</span> pd.DataFrame(</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Lag'</span>: np.arange(max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>max_lag, <span class="st">'Recall Rate'</span>: crp[list_length<span class="op">-</span>max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>max_lag], varied_parameter: parameter_value})</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>            crps.append(crp)</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>            pfr <span class="op">=</span> fast_pfr(simulation, list_length)</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>            pfr <span class="op">=</span> pd.DataFrame(</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Study Position'</span>: np.arange(<span class="bu">len</span>(pfr)), <span class="st">'First Recall Rate'</span>: pfr, varied_parameter: parameter_value})</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>            pfrs.append(pfr)</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>                <span class="co">#TODO: still have to update for CMR</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>                mfc_connectivity <span class="op">=</span> connectivity_by_lag(model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>], model.item_count)</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>                mcf_connectivity <span class="op">=</span> connectivity_by_lag(model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :], model.item_count)</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>                latent_mfc, latent_mcf, latent_mff <span class="op">=</span> latent_mfc_mcf_mff(model, model.items)</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>                mfc_connectivity <span class="op">=</span> connectivity_by_lag(latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>], model.item_count)</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>                mcf_connectivity <span class="op">=</span> connectivity_by_lag(latent_mcf, model.item_count)</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>                mff_connectivity <span class="op">=</span> connectivity_by_lag(latent_mff, model.item_count)</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>            mfc_connectivity[model.item_count<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>            mcf_connectivity[model.item_count<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>            mfc_connectivity <span class="op">=</span> pd.DataFrame(</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Lag'</span>: np.arange(max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>max_lag, <span class="st">'Recall Rate'</span>: mfc_connectivity[model.item_count<span class="op">-</span>max_lag<span class="op">-</span><span class="dv">1</span>:model.item_count<span class="op">+</span>max_lag], varied_parameter: parameter_value}</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>            mcf_connectivity <span class="op">=</span> pd.DataFrame(</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Lag'</span>: np.arange(max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>max_lag, <span class="st">'Recall Rate'</span>: mcf_connectivity[model.item_count<span class="op">-</span>max_lag<span class="op">-</span><span class="dv">1</span>:model.item_count<span class="op">+</span>max_lag], varied_parameter: parameter_value}</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>            mff_connectivity <span class="op">=</span> pd.DataFrame(</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Lag'</span>: np.arange(max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>max_lag, <span class="st">'Recall Rate'</span>: mff_connectivity[model.item_count<span class="op">-</span>max_lag<span class="op">-</span><span class="dv">1</span>:model.item_count<span class="op">+</span>max_lag], varied_parameter: parameter_value}</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>            mfc_connectivities.append(mfc_connectivity)</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>            mcf_connectivities.append(mcf_connectivity)</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>            mff_connectivities.append(mff_connectivity)</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># concatenate result into a single table</span></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>        spc <span class="op">=</span> pd.concat(spcs).reset_index()</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>        crp <span class="op">=</span> pd.concat(crps).reset_index()</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>        pfr <span class="op">=</span> pd.concat(pfrs).reset_index()</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>        mfc_connectivity <span class="op">=</span> pd.concat(mfc_connectivities).reset_index()</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>        mcf_connectivity <span class="op">=</span> pd.concat(mcf_connectivities).reset_index()</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>        mff_connectivity <span class="op">=</span> pd.concat(mff_connectivities).reset_index()</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>        sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'darkgrid'</span>)</span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>        fig, axes <span class="op">=</span> plt.subplots(<span class="dv">6</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">20</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>], data<span class="op">=</span>spc, x<span class="op">=</span><span class="st">'Study Position'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axes[0].set_xlabel('Study Position')</span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axes[0].set_ylabel('Probability Recall')</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].legend(np.<span class="bu">round</span>(score_ranges[varied_parameter], <span class="dv">5</span>), bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>pfr, x<span class="op">=</span><span class="st">'Study Position'</span>, y<span class="op">=</span><span class="st">'First Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>        filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>max_lag<span class="sc">}</span><span class="ss"> &lt;= Lag &lt; 0'</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>        filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; Lag &lt;= </span><span class="sc">{</span>max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>], data<span class="op">=</span>crp.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>], data<span class="op">=</span>crp.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">2</span>].set_title(<span class="st">'Lag-CRP'</span>)</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>], data<span class="op">=</span>mfc_connectivity.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>], data<span class="op">=</span>mfc_connectivity.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">3</span>].set_title(<span class="st">'MFC Lag-Connectivity'</span>)</span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">4</span>], data<span class="op">=</span>mcf_connectivity.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">4</span>], data<span class="op">=</span>mcf_connectivity.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">4</span>].set_title(<span class="st">'MCF Lag-Connectivity'</span>)</span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">5</span>], data<span class="op">=</span>mff_connectivity.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">5</span>], data<span class="op">=</span>mff_connectivity.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">5</span>].set_title(<span class="st">'MFF Lag-Connectivity'</span>)</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout(pad<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>        fig.suptitle(varied_parameter.replace(<span class="st">'_'</span>, <span class="st">' '</span>).upper())</span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plt.savefig('results/{}_{}.svg'.format(model.__name__, varied_parameter))</span></span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>encoding_drift_rate 0.8363715433354807</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:15&lt;00:00,  1.59s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-19-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>recall_drift_rate 0.9600175060232444</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:15&lt;00:00,  1.53s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-19-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/4 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>shared_support 0.0008229999076557321</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:06&lt;00:00,  1.51s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-19-output-12.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/9 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>item_support 0.09131365030360249</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:14&lt;00:00,  1.57s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-19-output-16.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>learning_rate 0.1915496572645179</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:16&lt;00:00,  1.62s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-19-output-20.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>choice_sensitivity 1.0</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:16&lt;00:00,  1.62s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-19-output-24.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace-reinstatement-cmr-4" class="level3">
<h3 class="anchored" data-anchor-id="trace-reinstatement-cmr-4">Trace-Reinstatement CMR</h3>
<div class="cell" data-execution_count="47">
<div class="sourceCode" id="cb47"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>max_lag <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>score_ranges <span class="op">=</span> {</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.005</span>, <span class="fl">.001</span>),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.01</span>, <span class="fl">.001</span>),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>: np.arange(<span class="fl">.001</span>, <span class="dv">5</span>, <span class="fl">.5</span>),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model_class <span class="kw">in</span> [Trace_Reinstatement_CMR]:</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> cmr_fitted_parameters</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Instance_CMR'</span>:</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> icmr_fitted_parameters</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>        parameters <span class="op">=</span> trcmr_fitted_parameters</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> varied_parameter <span class="kw">in</span> score_ranges.keys():</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(varied_parameter, parameters[varied_parameter])</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>        crps <span class="op">=</span> []</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>        spcs <span class="op">=</span> []</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        pfrs <span class="op">=</span> []</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        mfc_connectivities <span class="op">=</span> []</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>        mcf_connectivities <span class="op">=</span> []</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>        mff_connectivities <span class="op">=</span> []</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> parameter_value <span class="kw">in</span> tqdm(score_ranges[varied_parameter]):</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate data with this parameter value modified</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>            sub_params <span class="op">=</span> parameters.copy()</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>            sub_params[varied_parameter] <span class="op">=</span> parameter_value</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> model_class(list_length, list_length, sub_params)</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>            simulation <span class="op">=</span> simulate_array(model, <span class="dv">10000</span>)</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># accumulate spcs, crps, pfrs</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>            spc <span class="op">=</span> fast_spc(simulation, list_length)</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>            spc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Study Position'</span>: np.arange(<span class="bu">len</span>(spc)), <span class="st">'Recall Rate'</span>: spc, varied_parameter: parameter_value})</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>            spcs.append(spc)</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>            crp <span class="op">=</span> fast_crp(simulation, list_length)</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>            crp[list_length<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>            crp <span class="op">=</span> pd.DataFrame(</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Lag'</span>: np.arange(max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>max_lag, <span class="st">'Recall Rate'</span>: crp[list_length<span class="op">-</span>max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>max_lag], varied_parameter: parameter_value})</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>            crps.append(crp)</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>            pfr <span class="op">=</span> fast_pfr(simulation, list_length)</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>            pfr <span class="op">=</span> pd.DataFrame(</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Study Position'</span>: np.arange(<span class="bu">len</span>(pfr)), <span class="st">'First Recall Rate'</span>: pfr, varied_parameter: parameter_value})</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>            pfrs.append(pfr)</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>                <span class="co">#TODO: still have to update for CMR</span></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>                mfc_connectivity <span class="op">=</span> connectivity_by_lag(model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>], model.item_count)</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>                mcf_connectivity <span class="op">=</span> connectivity_by_lag(model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :], model.item_count)</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>                latent_mfc, latent_mcf, latent_mff <span class="op">=</span> latent_mfc_mcf_mff(model, model.recall_items)</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>                mfc_connectivity <span class="op">=</span> connectivity_by_lag(latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>], model.item_count)</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>                mcf_connectivity <span class="op">=</span> connectivity_by_lag(latent_mcf, model.item_count)</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>                mff_connectivity <span class="op">=</span> connectivity_by_lag(latent_mff, model.item_count)</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>            mfc_connectivity[model.item_count<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>            mcf_connectivity[model.item_count<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>            mfc_connectivity <span class="op">=</span> pd.DataFrame(</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Lag'</span>: np.arange(max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>max_lag, <span class="st">'Recall Rate'</span>: mfc_connectivity[model.item_count<span class="op">-</span>max_lag<span class="op">-</span><span class="dv">1</span>:model.item_count<span class="op">+</span>max_lag], varied_parameter: parameter_value}</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>            mcf_connectivity <span class="op">=</span> pd.DataFrame(</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Lag'</span>: np.arange(max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>max_lag, <span class="st">'Recall Rate'</span>: mcf_connectivity[model.item_count<span class="op">-</span>max_lag<span class="op">-</span><span class="dv">1</span>:model.item_count<span class="op">+</span>max_lag], varied_parameter: parameter_value}</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>            mff_connectivity <span class="op">=</span> pd.DataFrame(</span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Lag'</span>: np.arange(max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>max_lag, <span class="st">'Recall Rate'</span>: mff_connectivity[model.item_count<span class="op">-</span>max_lag<span class="op">-</span><span class="dv">1</span>:model.item_count<span class="op">+</span>max_lag], varied_parameter: parameter_value}</span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>            mfc_connectivities.append(mfc_connectivity)</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>            mcf_connectivities.append(mcf_connectivity)</span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>            mff_connectivities.append(mff_connectivity)</span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># concatenate result into a single table</span></span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>        spc <span class="op">=</span> pd.concat(spcs).reset_index()</span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>        crp <span class="op">=</span> pd.concat(crps).reset_index()</span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>        pfr <span class="op">=</span> pd.concat(pfrs).reset_index()</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>        mfc_connectivity <span class="op">=</span> pd.concat(mfc_connectivities).reset_index()</span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>        mcf_connectivity <span class="op">=</span> pd.concat(mcf_connectivities).reset_index()</span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>        mff_connectivity <span class="op">=</span> pd.concat(mff_connectivities).reset_index()</span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>        sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'darkgrid'</span>)</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>        fig, axes <span class="op">=</span> plt.subplots(<span class="dv">6</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">20</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>], data<span class="op">=</span>spc, x<span class="op">=</span><span class="st">'Study Position'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axes[0].set_xlabel('Study Position')</span></span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>        <span class="co">#axes[0].set_ylabel('Probability Recall')</span></span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">0</span>].legend(np.<span class="bu">round</span>(score_ranges[varied_parameter], <span class="dv">5</span>), bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>pfr, x<span class="op">=</span><span class="st">'Study Position'</span>, y<span class="op">=</span><span class="st">'First Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>        filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>max_lag<span class="sc">}</span><span class="ss"> &lt;= Lag &lt; 0'</span></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>        filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; Lag &lt;= </span><span class="sc">{</span>max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>], data<span class="op">=</span>crp.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>], data<span class="op">=</span>crp.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">2</span>].set_title(<span class="st">'Lag-CRP'</span>)</span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-108"><a href="#cb47-108" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>], data<span class="op">=</span>mfc_connectivity.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-109"><a href="#cb47-109" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>], data<span class="op">=</span>mfc_connectivity.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-110"><a href="#cb47-110" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">3</span>].set_title(<span class="st">'MFC Lag-Connectivity'</span>)</span>
<span id="cb47-111"><a href="#cb47-111" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-112"><a href="#cb47-112" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">4</span>], data<span class="op">=</span>mcf_connectivity.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-113"><a href="#cb47-113" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">4</span>], data<span class="op">=</span>mcf_connectivity.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-114"><a href="#cb47-114" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">4</span>].set_title(<span class="st">'MCF Lag-Connectivity'</span>)</span>
<span id="cb47-115"><a href="#cb47-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-116"><a href="#cb47-116" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">5</span>], data<span class="op">=</span>mff_connectivity.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-117"><a href="#cb47-117" aria-hidden="true" tabindex="-1"></a>        sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">5</span>], data<span class="op">=</span>mff_connectivity.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb47-118"><a href="#cb47-118" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">5</span>].set_title(<span class="st">'MFF Lag-Connectivity'</span>)</span>
<span id="cb47-119"><a href="#cb47-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-120"><a href="#cb47-120" aria-hidden="true" tabindex="-1"></a>        plt.tight_layout(pad<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb47-121"><a href="#cb47-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-122"><a href="#cb47-122" aria-hidden="true" tabindex="-1"></a>        fig.suptitle(varied_parameter.replace(<span class="st">'_'</span>, <span class="st">' '</span>).upper())</span>
<span id="cb47-123"><a href="#cb47-123" aria-hidden="true" tabindex="-1"></a>        <span class="co">#plt.savefig('results/{}_{}.svg'.format(model.__name__, varied_parameter))</span></span>
<span id="cb47-124"><a href="#cb47-124" aria-hidden="true" tabindex="-1"></a>        plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>encoding_drift_rate 0.8015623810548206</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:19&lt;00:00,  1.97s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-20-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>recall_drift_rate 0.959155432955042</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:16&lt;00:00,  1.63s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-20-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/4 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>shared_support 0.008429792074646641</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:06&lt;00:00,  1.65s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-20-output-12.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/9 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>item_support 0.7496270374441739</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [00:14&lt;00:00,  1.61s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-20-output-16.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>learning_rate 0.5079383408154622</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:16&lt;00:00,  1.62s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-20-output-20.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>choice_sensitivity 1.0</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:16&lt;00:00,  1.64s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-20-output-24.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="repetition-lag-connectivity-analysis" class="level2">
<h2 class="anchored" data-anchor-id="repetition-lag-connectivity-analysis">Repetition Lag-Connectivity Analysis</h2>
<section id="instancecmr-5" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr-5">InstanceCMR</h3>
<div class="cell" data-execution_count="33">
<div class="sourceCode" id="cb66"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Instance_CMR</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> icmr_fitted_parameters</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">4</span>]:</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>            <span class="co">#TODO: More classic_cmr stuff to update</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trial_index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mfc)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mcf)</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(presentation)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>            latent_mfc, mcf_connections, mff_connections <span class="op">=</span> latent_mfc_mcf_mff(model, model.items)</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>        mff_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity <span class="op">=</span> mff_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># focus on +/- 3 lags</span></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>    plotting_lag_range <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivity[</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>        :, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivity[</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>        :, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity <span class="op">=</span> mff_alternative_connectivity[</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>        :, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">5</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">1</span>])), mcf_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">1</span>])), mfc_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFF</span></span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(np.arange(<span class="bu">len</span>(mff_alternative_connectivity[<span class="dv">0</span>])), mff_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(np.arange(<span class="bu">len</span>(mff_alternative_connectivity[<span class="dv">1</span>])), mff_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_title(<span class="st">'MFF'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace-reinstatement-cmr-5" class="level3">
<h3 class="anchored" data-anchor-id="trace-reinstatement-cmr-5">Trace-Reinstatement CMR</h3>
<div class="cell" data-execution_count="48">
<div class="sourceCode" id="cb67"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Trace_Reinstatement_CMR</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> trcmr_fitted_parameters</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">4</span>]:</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>            <span class="co">#TODO: More classic_cmr stuff to update</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trial_index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mfc)</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mcf)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(presentation)</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>            latent_mfc, mcf_connections, mff_connections <span class="op">=</span> latent_mfc_mcf_mff(model, model.recall_items)</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>        mff_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity <span class="op">=</span> mff_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># focus on +/- 3 lags</span></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>    plotting_lag_range <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivity[</span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>        :, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivity[</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>        :, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>    mff_alternative_connectivity <span class="op">=</span> mff_alternative_connectivity[</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>        :, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">5</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">1</span>])), mcf_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">1</span>])), mfc_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFF</span></span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(np.arange(<span class="bu">len</span>(mff_alternative_connectivity[<span class="dv">0</span>])), mff_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].plot(np.arange(<span class="bu">len</span>(mff_alternative_connectivity[<span class="dv">1</span>])), mff_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].set_title(<span class="st">'MFF'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="mixed-list-parameter-shifting" class="level2">
<h2 class="anchored" data-anchor-id="mixed-list-parameter-shifting">Mixed List Parameter Shifting</h2>
<section id="instance_cmr" class="level3">
<h3 class="anchored" data-anchor-id="instance_cmr">Instance_CMR</h3>
<div class="cell" data-execution_count="22">
<div class="sourceCode" id="cb68"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> init_icmr</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'Instance_CMR'</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> icmr_fitted_parameters</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>list_type <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> list_length<span class="op">-</span><span class="dv">1</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>crp_max_lag <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>rep_crp_max_lag <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>score_ranges <span class="op">=</span> {</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.005</span>, <span class="fl">.001</span>),</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.01</span>, <span class="fl">.001</span>),</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>: np.arange(<span class="fl">.001</span>, <span class="dv">5</span>, <span class="fl">.5</span>),</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> varied_parameter <span class="kw">in</span> score_ranges.keys():</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(varied_parameter, parameters[varied_parameter])</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    spcs <span class="op">=</span> []</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>    pfrs <span class="op">=</span> []</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    rpls <span class="op">=</span> []</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    crps <span class="op">=</span> []</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    rep_crps <span class="op">=</span> []</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    lag_mcfs <span class="op">=</span> []</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    lag_mfcs <span class="op">=</span> []</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    lag_mffs <span class="op">=</span> []</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    rep_lag_mcfs <span class="op">=</span> []</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>    rep_lag_mfcs <span class="op">=</span> []</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>    rep_lag_mffs <span class="op">=</span> []</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through parameter values</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parameter_value <span class="kw">in</span> tqdm(score_ranges[varied_parameter]):</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate data with this parameter value modified</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>        model_parameters <span class="op">=</span> parameters.copy()</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>        model_parameters[varied_parameter] <span class="op">=</span> parameter_value</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>        model_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>            model_class, model_parameters, presentations[list_types<span class="op">==</span>list_type], experiment_count)</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a>        model_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>list_type], experiment_count, <span class="dv">1</span>)</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># spc</span></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>        spc <span class="op">=</span> flex_mixed_spc(model_trials, model_presentations)</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>        spc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Study Position'</span>: np.arange(<span class="bu">len</span>(spc)), <span class="st">'Recall Rate'</span>: spc, varied_parameter: parameter_value})</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>        spcs.append(spc)</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pfr</span></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>        pfr <span class="op">=</span> flex_mixed_pfr(model_trials, model_presentations)</span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>        pfr <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Study Position'</span>: np.arange(<span class="bu">len</span>(pfr)), <span class="st">'First Recall Rate'</span>: pfr, varied_parameter: parameter_value})</span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>        pfrs.append(pfr)</span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># rpl</span></span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>        rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>            model_trials, model_presentations, max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>        binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">0</span>] <span class="op">=</span> rpl[<span class="dv">0</span>]</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">1</span>] <span class="op">=</span> rpl[<span class="dv">1</span>]</span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">2</span>] <span class="op">=</span> (rpl[<span class="dv">2</span>] <span class="op">+</span> rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">3</span>] <span class="op">=</span> (rpl[<span class="dv">4</span>] <span class="op">+</span> rpl[<span class="dv">5</span>] <span class="op">+</span> rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">4</span>] <span class="op">=</span> (rpl[<span class="dv">7</span>] <span class="op">+</span> rpl[<span class="dv">8</span>] <span class="op">+</span> rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>        rpl <span class="op">=</span> binned.copy()</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>        rpl <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Spacing'</span>: [<span class="st">'N/A'</span>, <span class="st">'0'</span>, <span class="st">'1-2'</span>, <span class="st">'3-5'</span>, <span class="st">'6-8'</span>], <span class="st">'Recall Rate'</span>: rpl, varied_parameter: parameter_value})</span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a>        rpls.append(rpl)</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># crp</span></span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a>        crp <span class="op">=</span> flex_mixed_crp(model_trials, model_presentations)</span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>        crp[global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>        crp <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(crp_max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>crp_max_lag, </span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: crp[list_length<span class="op">-</span>crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>crp_max_lag], </span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a>        crps.append(crp)</span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># rep crp</span></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a>        rep_crp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a>            model_trials, model_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a>        rep_crp[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a>        rep_crp <span class="op">=</span> pd.DataFrame({</span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Lag"</span>: np.arange(rep_crp_max_lag <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>) <span class="op">-</span> rep_crp_max_lag,</span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Differential Recall Rate"</span>: rep_crp[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length <span class="op">+</span> rep_crp_max_lag]</span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a>                    <span class="op">-</span> rep_crp[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag],</span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a>                varied_parameter: parameter_value,</span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a>        rep_crps.append(rep_crp)</span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a>        <span class="co"># lag-connectivity requires more involved computations...</span></span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a>        total_lag_mfc <span class="op">=</span> np.zeros((global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a>        total_lag_mcf <span class="op">=</span> np.zeros((global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a>        total_lag_mff <span class="op">=</span> np.zeros((global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb68-98"><a href="#cb68-98" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mfc <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb68-99"><a href="#cb68-99" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mcf <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mff <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># loop through presentations</span></span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate list study</span></span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a>            item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a>            model.experience(model.items[presentation])</span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a>            <span class="co"># extract item connections</span></span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a>            latent_mfc, mcf_connections, mff_connections <span class="op">=</span> latent_mfc_mcf_mff(model, model.items)</span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb68-113"><a href="#cb68-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-114"><a href="#cb68-114" aria-hidden="true" tabindex="-1"></a>            <span class="co"># track repetition connectivity</span></span>
<span id="cb68-115"><a href="#cb68-115" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mfc <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mcf <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mff <span class="op">+=</span> alternative_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb68-118"><a href="#cb68-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-119"><a href="#cb68-119" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and overall connectivity</span></span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a>            total_lag_mfc <span class="op">+=</span> mixed_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a>            total_lag_mcf <span class="op">+=</span> mixed_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a>            total_lag_mff <span class="op">+=</span> mixed_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reduce sum to mean</span></span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a>        <span class="co"># repetition connectivity</span></span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc <span class="op">=</span> total_rep_lag_mfc <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb68-127"><a href="#cb68-127" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf <span class="op">=</span> total_rep_lag_mcf <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb68-128"><a href="#cb68-128" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff <span class="op">=</span> total_rep_lag_mff <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb68-131"><a href="#cb68-131" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb68-132"><a href="#cb68-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a>        <span class="co"># overall connectivity</span></span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a>        lag_mfc <span class="op">=</span> total_lag_mfc <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb68-135"><a href="#cb68-135" aria-hidden="true" tabindex="-1"></a>        lag_mcf <span class="op">=</span> total_lag_mcf <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb68-136"><a href="#cb68-136" aria-hidden="true" tabindex="-1"></a>        lag_mff <span class="op">=</span> total_lag_mff <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a>        lag_mfc[global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a>        lag_mcf[global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a>        lag_mff[global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a>        <span class="co"># aggregate for dataframe</span></span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag,</span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Differential Recall Rate'</span>: rep_lag_mfc[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag]</span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> rep_lag_mfc[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag],</span>
<span id="cb68-146"><a href="#cb68-146" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb68-147"><a href="#cb68-147" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-148"><a href="#cb68-148" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag,</span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Differential Recall Rate'</span>: rep_lag_mcf[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag]</span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> rep_lag_mcf[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag],</span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb68-152"><a href="#cb68-152" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-153"><a href="#cb68-153" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag,</span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Differential Recall Rate'</span>: rep_lag_mff[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag]</span>
<span id="cb68-155"><a href="#cb68-155" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> rep_lag_mff[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag],</span>
<span id="cb68-156"><a href="#cb68-156" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb68-157"><a href="#cb68-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-158"><a href="#cb68-158" aria-hidden="true" tabindex="-1"></a>        lag_mfc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-159"><a href="#cb68-159" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>crp_max_lag,</span>
<span id="cb68-160"><a href="#cb68-160" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: lag_mfc[list_length<span class="op">-</span>crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>crp_max_lag],</span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a>        lag_mcf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>crp_max_lag,</span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: lag_mcf[list_length<span class="op">-</span>crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>crp_max_lag],</span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a>        lag_mff <span class="op">=</span> pd.DataFrame(</span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>crp_max_lag,</span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: lag_mff[list_length<span class="op">-</span>crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>crp_max_lag],</span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcfs.append(rep_lag_mcf)</span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a>        rep_lag_mffs.append(rep_lag_mff)</span>
<span id="cb68-173"><a href="#cb68-173" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfcs.append(rep_lag_mfc)</span>
<span id="cb68-174"><a href="#cb68-174" aria-hidden="true" tabindex="-1"></a>        lag_mcfs.append(lag_mcf)</span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a>        lag_mffs.append(lag_mff)</span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a>        lag_mfcs.append(lag_mfc)</span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a>    <span class="co"># aggregate fitting results</span></span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a>    spc <span class="op">=</span> pd.concat(spcs).reset_index()</span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a>    pfr <span class="op">=</span> pd.concat(pfrs).reset_index()</span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a>    crp <span class="op">=</span> pd.concat(crps).reset_index()</span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a>    rpl <span class="op">=</span> pd.concat(rpls).reset_index()</span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a>    rep_crp <span class="op">=</span> pd.concat(rep_crps).reset_index()</span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a>    lag_mcf <span class="op">=</span> pd.concat(lag_mcfs).reset_index()</span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a>    lag_mff <span class="op">=</span> pd.concat(lag_mffs).reset_index()</span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a>    lag_mfc <span class="op">=</span> pd.concat(lag_mfcs).reset_index()</span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a>    rep_lag_mcf <span class="op">=</span> pd.concat(rep_lag_mcfs).reset_index()</span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a>    rep_lag_mff <span class="op">=</span> pd.concat(rep_lag_mffs).reset_index()</span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a>    rep_lag_mfc <span class="op">=</span> pd.concat(rep_lag_mfcs).reset_index()</span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-191"><a href="#cb68-191" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb68-192"><a href="#cb68-192" aria-hidden="true" tabindex="-1"></a>    sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'darkgrid'</span>)</span>
<span id="cb68-193"><a href="#cb68-193" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">4</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">25</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-194"><a href="#cb68-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a>    <span class="co"># spc</span></span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>], data<span class="op">=</span>spc, x<span class="op">=</span><span class="st">'Study Position'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pfr</span></span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], data<span class="op">=</span>pfr, x<span class="op">=</span><span class="st">'Study Position'</span>, y<span class="op">=</span><span class="st">'First Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb68-202"><a href="#cb68-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-203"><a href="#cb68-203" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rpl (should be rps)</span></span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">2</span>], data<span class="op">=</span>rpl, x<span class="op">=</span><span class="st">'Spacing'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb68-205"><a href="#cb68-205" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">2</span>].set_title(<span class="st">'Recall Probability by Spacing'</span>)</span>
<span id="cb68-206"><a href="#cb68-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a>    <span class="co"># crp</span></span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a>    filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>crp_max_lag<span class="sc">}</span><span class="ss"> &lt;= Lag &lt; 0'</span></span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a>    filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; Lag &lt;= </span><span class="sc">{</span>crp_max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>crp.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, </span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>crp.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, </span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-214"><a href="#cb68-214" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'CRP'</span>)</span>
<span id="cb68-215"><a href="#cb68-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-216"><a href="#cb68-216" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_crp</span></span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_crp.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Differential Recall Rate"</span>, </span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_crp.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Differential Recall Rate"</span>, </span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'Repetition Lag-Contiguity Difference'</span>)</span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lag_mcf</span></span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], data<span class="op">=</span>lag_mcf.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb68-225"><a href="#cb68-225" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-226"><a href="#cb68-226" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], data<span class="op">=</span>lag_mcf.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lag_mfc</span></span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], data<span class="op">=</span>lag_mfc.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], data<span class="op">=</span>lag_mfc.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-235"><a href="#cb68-235" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lag_mff</span></span>
<span id="cb68-236"><a href="#cb68-236" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">2</span>], data<span class="op">=</span>lag_mff.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb68-237"><a href="#cb68-237" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-238"><a href="#cb68-238" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">2</span>], data<span class="op">=</span>lag_mff.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mcf</span></span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mcf.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mcf.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb68-245"><a href="#cb68-245" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-246"><a href="#cb68-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mfc</span></span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mfc.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb68-249"><a href="#cb68-249" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-250"><a href="#cb68-250" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mfc.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb68-251"><a href="#cb68-251" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-252"><a href="#cb68-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mff</span></span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">2</span>], data<span class="op">=</span>rep_lag_mff.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">2</span>], data<span class="op">=</span>rep_lag_mff.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a>    <span class="co"># render result</span></span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb68-261"><a href="#cb68-261" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>encoding_drift_rate 0.832809463</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [03:15&lt;00:00, 19.51s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-23-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>recall_drift_rate 0.961140398</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [03:13&lt;00:00, 19.32s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-23-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/4 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>shared_support 0.0011990853</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:15&lt;00:00, 18.94s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-23-output-12.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/9 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>item_support 0.131621512</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [02:51&lt;00:00, 19.06s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-23-output-16.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>learning_rate 0.245449928</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [03:20&lt;00:00, 20.04s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-23-output-20.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>choice_sensitivity 1.0</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [03:24&lt;00:00, 20.41s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-23-output-24.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace-reinstatement-cmr-6" class="level3">
<h3 class="anchored" data-anchor-id="trace-reinstatement-cmr-6">Trace-Reinstatement CMR</h3>
<div class="cell" data-execution_count="49">
<div class="sourceCode" id="cb87"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> init_trcmr</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'Trace-Reinstatement CMR'</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> trcmr_fitted_parameters</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>list_type <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> list_length<span class="op">-</span><span class="dv">1</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>crp_max_lag <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>rep_crp_max_lag <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>score_ranges <span class="op">=</span> {</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="dv">1</span>, <span class="fl">.1</span>),</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> varied_parameter <span class="kw">in</span> score_ranges.keys():</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(varied_parameter, parameters[varied_parameter])</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(score_ranges[varied_parameter])</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    spcs <span class="op">=</span> []</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    pfrs <span class="op">=</span> []</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    rpls <span class="op">=</span> []</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    crps <span class="op">=</span> []</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    rep_crps <span class="op">=</span> []</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>    lag_mcfs <span class="op">=</span> []</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>    lag_mfcs <span class="op">=</span> []</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    lag_mffs <span class="op">=</span> []</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>    rep_lag_mcfs <span class="op">=</span> []</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>    rep_lag_mfcs <span class="op">=</span> []</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>    rep_lag_mffs <span class="op">=</span> []</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through parameter values</span></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parameter_value <span class="kw">in</span> tqdm(score_ranges[varied_parameter]):</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate data with this parameter value modified</span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>        model_parameters <span class="op">=</span> parameters.copy()</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>        model_parameters[varied_parameter] <span class="op">=</span> parameter_value</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>        model_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>            model_class, model_parameters, presentations[list_types<span class="op">==</span>list_type], experiment_count)</span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>        model_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>list_type], experiment_count, <span class="dv">1</span>)</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># spc</span></span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>        spc <span class="op">=</span> flex_mixed_spc(model_trials, model_presentations)</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>        spc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>                {<span class="st">'Study Position'</span>: np.arange(<span class="bu">len</span>(spc)), <span class="st">'Recall Rate'</span>: spc, varied_parameter: parameter_value})</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>        spcs.append(spc)</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pfr</span></span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>        pfr <span class="op">=</span> flex_mixed_pfr(model_trials, model_presentations)</span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a>        pfr <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Study Position'</span>: np.arange(<span class="bu">len</span>(pfr)), <span class="st">'First Recall Rate'</span>: pfr, varied_parameter: parameter_value})</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>        pfrs.append(pfr)</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># rpl</span></span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>        rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a>            model_trials, model_presentations, max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a>        binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">0</span>] <span class="op">=</span> rpl[<span class="dv">0</span>]</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">1</span>] <span class="op">=</span> rpl[<span class="dv">1</span>]</span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">2</span>] <span class="op">=</span> (rpl[<span class="dv">2</span>] <span class="op">+</span> rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">3</span>] <span class="op">=</span> (rpl[<span class="dv">4</span>] <span class="op">+</span> rpl[<span class="dv">5</span>] <span class="op">+</span> rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">4</span>] <span class="op">=</span> (rpl[<span class="dv">7</span>] <span class="op">+</span> rpl[<span class="dv">8</span>] <span class="op">+</span> rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a>        rpl <span class="op">=</span> binned.copy()</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a>        rpl <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Spacing'</span>: [<span class="st">'N/A'</span>, <span class="st">'0'</span>, <span class="st">'1-2'</span>, <span class="st">'3-5'</span>, <span class="st">'6-8'</span>], <span class="st">'Recall Rate'</span>: rpl, varied_parameter: parameter_value})</span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a>        rpls.append(rpl)</span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># crp</span></span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a>        crp <span class="op">=</span> flex_mixed_crp(model_trials, model_presentations)</span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>        crp[global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a>        crp <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-73"><a href="#cb87-73" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(crp_max_lag<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>crp_max_lag, </span>
<span id="cb87-74"><a href="#cb87-74" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: crp[list_length<span class="op">-</span>crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>crp_max_lag], </span>
<span id="cb87-75"><a href="#cb87-75" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb87-76"><a href="#cb87-76" aria-hidden="true" tabindex="-1"></a>        crps.append(crp)</span>
<span id="cb87-77"><a href="#cb87-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-78"><a href="#cb87-78" aria-hidden="true" tabindex="-1"></a>        <span class="co"># rep crp</span></span>
<span id="cb87-79"><a href="#cb87-79" aria-hidden="true" tabindex="-1"></a>        rep_crp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb87-80"><a href="#cb87-80" aria-hidden="true" tabindex="-1"></a>            model_trials, model_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb87-81"><a href="#cb87-81" aria-hidden="true" tabindex="-1"></a>        rep_crp[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb87-82"><a href="#cb87-82" aria-hidden="true" tabindex="-1"></a>        rep_crp <span class="op">=</span> pd.DataFrame({</span>
<span id="cb87-83"><a href="#cb87-83" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Lag"</span>: np.arange(rep_crp_max_lag <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>) <span class="op">-</span> rep_crp_max_lag,</span>
<span id="cb87-84"><a href="#cb87-84" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Differential Recall Rate"</span>: rep_crp[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length <span class="op">+</span> rep_crp_max_lag]</span>
<span id="cb87-85"><a href="#cb87-85" aria-hidden="true" tabindex="-1"></a>                    <span class="op">-</span> rep_crp[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag],</span>
<span id="cb87-86"><a href="#cb87-86" aria-hidden="true" tabindex="-1"></a>                varied_parameter: parameter_value,</span>
<span id="cb87-87"><a href="#cb87-87" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb87-88"><a href="#cb87-88" aria-hidden="true" tabindex="-1"></a>        rep_crps.append(rep_crp)</span>
<span id="cb87-89"><a href="#cb87-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-90"><a href="#cb87-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># lag-connectivity requires more involved computations...</span></span>
<span id="cb87-91"><a href="#cb87-91" aria-hidden="true" tabindex="-1"></a>        total_lag_mfc <span class="op">=</span> np.zeros((global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb87-92"><a href="#cb87-92" aria-hidden="true" tabindex="-1"></a>        total_lag_mcf <span class="op">=</span> np.zeros((global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb87-93"><a href="#cb87-93" aria-hidden="true" tabindex="-1"></a>        total_lag_mff <span class="op">=</span> np.zeros((global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb87-94"><a href="#cb87-94" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mfc <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb87-95"><a href="#cb87-95" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mcf <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb87-96"><a href="#cb87-96" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mff <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb87-97"><a href="#cb87-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-98"><a href="#cb87-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># loop through presentations</span></span>
<span id="cb87-99"><a href="#cb87-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb87-100"><a href="#cb87-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-101"><a href="#cb87-101" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate list study</span></span>
<span id="cb87-102"><a href="#cb87-102" aria-hidden="true" tabindex="-1"></a>            item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb87-103"><a href="#cb87-103" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb87-104"><a href="#cb87-104" aria-hidden="true" tabindex="-1"></a>            model.experience(model.items[presentation])</span>
<span id="cb87-105"><a href="#cb87-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-106"><a href="#cb87-106" aria-hidden="true" tabindex="-1"></a>            <span class="co"># extract item connections</span></span>
<span id="cb87-107"><a href="#cb87-107" aria-hidden="true" tabindex="-1"></a>            latent_mfc, mcf_connections, mff_connections <span class="op">=</span> latent_mfc_mcf_mff(model, model.recall_items)</span>
<span id="cb87-108"><a href="#cb87-108" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb87-109"><a href="#cb87-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-110"><a href="#cb87-110" aria-hidden="true" tabindex="-1"></a>            <span class="co"># track repetition connectivity</span></span>
<span id="cb87-111"><a href="#cb87-111" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mfc <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb87-112"><a href="#cb87-112" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mcf <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb87-113"><a href="#cb87-113" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mff <span class="op">+=</span> alternative_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb87-114"><a href="#cb87-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-115"><a href="#cb87-115" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and overall connectivity</span></span>
<span id="cb87-116"><a href="#cb87-116" aria-hidden="true" tabindex="-1"></a>            total_lag_mfc <span class="op">+=</span> mixed_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb87-117"><a href="#cb87-117" aria-hidden="true" tabindex="-1"></a>            total_lag_mcf <span class="op">+=</span> mixed_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb87-118"><a href="#cb87-118" aria-hidden="true" tabindex="-1"></a>            total_lag_mff <span class="op">+=</span> mixed_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb87-119"><a href="#cb87-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-120"><a href="#cb87-120" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reduce sum to mean</span></span>
<span id="cb87-121"><a href="#cb87-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># repetition connectivity</span></span>
<span id="cb87-122"><a href="#cb87-122" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc <span class="op">=</span> total_rep_lag_mfc <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb87-123"><a href="#cb87-123" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf <span class="op">=</span> total_rep_lag_mcf <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb87-124"><a href="#cb87-124" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff <span class="op">=</span> total_rep_lag_mff <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb87-125"><a href="#cb87-125" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb87-126"><a href="#cb87-126" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb87-127"><a href="#cb87-127" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb87-128"><a href="#cb87-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-129"><a href="#cb87-129" aria-hidden="true" tabindex="-1"></a>        <span class="co"># overall connectivity</span></span>
<span id="cb87-130"><a href="#cb87-130" aria-hidden="true" tabindex="-1"></a>        lag_mfc <span class="op">=</span> total_lag_mfc <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb87-131"><a href="#cb87-131" aria-hidden="true" tabindex="-1"></a>        lag_mcf <span class="op">=</span> total_lag_mcf <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb87-132"><a href="#cb87-132" aria-hidden="true" tabindex="-1"></a>        lag_mff <span class="op">=</span> total_lag_mff <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb87-133"><a href="#cb87-133" aria-hidden="true" tabindex="-1"></a>        lag_mfc[global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb87-134"><a href="#cb87-134" aria-hidden="true" tabindex="-1"></a>        lag_mcf[global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb87-135"><a href="#cb87-135" aria-hidden="true" tabindex="-1"></a>        lag_mff[global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb87-136"><a href="#cb87-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-137"><a href="#cb87-137" aria-hidden="true" tabindex="-1"></a>        <span class="co"># aggregate for dataframe</span></span>
<span id="cb87-138"><a href="#cb87-138" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-139"><a href="#cb87-139" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag,</span>
<span id="cb87-140"><a href="#cb87-140" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Differential Recall Rate'</span>: rep_lag_mfc[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag]</span>
<span id="cb87-141"><a href="#cb87-141" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> rep_lag_mfc[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag],</span>
<span id="cb87-142"><a href="#cb87-142" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb87-143"><a href="#cb87-143" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-144"><a href="#cb87-144" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag,</span>
<span id="cb87-145"><a href="#cb87-145" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Differential Recall Rate'</span>: rep_lag_mcf[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag]</span>
<span id="cb87-146"><a href="#cb87-146" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> rep_lag_mcf[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag],</span>
<span id="cb87-147"><a href="#cb87-147" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb87-148"><a href="#cb87-148" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-149"><a href="#cb87-149" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag,</span>
<span id="cb87-150"><a href="#cb87-150" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Differential Recall Rate'</span>: rep_lag_mff[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag]</span>
<span id="cb87-151"><a href="#cb87-151" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span> rep_lag_mff[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag],</span>
<span id="cb87-152"><a href="#cb87-152" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb87-153"><a href="#cb87-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-154"><a href="#cb87-154" aria-hidden="true" tabindex="-1"></a>        lag_mfc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-155"><a href="#cb87-155" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>crp_max_lag,</span>
<span id="cb87-156"><a href="#cb87-156" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: lag_mfc[list_length<span class="op">-</span>crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>crp_max_lag],</span>
<span id="cb87-157"><a href="#cb87-157" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb87-158"><a href="#cb87-158" aria-hidden="true" tabindex="-1"></a>        lag_mcf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-159"><a href="#cb87-159" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>crp_max_lag,</span>
<span id="cb87-160"><a href="#cb87-160" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: lag_mcf[list_length<span class="op">-</span>crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>crp_max_lag],</span>
<span id="cb87-161"><a href="#cb87-161" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb87-162"><a href="#cb87-162" aria-hidden="true" tabindex="-1"></a>        lag_mff <span class="op">=</span> pd.DataFrame(</span>
<span id="cb87-163"><a href="#cb87-163" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: np.arange(crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>crp_max_lag,</span>
<span id="cb87-164"><a href="#cb87-164" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: lag_mff[list_length<span class="op">-</span>crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>crp_max_lag],</span>
<span id="cb87-165"><a href="#cb87-165" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value})</span>
<span id="cb87-166"><a href="#cb87-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-167"><a href="#cb87-167" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcfs.append(rep_lag_mcf)</span>
<span id="cb87-168"><a href="#cb87-168" aria-hidden="true" tabindex="-1"></a>        rep_lag_mffs.append(rep_lag_mff)</span>
<span id="cb87-169"><a href="#cb87-169" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfcs.append(rep_lag_mfc)</span>
<span id="cb87-170"><a href="#cb87-170" aria-hidden="true" tabindex="-1"></a>        lag_mcfs.append(lag_mcf)</span>
<span id="cb87-171"><a href="#cb87-171" aria-hidden="true" tabindex="-1"></a>        lag_mffs.append(lag_mff)</span>
<span id="cb87-172"><a href="#cb87-172" aria-hidden="true" tabindex="-1"></a>        lag_mfcs.append(lag_mfc)</span>
<span id="cb87-173"><a href="#cb87-173" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-174"><a href="#cb87-174" aria-hidden="true" tabindex="-1"></a>    <span class="co"># aggregate fitting results</span></span>
<span id="cb87-175"><a href="#cb87-175" aria-hidden="true" tabindex="-1"></a>    spc <span class="op">=</span> pd.concat(spcs).reset_index()</span>
<span id="cb87-176"><a href="#cb87-176" aria-hidden="true" tabindex="-1"></a>    pfr <span class="op">=</span> pd.concat(pfrs).reset_index()</span>
<span id="cb87-177"><a href="#cb87-177" aria-hidden="true" tabindex="-1"></a>    crp <span class="op">=</span> pd.concat(crps).reset_index()</span>
<span id="cb87-178"><a href="#cb87-178" aria-hidden="true" tabindex="-1"></a>    rpl <span class="op">=</span> pd.concat(rpls).reset_index()</span>
<span id="cb87-179"><a href="#cb87-179" aria-hidden="true" tabindex="-1"></a>    rep_crp <span class="op">=</span> pd.concat(rep_crps).reset_index()</span>
<span id="cb87-180"><a href="#cb87-180" aria-hidden="true" tabindex="-1"></a>    lag_mcf <span class="op">=</span> pd.concat(lag_mcfs).reset_index()</span>
<span id="cb87-181"><a href="#cb87-181" aria-hidden="true" tabindex="-1"></a>    lag_mff <span class="op">=</span> pd.concat(lag_mffs).reset_index()</span>
<span id="cb87-182"><a href="#cb87-182" aria-hidden="true" tabindex="-1"></a>    lag_mfc <span class="op">=</span> pd.concat(lag_mfcs).reset_index()</span>
<span id="cb87-183"><a href="#cb87-183" aria-hidden="true" tabindex="-1"></a>    rep_lag_mcf <span class="op">=</span> pd.concat(rep_lag_mcfs).reset_index()</span>
<span id="cb87-184"><a href="#cb87-184" aria-hidden="true" tabindex="-1"></a>    rep_lag_mff <span class="op">=</span> pd.concat(rep_lag_mffs).reset_index()</span>
<span id="cb87-185"><a href="#cb87-185" aria-hidden="true" tabindex="-1"></a>    rep_lag_mfc <span class="op">=</span> pd.concat(rep_lag_mfcs).reset_index()</span>
<span id="cb87-186"><a href="#cb87-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-187"><a href="#cb87-187" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb87-188"><a href="#cb87-188" aria-hidden="true" tabindex="-1"></a>    sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'darkgrid'</span>)</span>
<span id="cb87-189"><a href="#cb87-189" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">4</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">25</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-190"><a href="#cb87-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-191"><a href="#cb87-191" aria-hidden="true" tabindex="-1"></a>    <span class="co"># spc</span></span>
<span id="cb87-192"><a href="#cb87-192" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>], data<span class="op">=</span>spc, x<span class="op">=</span><span class="st">'Study Position'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb87-193"><a href="#cb87-193" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb87-194"><a href="#cb87-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-195"><a href="#cb87-195" aria-hidden="true" tabindex="-1"></a>    <span class="co"># pfr</span></span>
<span id="cb87-196"><a href="#cb87-196" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], data<span class="op">=</span>pfr, x<span class="op">=</span><span class="st">'Study Position'</span>, y<span class="op">=</span><span class="st">'First Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-197"><a href="#cb87-197" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb87-198"><a href="#cb87-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-199"><a href="#cb87-199" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rpl (should be rps)</span></span>
<span id="cb87-200"><a href="#cb87-200" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">2</span>], data<span class="op">=</span>rpl, x<span class="op">=</span><span class="st">'Spacing'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb87-201"><a href="#cb87-201" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">2</span>].set_title(<span class="st">'Recall Probability by Spacing'</span>)</span>
<span id="cb87-202"><a href="#cb87-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-203"><a href="#cb87-203" aria-hidden="true" tabindex="-1"></a>    <span class="co"># crp</span></span>
<span id="cb87-204"><a href="#cb87-204" aria-hidden="true" tabindex="-1"></a>    filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>crp_max_lag<span class="sc">}</span><span class="ss"> &lt;= Lag &lt; 0'</span></span>
<span id="cb87-205"><a href="#cb87-205" aria-hidden="true" tabindex="-1"></a>    filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; Lag &lt;= </span><span class="sc">{</span>crp_max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb87-206"><a href="#cb87-206" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>crp.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, </span>
<span id="cb87-207"><a href="#cb87-207" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-208"><a href="#cb87-208" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>crp.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>, </span>
<span id="cb87-209"><a href="#cb87-209" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-210"><a href="#cb87-210" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'CRP'</span>)</span>
<span id="cb87-211"><a href="#cb87-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-212"><a href="#cb87-212" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_crp</span></span>
<span id="cb87-213"><a href="#cb87-213" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_crp.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Differential Recall Rate"</span>, </span>
<span id="cb87-214"><a href="#cb87-214" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-215"><a href="#cb87-215" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_crp.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Differential Recall Rate"</span>, </span>
<span id="cb87-216"><a href="#cb87-216" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-217"><a href="#cb87-217" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'Repetition Lag-Contiguity Difference'</span>)</span>
<span id="cb87-218"><a href="#cb87-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-219"><a href="#cb87-219" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lag_mcf</span></span>
<span id="cb87-220"><a href="#cb87-220" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], data<span class="op">=</span>lag_mcf.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb87-221"><a href="#cb87-221" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-222"><a href="#cb87-222" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], data<span class="op">=</span>lag_mcf.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb87-223"><a href="#cb87-223" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-224"><a href="#cb87-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-225"><a href="#cb87-225" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lag_mfc</span></span>
<span id="cb87-226"><a href="#cb87-226" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], data<span class="op">=</span>lag_mfc.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb87-227"><a href="#cb87-227" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-228"><a href="#cb87-228" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], data<span class="op">=</span>lag_mfc.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb87-229"><a href="#cb87-229" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-230"><a href="#cb87-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-231"><a href="#cb87-231" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lag_mff</span></span>
<span id="cb87-232"><a href="#cb87-232" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">2</span>], data<span class="op">=</span>lag_mff.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb87-233"><a href="#cb87-233" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-234"><a href="#cb87-234" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">2</span>], data<span class="op">=</span>lag_mff.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Recall Rate'</span>,</span>
<span id="cb87-235"><a href="#cb87-235" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-236"><a href="#cb87-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-237"><a href="#cb87-237" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mcf</span></span>
<span id="cb87-238"><a href="#cb87-238" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mcf.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb87-239"><a href="#cb87-239" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-240"><a href="#cb87-240" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mcf.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb87-241"><a href="#cb87-241" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-242"><a href="#cb87-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-243"><a href="#cb87-243" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mfc</span></span>
<span id="cb87-244"><a href="#cb87-244" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mfc.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb87-245"><a href="#cb87-245" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-246"><a href="#cb87-246" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mfc.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb87-247"><a href="#cb87-247" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-248"><a href="#cb87-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-249"><a href="#cb87-249" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mff</span></span>
<span id="cb87-250"><a href="#cb87-250" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">2</span>], data<span class="op">=</span>rep_lag_mff.query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb87-251"><a href="#cb87-251" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-252"><a href="#cb87-252" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">2</span>], data<span class="op">=</span>rep_lag_mff.query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">'Differential Recall Rate'</span>,</span>
<span id="cb87-253"><a href="#cb87-253" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb87-254"><a href="#cb87-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-255"><a href="#cb87-255" aria-hidden="true" tabindex="-1"></a>    <span class="co"># render result</span></span>
<span id="cb87-256"><a href="#cb87-256" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>feature_drift_rate 1.0
[0.001 0.101 0.201 0.301 0.401 0.501 0.601 0.701 0.801 0.901]</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [04:29&lt;00:00, 26.98s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-24-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="repetition-contiguity-parameter-shifting-experiments" class="level2">
<h2 class="anchored" data-anchor-id="repetition-contiguity-parameter-shifting-experiments">Repetition Contiguity Parameter Shifting Experiments</h2>
<section id="instancecmr-6" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr-6">InstanceCMR</h3>
<div class="cell" data-execution_count="27">
<div class="sourceCode" id="cb91"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> init_icmr</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'Instance_CMR'</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> icmr_fitted_parameters</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>list_type <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> list_length<span class="op">-</span><span class="dv">1</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>crp_max_lag <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>rep_crp_max_lag <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>score_ranges <span class="op">=</span> {</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.005</span>, <span class="fl">.001</span>),</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.01</span>, <span class="fl">.001</span>),</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="fl">.99</span>, <span class="fl">.1</span>),</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>: np.arange(<span class="fl">.001</span>, <span class="dv">5</span>, <span class="fl">.5</span>),</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> varied_parameter <span class="kw">in</span> score_ranges.keys():</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(varied_parameter, parameters[varied_parameter])</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>    rep_crps <span class="op">=</span> []</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>    rep_lag_mcfs <span class="op">=</span> []</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>    rep_lag_mfcs <span class="op">=</span> []</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>    rep_lag_mffs <span class="op">=</span> []</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through parameter values</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parameter_value <span class="kw">in</span> tqdm(score_ranges[varied_parameter]):</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate data with this parameter value modified</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>        model_parameters <span class="op">=</span> parameters.copy()</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>        model_parameters[varied_parameter] <span class="op">=</span> parameter_value</span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>        model_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>            model_class, model_parameters, presentations[list_types<span class="op">==</span>list_type], experiment_count)</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>        model_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>list_type], experiment_count, <span class="dv">1</span>)</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># rep crp</span></span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>        rep_crp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>            model_trials, model_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>        rep_crp[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>        rep_crp <span class="op">=</span> pd.DataFrame({</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Lag"</span>: (np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag).tolist() <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Recall Rate"</span>: rep_crp[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length <span class="op">+</span> rep_crp_max_lag].tolist()</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>                    <span class="op">+</span> rep_crp[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist(),</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>                varied_parameter: parameter_value,</span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Position"</span>: [<span class="st">'First'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> [<span class="st">'Second'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>        rep_crps.append(rep_crp)</span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># lag-connectivity requires more involved computations...</span></span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mfc <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mcf <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb91-56"><a href="#cb91-56" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mff <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb91-57"><a href="#cb91-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-58"><a href="#cb91-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># loop through presentations</span></span>
<span id="cb91-59"><a href="#cb91-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb91-60"><a href="#cb91-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-61"><a href="#cb91-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate list study</span></span>
<span id="cb91-62"><a href="#cb91-62" aria-hidden="true" tabindex="-1"></a>            item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb91-63"><a href="#cb91-63" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb91-64"><a href="#cb91-64" aria-hidden="true" tabindex="-1"></a>            model.experience(model.items[presentation])</span>
<span id="cb91-65"><a href="#cb91-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-66"><a href="#cb91-66" aria-hidden="true" tabindex="-1"></a>            <span class="co"># extract item connections</span></span>
<span id="cb91-67"><a href="#cb91-67" aria-hidden="true" tabindex="-1"></a>            latent_mfc, mcf_connections, mff_connections <span class="op">=</span> latent_mfc_mcf_mff(model, model.items)</span>
<span id="cb91-68"><a href="#cb91-68" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb91-69"><a href="#cb91-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-70"><a href="#cb91-70" aria-hidden="true" tabindex="-1"></a>            <span class="co"># track repetition connectivity</span></span>
<span id="cb91-71"><a href="#cb91-71" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mfc <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb91-72"><a href="#cb91-72" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mcf <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb91-73"><a href="#cb91-73" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mff <span class="op">+=</span> alternative_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb91-74"><a href="#cb91-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-75"><a href="#cb91-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reduce sum to mean</span></span>
<span id="cb91-76"><a href="#cb91-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># repetition connectivity</span></span>
<span id="cb91-77"><a href="#cb91-77" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc <span class="op">=</span> total_rep_lag_mfc <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb91-78"><a href="#cb91-78" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf <span class="op">=</span> total_rep_lag_mcf <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb91-79"><a href="#cb91-79" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff <span class="op">=</span> total_rep_lag_mff <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb91-80"><a href="#cb91-80" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb91-81"><a href="#cb91-81" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb91-82"><a href="#cb91-82" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb91-83"><a href="#cb91-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-84"><a href="#cb91-84" aria-hidden="true" tabindex="-1"></a>        <span class="co"># aggregate for dataframe</span></span>
<span id="cb91-85"><a href="#cb91-85" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb91-86"><a href="#cb91-86" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: (np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag).tolist() <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb91-87"><a href="#cb91-87" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: rep_lag_mfc[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist()</span>
<span id="cb91-88"><a href="#cb91-88" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> rep_lag_mfc[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist(),</span>
<span id="cb91-89"><a href="#cb91-89" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value,</span>
<span id="cb91-90"><a href="#cb91-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Position"</span>: [<span class="st">'First'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> [<span class="st">'Second'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)})</span>
<span id="cb91-91"><a href="#cb91-91" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb91-92"><a href="#cb91-92" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: (np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag).tolist() <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb91-93"><a href="#cb91-93" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: rep_lag_mcf[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist()</span>
<span id="cb91-94"><a href="#cb91-94" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> rep_lag_mcf[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist(),</span>
<span id="cb91-95"><a href="#cb91-95" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value,</span>
<span id="cb91-96"><a href="#cb91-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Position"</span>: [<span class="st">'First'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> [<span class="st">'Second'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)})</span>
<span id="cb91-97"><a href="#cb91-97" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff <span class="op">=</span> pd.DataFrame(</span>
<span id="cb91-98"><a href="#cb91-98" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: (np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag).tolist() <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb91-99"><a href="#cb91-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: rep_lag_mff[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist()</span>
<span id="cb91-100"><a href="#cb91-100" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> rep_lag_mff[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist(),</span>
<span id="cb91-101"><a href="#cb91-101" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value,</span>
<span id="cb91-102"><a href="#cb91-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Position"</span>: [<span class="st">'First'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> [<span class="st">'Second'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)})</span>
<span id="cb91-103"><a href="#cb91-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-104"><a href="#cb91-104" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcfs.append(rep_lag_mcf)</span>
<span id="cb91-105"><a href="#cb91-105" aria-hidden="true" tabindex="-1"></a>        rep_lag_mffs.append(rep_lag_mff)</span>
<span id="cb91-106"><a href="#cb91-106" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfcs.append(rep_lag_mfc)</span>
<span id="cb91-107"><a href="#cb91-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-108"><a href="#cb91-108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># aggregate fitting results</span></span>
<span id="cb91-109"><a href="#cb91-109" aria-hidden="true" tabindex="-1"></a>    rep_crp <span class="op">=</span> pd.concat(rep_crps).reset_index()</span>
<span id="cb91-110"><a href="#cb91-110" aria-hidden="true" tabindex="-1"></a>    rep_lag_mcf <span class="op">=</span> pd.concat(rep_lag_mcfs).reset_index()</span>
<span id="cb91-111"><a href="#cb91-111" aria-hidden="true" tabindex="-1"></a>    rep_lag_mff <span class="op">=</span> pd.concat(rep_lag_mffs).reset_index()</span>
<span id="cb91-112"><a href="#cb91-112" aria-hidden="true" tabindex="-1"></a>    rep_lag_mfc <span class="op">=</span> pd.concat(rep_lag_mfcs).reset_index()</span>
<span id="cb91-113"><a href="#cb91-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-114"><a href="#cb91-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb91-115"><a href="#cb91-115" aria-hidden="true" tabindex="-1"></a>    sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'darkgrid'</span>)</span>
<span id="cb91-116"><a href="#cb91-116" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">4</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">25</span>, <span class="dv">25</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb91-117"><a href="#cb91-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-118"><a href="#cb91-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_crp</span></span>
<span id="cb91-119"><a href="#cb91-119" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_crp[rep_crp[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, </span>
<span id="cb91-120"><a href="#cb91-120" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-121"><a href="#cb91-121" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_crp[rep_crp[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, </span>
<span id="cb91-122"><a href="#cb91-122" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-123"><a href="#cb91-123" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_crp[rep_crp[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, </span>
<span id="cb91-124"><a href="#cb91-124" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-125"><a href="#cb91-125" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_crp[rep_crp[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, </span>
<span id="cb91-126"><a href="#cb91-126" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-127"><a href="#cb91-127" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'First Repetition Lag-Contiguity'</span>)</span>
<span id="cb91-128"><a href="#cb91-128" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Second Repetition Lag-Contiguity'</span>)</span>
<span id="cb91-129"><a href="#cb91-129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-130"><a href="#cb91-130" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mcf</span></span>
<span id="cb91-131"><a href="#cb91-131" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-132"><a href="#cb91-132" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mcf[rep_lag_mcf[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_neg), </span>
<span id="cb91-133"><a href="#cb91-133" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-134"><a href="#cb91-134" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-135"><a href="#cb91-135" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mcf[rep_lag_mcf[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_pos),</span>
<span id="cb91-136"><a href="#cb91-136" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-137"><a href="#cb91-137" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-138"><a href="#cb91-138" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mcf[rep_lag_mcf[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_neg),</span>
<span id="cb91-139"><a href="#cb91-139" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-140"><a href="#cb91-140" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-141"><a href="#cb91-141" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mcf[rep_lag_mcf[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_pos),</span>
<span id="cb91-142"><a href="#cb91-142" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-143"><a href="#cb91-143" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'MCF First Repetition Lag-Contiguity'</span>)</span>
<span id="cb91-144"><a href="#cb91-144" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'MCF Second Repetition Lag-Contiguity'</span>)</span>
<span id="cb91-145"><a href="#cb91-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-146"><a href="#cb91-146" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mfc</span></span>
<span id="cb91-147"><a href="#cb91-147" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-148"><a href="#cb91-148" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mfc[rep_lag_mfc[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_neg),</span>
<span id="cb91-149"><a href="#cb91-149" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-150"><a href="#cb91-150" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-151"><a href="#cb91-151" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mfc[rep_lag_mfc[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_pos),</span>
<span id="cb91-152"><a href="#cb91-152" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-153"><a href="#cb91-153" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-154"><a href="#cb91-154" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mfc[rep_lag_mfc[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_neg),</span>
<span id="cb91-155"><a href="#cb91-155" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-156"><a href="#cb91-156" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-157"><a href="#cb91-157" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mfc[rep_lag_mfc[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_pos),</span>
<span id="cb91-158"><a href="#cb91-158" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-159"><a href="#cb91-159" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'MFC First Repetition Lag-Contiguity'</span>)</span>
<span id="cb91-160"><a href="#cb91-160" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'MFC Second Repetition Lag-Contiguity'</span>)</span>
<span id="cb91-161"><a href="#cb91-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-162"><a href="#cb91-162" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mff</span></span>
<span id="cb91-163"><a href="#cb91-163" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-164"><a href="#cb91-164" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mff[rep_lag_mff[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_neg),</span>
<span id="cb91-165"><a href="#cb91-165" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-166"><a href="#cb91-166" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-167"><a href="#cb91-167" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mff[rep_lag_mff[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_pos),</span>
<span id="cb91-168"><a href="#cb91-168" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-169"><a href="#cb91-169" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-170"><a href="#cb91-170" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mff[rep_lag_mff[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_neg),</span>
<span id="cb91-171"><a href="#cb91-171" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-172"><a href="#cb91-172" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb91-173"><a href="#cb91-173" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mff[rep_lag_mff[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_pos),</span>
<span id="cb91-174"><a href="#cb91-174" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb91-175"><a href="#cb91-175" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">3</span>, <span class="dv">0</span>].set_title(<span class="st">'MFF First Repetition Lag-Contiguity'</span>)</span>
<span id="cb91-176"><a href="#cb91-176" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">3</span>, <span class="dv">1</span>].set_title(<span class="st">'MFF Second Repetition Lag-Contiguity'</span>)</span>
<span id="cb91-177"><a href="#cb91-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-178"><a href="#cb91-178" aria-hidden="true" tabindex="-1"></a>    <span class="co"># render result</span></span>
<span id="cb91-179"><a href="#cb91-179" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>encoding_drift_rate 0.832809463</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [02:42&lt;00:00, 16.25s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-25-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>recall_drift_rate 0.961140398</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [02:30&lt;00:00, 15.09s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-25-output-8.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/4 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>shared_support 0.0011990853</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [01:00&lt;00:00, 15.11s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-25-output-12.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/9 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>item_support 0.131621512</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9/9 [02:15&lt;00:00, 15.10s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-25-output-16.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>learning_rate 0.245449928</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [02:34&lt;00:00, 15.40s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-25-output-20.png" class="img-fluid"></p>
</div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>choice_sensitivity 1.0</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [02:36&lt;00:00, 15.65s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-25-output-24.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace-reinstatement-cmr-7" class="level3">
<h3 class="anchored" data-anchor-id="trace-reinstatement-cmr-7">Trace-Reinstatement CMR</h3>
<div class="cell" data-execution_count="50">
<div class="sourceCode" id="cb110"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> init_trcmr</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'Trace-Reinstatement CMR'</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">=</span> trcmr_fitted_parameters</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>list_type <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> list_length<span class="op">-</span><span class="dv">1</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>crp_max_lag <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>rep_crp_max_lag <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>score_ranges <span class="op">=</span> {</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'feature_drift_rate'</span>: np.arange(<span class="fl">.001</span>, <span class="dv">1</span>, <span class="fl">.1</span>),</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> varied_parameter <span class="kw">in</span> score_ranges.keys():</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(varied_parameter, parameters[varied_parameter])</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    rep_crps <span class="op">=</span> []</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    rep_lag_mcfs <span class="op">=</span> []</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    rep_lag_mfcs <span class="op">=</span> []</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>    rep_lag_mffs <span class="op">=</span> []</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through parameter values</span></span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parameter_value <span class="kw">in</span> tqdm(score_ranges[varied_parameter]):</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate data with this parameter value modified</span></span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>        model_parameters <span class="op">=</span> parameters.copy()</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>        model_parameters[varied_parameter] <span class="op">=</span> parameter_value</span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>        model_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>            model_class, model_parameters, presentations[list_types<span class="op">==</span>list_type], experiment_count)</span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>        model_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>list_type], experiment_count, <span class="dv">1</span>)</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># rep crp</span></span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>        rep_crp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>            model_trials, model_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>        rep_crp[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>        rep_crp <span class="op">=</span> pd.DataFrame({</span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Lag"</span>: (np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag).tolist() <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Recall Rate"</span>: rep_crp[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length <span class="op">+</span> rep_crp_max_lag].tolist()</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>                    <span class="op">+</span> rep_crp[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist(),</span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>                varied_parameter: parameter_value,</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Position"</span>: [<span class="st">'First'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> [<span class="st">'Second'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>        rep_crps.append(rep_crp)</span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># lag-connectivity requires more involved computations...</span></span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mfc <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mcf <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>        total_rep_lag_mff <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># loop through presentations</span></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate list study</span></span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a>            item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a>            model.experience(model.items[presentation])</span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># extract item connections</span></span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a>            latent_mfc, mcf_connections, mff_connections <span class="op">=</span> latent_mfc_mcf_mff(model, model.recall_items)</span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a>            <span class="co"># track repetition connectivity</span></span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mfc <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mcf <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true" tabindex="-1"></a>            total_rep_lag_mff <span class="op">+=</span> alternative_connectivity_by_lag(mff_connections, presentation)</span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reduce sum to mean</span></span>
<span id="cb110-71"><a href="#cb110-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># repetition connectivity</span></span>
<span id="cb110-72"><a href="#cb110-72" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc <span class="op">=</span> total_rep_lag_mfc <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb110-73"><a href="#cb110-73" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf <span class="op">=</span> total_rep_lag_mcf <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb110-74"><a href="#cb110-74" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff <span class="op">=</span> total_rep_lag_mff <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb110-75"><a href="#cb110-75" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb110-76"><a href="#cb110-76" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb110-77"><a href="#cb110-77" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb110-78"><a href="#cb110-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-79"><a href="#cb110-79" aria-hidden="true" tabindex="-1"></a>        <span class="co"># aggregate for dataframe</span></span>
<span id="cb110-80"><a href="#cb110-80" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfc <span class="op">=</span> pd.DataFrame(</span>
<span id="cb110-81"><a href="#cb110-81" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: (np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag).tolist() <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb110-82"><a href="#cb110-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: rep_lag_mfc[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist()</span>
<span id="cb110-83"><a href="#cb110-83" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> rep_lag_mfc[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist(),</span>
<span id="cb110-84"><a href="#cb110-84" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value,</span>
<span id="cb110-85"><a href="#cb110-85" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Position"</span>: [<span class="st">'First'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> [<span class="st">'Second'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)})</span>
<span id="cb110-86"><a href="#cb110-86" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcf <span class="op">=</span> pd.DataFrame(</span>
<span id="cb110-87"><a href="#cb110-87" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: (np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag).tolist() <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb110-88"><a href="#cb110-88" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: rep_lag_mcf[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist()</span>
<span id="cb110-89"><a href="#cb110-89" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> rep_lag_mcf[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist(),</span>
<span id="cb110-90"><a href="#cb110-90" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value,</span>
<span id="cb110-91"><a href="#cb110-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Position"</span>: [<span class="st">'First'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> [<span class="st">'Second'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)})</span>
<span id="cb110-92"><a href="#cb110-92" aria-hidden="true" tabindex="-1"></a>        rep_lag_mff <span class="op">=</span> pd.DataFrame(</span>
<span id="cb110-93"><a href="#cb110-93" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'Lag'</span>: (np.arange(rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>, dtype<span class="op">=</span><span class="bu">int</span>)<span class="op">-</span>rep_crp_max_lag).tolist() <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb110-94"><a href="#cb110-94" aria-hidden="true" tabindex="-1"></a>            <span class="st">'Recall Rate'</span>: rep_lag_mff[<span class="dv">0</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist()</span>
<span id="cb110-95"><a href="#cb110-95" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> rep_lag_mff[<span class="dv">1</span>, list_length<span class="op">-</span>rep_crp_max_lag<span class="op">-</span><span class="dv">1</span>:list_length<span class="op">+</span>rep_crp_max_lag].tolist(),</span>
<span id="cb110-96"><a href="#cb110-96" aria-hidden="true" tabindex="-1"></a>            varied_parameter: parameter_value,</span>
<span id="cb110-97"><a href="#cb110-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Position"</span>: [<span class="st">'First'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>) <span class="op">+</span> [<span class="st">'Second'</span>] <span class="op">*</span> (rep_crp_max_lag<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)})</span>
<span id="cb110-98"><a href="#cb110-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-99"><a href="#cb110-99" aria-hidden="true" tabindex="-1"></a>        rep_lag_mcfs.append(rep_lag_mcf)</span>
<span id="cb110-100"><a href="#cb110-100" aria-hidden="true" tabindex="-1"></a>        rep_lag_mffs.append(rep_lag_mff)</span>
<span id="cb110-101"><a href="#cb110-101" aria-hidden="true" tabindex="-1"></a>        rep_lag_mfcs.append(rep_lag_mfc)</span>
<span id="cb110-102"><a href="#cb110-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-103"><a href="#cb110-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># aggregate fitting results</span></span>
<span id="cb110-104"><a href="#cb110-104" aria-hidden="true" tabindex="-1"></a>    rep_crp <span class="op">=</span> pd.concat(rep_crps).reset_index()</span>
<span id="cb110-105"><a href="#cb110-105" aria-hidden="true" tabindex="-1"></a>    rep_lag_mcf <span class="op">=</span> pd.concat(rep_lag_mcfs).reset_index()</span>
<span id="cb110-106"><a href="#cb110-106" aria-hidden="true" tabindex="-1"></a>    rep_lag_mff <span class="op">=</span> pd.concat(rep_lag_mffs).reset_index()</span>
<span id="cb110-107"><a href="#cb110-107" aria-hidden="true" tabindex="-1"></a>    rep_lag_mfc <span class="op">=</span> pd.concat(rep_lag_mfcs).reset_index()</span>
<span id="cb110-108"><a href="#cb110-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-109"><a href="#cb110-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb110-110"><a href="#cb110-110" aria-hidden="true" tabindex="-1"></a>    sns.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'darkgrid'</span>)</span>
<span id="cb110-111"><a href="#cb110-111" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">4</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">25</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb110-112"><a href="#cb110-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-113"><a href="#cb110-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_crp</span></span>
<span id="cb110-114"><a href="#cb110-114" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_crp[rep_crp[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, </span>
<span id="cb110-115"><a href="#cb110-115" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-116"><a href="#cb110-116" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_crp[rep_crp[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, </span>
<span id="cb110-117"><a href="#cb110-117" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-118"><a href="#cb110-118" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_crp[rep_crp[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_neg), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, </span>
<span id="cb110-119"><a href="#cb110-119" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-120"><a href="#cb110-120" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_crp[rep_crp[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_pos), x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, </span>
<span id="cb110-121"><a href="#cb110-121" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-122"><a href="#cb110-122" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'First Repetition Lag-Contiguity'</span>)</span>
<span id="cb110-123"><a href="#cb110-123" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Second Repetition Lag-Contiguity'</span>)</span>
<span id="cb110-124"><a href="#cb110-124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-125"><a href="#cb110-125" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mcf</span></span>
<span id="cb110-126"><a href="#cb110-126" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-127"><a href="#cb110-127" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mcf[rep_lag_mcf[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_neg), </span>
<span id="cb110-128"><a href="#cb110-128" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-129"><a href="#cb110-129" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-130"><a href="#cb110-130" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mcf[rep_lag_mcf[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_pos),</span>
<span id="cb110-131"><a href="#cb110-131" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-132"><a href="#cb110-132" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-133"><a href="#cb110-133" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mcf[rep_lag_mcf[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_neg),</span>
<span id="cb110-134"><a href="#cb110-134" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-135"><a href="#cb110-135" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-136"><a href="#cb110-136" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mcf[rep_lag_mcf[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_pos),</span>
<span id="cb110-137"><a href="#cb110-137" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-138"><a href="#cb110-138" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'MCF First Repetition Lag-Contiguity'</span>)</span>
<span id="cb110-139"><a href="#cb110-139" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'MCF Second Repetition Lag-Contiguity'</span>)</span>
<span id="cb110-140"><a href="#cb110-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-141"><a href="#cb110-141" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mfc</span></span>
<span id="cb110-142"><a href="#cb110-142" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-143"><a href="#cb110-143" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mfc[rep_lag_mfc[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_neg),</span>
<span id="cb110-144"><a href="#cb110-144" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-145"><a href="#cb110-145" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-146"><a href="#cb110-146" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mfc[rep_lag_mfc[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_pos),</span>
<span id="cb110-147"><a href="#cb110-147" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-148"><a href="#cb110-148" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-149"><a href="#cb110-149" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mfc[rep_lag_mfc[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_neg),</span>
<span id="cb110-150"><a href="#cb110-150" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-151"><a href="#cb110-151" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-152"><a href="#cb110-152" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">2</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mfc[rep_lag_mfc[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_pos),</span>
<span id="cb110-153"><a href="#cb110-153" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-154"><a href="#cb110-154" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'MFC First Repetition Lag-Contiguity'</span>)</span>
<span id="cb110-155"><a href="#cb110-155" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'MFC Second Repetition Lag-Contiguity'</span>)</span>
<span id="cb110-156"><a href="#cb110-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-157"><a href="#cb110-157" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep_lag_mff</span></span>
<span id="cb110-158"><a href="#cb110-158" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-159"><a href="#cb110-159" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mff[rep_lag_mff[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_neg),</span>
<span id="cb110-160"><a href="#cb110-160" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-161"><a href="#cb110-161" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-162"><a href="#cb110-162" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">0</span>], data<span class="op">=</span>rep_lag_mff[rep_lag_mff[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'First'</span>].query(filt_pos),</span>
<span id="cb110-163"><a href="#cb110-163" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-164"><a href="#cb110-164" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-165"><a href="#cb110-165" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mff[rep_lag_mff[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_neg),</span>
<span id="cb110-166"><a href="#cb110-166" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-167"><a href="#cb110-167" aria-hidden="true" tabindex="-1"></a>    sns.lineplot(</span>
<span id="cb110-168"><a href="#cb110-168" aria-hidden="true" tabindex="-1"></a>        ax<span class="op">=</span>axes[<span class="dv">3</span>, <span class="dv">1</span>], data<span class="op">=</span>rep_lag_mff[rep_lag_mff[<span class="st">'Position'</span>]<span class="op">==</span><span class="st">'Second'</span>].query(filt_pos),</span>
<span id="cb110-169"><a href="#cb110-169" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'Lag'</span>, y<span class="op">=</span><span class="st">"Recall Rate"</span>, hue<span class="op">=</span>varied_parameter, ci<span class="op">=</span><span class="va">None</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb110-170"><a href="#cb110-170" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">3</span>, <span class="dv">0</span>].set_title(<span class="st">'MFF First Repetition Lag-Contiguity'</span>)</span>
<span id="cb110-171"><a href="#cb110-171" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">3</span>, <span class="dv">1</span>].set_title(<span class="st">'MFF Second Repetition Lag-Contiguity'</span>)</span>
<span id="cb110-172"><a href="#cb110-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-173"><a href="#cb110-173" aria-hidden="true" tabindex="-1"></a>    <span class="co"># render result</span></span>
<span id="cb110-174"><a href="#cb110-174" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>  0%|          | 0/10 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>feature_drift_rate 1.0</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [03:52&lt;00:00, 23.28s/it]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Model_Characterization_files\figure-html/cell-26-output-4.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>
</section>
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</main> <!-- /main -->
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->


</body></html>