<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.2.281">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>compmemlearn – alternative_contiguity_tracing</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../../">
  <script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../../site_libs/quarto-search/quarto-search.js"></script>
  <script src="../../site_libs/quarto-html/quarto.js"></script>
  <script src="../../site_libs/quarto-html/popper.min.js"></script>
  <script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <link rel="stylesheet" href="../../styles.css">
</head>
<body class="docked">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-light ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">compmemlearn</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">(Untitled)</h1>
      <button type="button" class="quarto-btn-toggle btn">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
  <div class="sidebar-menu-container"> 
  <ul class="list-unstyled mt-1">
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#datasets-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Datasets</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="datasets-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../../library/datasets/Murdock1962.html" class="">Murdock1962 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/MurdockOkada1970.html" class="">MurdockOkada1970 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/Lohnas2014.html" class="">Lohnas2014 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/HowaKaha05.html" class="">HowaKaha05 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/Data_Simulation.html" class="">Data Simulation</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/ClairExpt6.html" class="">ClaireExpt6 Dataset</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/datasets/PEERS.html" class="">PEERS Dataset</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#models-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Models</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="models-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../../library/models/Classic_CMR.html" class="">Classic CMR</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/models/Instance_CMR.html" class="">Context Maintenance and Retrieval within an Instance-Based Architecture</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/models/Noisy_CMR.html" class="">Noisy CMR</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/models/Trace_Reinstatement_CMR.html" class="">Trace-Based Reinstatement</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#dataanalysis-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Data Analysis</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="dataanalysis-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../../library/analyses/Serial_Position_Effect.html" class="">Serial Position Effect</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Probability_of_First_Recall.html" class="">Probability of First Recall</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Lag_Contiguity_Effect.html" class="">The Lag-Contiguity Effect</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Conditional_Stop_Probability.html" class="">Conditional Stop Probability</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Alternative_Contiguity.html" class="">Alternative Contiguity Analysis</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Recall_Probability_by_Spacing.html" class="">Recall Probability by Spacing</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Serial_Position_Effect_in_Repetition_Datasets.html" class="">Measuring the Serial Position Effect in Repetition Data</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/analyses/Probability_of_First_Recall_in_Repetition_Data.html" class="">Probability of First Recall in Repetition Data</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
      <ul class="list-unstyled sidebar-section depth1">
    <li class="">
        <div class="me-auto">
            <a class="sidebar-section-item d-inline-flex text-start w-100 " data-bs-toggle="collapse" data-bs-target="#modelanalysis-collapse" aria-expanded="true">
              <div class="me-auto sidebar-section-item">Model Analysis</div>
            <div><i class="bi bi-chevron-right ms-2"></i></div>
            </a>
        </div>
      <div class="collapse  show" id="modelanalysis-collapse">
        <ul class="list-unstyled sidebar-item-contents">
          <li class="sidebar-item">
  <a href="../../library/model_analysis/Data_Likelihood_Under_Model.html" class="">Data Likelihood Under Model</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/model_analysis/Contiguity_Tracing.html" class="">Contiguity Tracing</a>
</li>
          <li class="sidebar-item">
  <a href="../../library/model_analysis/Model_Characterization.html" class="">Model Characterization</a>
</li>
        </ul>
      </div>
    </li>
  </ul>
  </ul>
  </div>
</nav>
<!-- toc -->
    <nav id="TOC" role="doc-toc" class="sidebar sidebar-toc">
<h2 id="toc-title">On this page</h2>
<ul>
<li><a href="#alternative-contiguity-tracing" class="nav-link active" data-scroll-target="#alternative-contiguity-tracing">Alternative Contiguity Tracing</a></li>
<li><a href="#initial-fitting" class="nav-link" data-scroll-target="#initial-fitting">Initial Fitting</a>
<ul class="collapse">
<li><a href="#prototypecmr" class="nav-link" data-scroll-target="#prototypecmr">PrototypeCMR</a></li>
<li><a href="#instancecmr" class="nav-link" data-scroll-target="#instancecmr">InstanceCMR</a></li>
<li><a href="#trace_reinstatement_cmr" class="nav-link" data-scroll-target="#trace_reinstatement_cmr">Trace_Reinstatement_CMR</a></li>
</ul></li>
<li><a href="#lag-connectivity" class="nav-link" data-scroll-target="#lag-connectivity">Lag-Connectivity</a>
<ul class="collapse">
<li><a href="#functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
<li><a href="#instancecmr-1" class="nav-link" data-scroll-target="#instancecmr-1">InstanceCMR</a></li>
<li><a href="#classic-cmr" class="nav-link" data-scroll-target="#classic-cmr">Classic CMR</a></li>
<li><a href="#tr-cmr" class="nav-link" data-scroll-target="#tr-cmr">TR-CMR</a></li>
</ul></li>
<li><a href="#alternative-lag-connectivity" class="nav-link" data-scroll-target="#alternative-lag-connectivity">Alternative Lag-Connectivity</a>
<ul class="collapse">
<li><a href="#instancecmr-2" class="nav-link" data-scroll-target="#instancecmr-2">InstanceCMR</a></li>
<li><a href="#classic-cmr-1" class="nav-link" data-scroll-target="#classic-cmr-1">Classic CMR</a></li>
<li><a href="#tr-cmr-1" class="nav-link" data-scroll-target="#tr-cmr-1">TR-CMR</a></li>
</ul></li>
</ul>
</nav>
<!-- main -->
<main class="content">

<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default_exp model_analysis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="alternative-contiguity-tracing" class="level2">
<h2 class="anchored" data-anchor-id="alternative-contiguity-tracing">Alternative Contiguity Tracing</h2>
<p>Fit CMR and InstanceCMR models to condition 4 of lohnas dataset and plot key summary statistics, including repetition effects. (We already do this in another pair of notebooks!). Visualize corresponding memory representations in the models, focusing on lag-connectivity under parameter shifting.</p>
<p>Lay out understanding of how item repetition codetermines model representations and behavior in the canonical <em>and</em> presented trials and why that means no accounting for alternative contiguity (and maybe hopefully also poor accounting for spacing effect).</p>
<p>To “prove” understanding, implement transformation of model weights that results in simulation of the alternative contiguity effect.</p>
<p>Relate these results to CMR’s limitations and potential mechanisms for the transformation that might be implemented within a model.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.analyses <span class="im">import</span> flex_mixed_spc, flex_mixed_crp, flex_mixed_pfr, fast_csp, alternative_contiguity, fast_rpl</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> prepare_lohnas2014_data, simulate_array_from_presentations</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.fitting <span class="im">import</span> lohnas_objective_function</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.models <span class="im">import</span> Classic_CMR, Instance_CMR, Trace_Reinstatement_CMR</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.model_analysis <span class="im">import</span> matrix_heatmap, icmr_memory_heatmap, latent_mfc_mcf, connectivity_by_lag, mfc_heatmap</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> matlib</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> int32</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.typed <span class="im">import</span> Dict</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.core <span class="im">import</span> types</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [<span class="st">'Control'</span>, <span class="st">'Massed'</span>, <span class="st">'Spaced'</span>, <span class="st">'Mixed'</span>]</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_lohnas2014_data(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../../data/repFR.mat'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="initial-fitting" class="level2">
<h2 class="anchored" data-anchor-id="initial-fitting">Initial Fitting</h2>
<section id="prototypecmr" class="level3">
<h3 class="anchored" data-anchor-id="prototypecmr">PrototypeCMR</h3>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>cmr_free_parameters <span class="op">=</span> (</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>cmr_bounds <span class="op">=</span> [</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_cmr(item_count, presentation_count, parameters):</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Classic_CMR(item_count, presentation_count, parameters)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> condition</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    cmr_free_parameters)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>cmr_result <span class="op">=</span> differential_evolution(cost_function, cmr_bounds, disp<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cmr_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<pre><code>     fun: 17271.488868401062
     jac: array([ 4.36193657e-01, -2.87764124e-01,  5.14046403e-01, -3.44880391e-01,
        2.74860213e+01,  5.78802429e-01,  4.72937248e-03,  0.00000000e+00,
        2.95767677e-01, -6.92671165e-01, -5.31144909e-02, -7.47240843e-01])
 message: 'Optimization terminated successfully.'
    nfev: 8861
     nit: 34
 success: True
       x: array([8.53866588e-01, 9.01233935e-02, 9.64653634e-01, 3.64986965e-02,
       2.22044605e-16, 4.60969130e-01, 3.38252088e+00, 3.05443417e+01,
       2.13921114e-02, 1.06822773e-01, 1.17216059e+00, 9.84763294e-01])</code></pre>
</div>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>cmr_fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cmr_result.x)):</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    cmr_fitted_parameters[cmr_free_parameters[j]] <span class="op">=</span> cmr_result.x[j]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>cmr_fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>cmr_fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>cmr_fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>cmr_fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>cmr_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    init_cmr, cmr_fitted_parameters, presentations[list_types<span class="op">==</span>condition], experiment_count)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>cmr_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>condition], experiment_count, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'PrototypeCMR'</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># spc</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>data_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>cmr_spc <span class="op">=</span> flex_mixed_spc(cmr_trials, cmr_presentations)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_spc)), data_spc, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(cmr_spc)), cmr_spc, label<span class="op">=</span>model_name)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>data_pfr <span class="op">=</span> flex_mixed_pfr(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>cmr_pfr <span class="op">=</span> flex_mixed_pfr(cmr_trials, cmr_presentations)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_pfr)), data_pfr, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(cmr_pfr)), cmr_pfr, label<span class="op">=</span>model_name)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># crp</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>lag_range <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>data_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>data_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>cmr_crp <span class="op">=</span> flex_mixed_crp(cmr_trials, cmr_presentations)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>cmr_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_crp)), data_crp, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(cmr_crp)), cmr_crp, label<span class="op">=</span>model_name)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>))</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>) <span class="op">-</span> lag_range)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'CRP'</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co"># rpl</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> data_rpl[<span class="dv">0</span>]</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> data_rpl[<span class="dv">1</span>]</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (data_rpl[<span class="dv">2</span>] <span class="op">+</span> data_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (data_rpl[<span class="dv">4</span>] <span class="op">+</span> data_rpl[<span class="dv">5</span>] <span class="op">+</span> data_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (data_rpl[<span class="dv">7</span>] <span class="op">+</span> data_rpl[<span class="dv">8</span>] <span class="op">+</span> data_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>cmr_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    cmr_trials, cmr_presentations, max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> cmr_rpl[<span class="dv">0</span>]</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> cmr_rpl[<span class="dv">1</span>]</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (cmr_rpl[<span class="dv">2</span>] <span class="op">+</span> cmr_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (cmr_rpl[<span class="dv">4</span>] <span class="op">+</span> cmr_rpl[<span class="dv">5</span>] <span class="op">+</span> cmr_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (cmr_rpl[<span class="dv">7</span>] <span class="op">+</span> cmr_rpl[<span class="dv">8</span>] <span class="op">+</span> cmr_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>cmr_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_rpl)), data_rpl, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(cmr_rpl)), cmr_rpl, label<span class="op">=</span>model_name)</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Recall Probability by Lag'</span>)</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'Repetition Contiguity -- Data'</span>)</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>cmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    cmr_trials, cmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>cmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), cmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), cmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'Repetition Contiguity -- '</span> <span class="op">+</span> model_name)</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'PrototypeCMR'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>cmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    cmr_trials, cmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>cmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>axes.plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>]<span class="op">-</span>data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>axes.plot(np.arange(<span class="dv">7</span>), cmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>]<span class="op">-</span>cmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span>model_name)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>axes.set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>axes.set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>axes.set_title(<span class="st">'Positional Contiguity Difference'</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>axes.legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend at 0x21749473ee0&gt;</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="instancecmr" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr">InstanceCMR</h3>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>icmr_free_parameters <span class="op">=</span> (</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#    'choice_sensitivity',</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'context_sensitivity'</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    'feature_sensitivity'</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>icmr_bounds <span class="op">=</span> [</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10),</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10)</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_icmr(item_count, presentation_count, parameters):</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Instance_CMR(item_count, presentation_count, parameters)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> condition</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    init_icmr,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'choice_sensitivity'</span>: <span class="dv">1</span>, <span class="st">'feature_sensitivity'</span>: <span class="dv">1</span>}, </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    icmr_free_parameters)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>icmr_result <span class="op">=</span> differential_evolution(cost_function, icmr_bounds, disp<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 46459.2
differential_evolution step 2: f(x)= 28269
differential_evolution step 3: f(x)= 26437.4
differential_evolution step 4: f(x)= 24436.2
differential_evolution step 5: f(x)= 24436.2
differential_evolution step 6: f(x)= 20687.5
differential_evolution step 7: f(x)= 20080.2
differential_evolution step 8: f(x)= 20065.4
differential_evolution step 9: f(x)= 19693.7
differential_evolution step 10: f(x)= 19693.7
differential_evolution step 11: f(x)= 19620.8
differential_evolution step 12: f(x)= 19620.8
differential_evolution step 13: f(x)= 19620.8
differential_evolution step 14: f(x)= 19620.8
differential_evolution step 15: f(x)= 19578.4
differential_evolution step 16: f(x)= 18942.2
differential_evolution step 17: f(x)= 18942.2
differential_evolution step 18: f(x)= 18942.2
differential_evolution step 19: f(x)= 18207
differential_evolution step 20: f(x)= 18207
differential_evolution step 21: f(x)= 18207
differential_evolution step 22: f(x)= 18207
differential_evolution step 23: f(x)= 18207
differential_evolution step 24: f(x)= 18207
differential_evolution step 25: f(x)= 18066.3
differential_evolution step 26: f(x)= 18066.3
differential_evolution step 27: f(x)= 18066.3
differential_evolution step 28: f(x)= 17823.5
differential_evolution step 29: f(x)= 17823.5
differential_evolution step 30: f(x)= 17823.5
differential_evolution step 31: f(x)= 17675.6
differential_evolution step 32: f(x)= 17675.6
differential_evolution step 33: f(x)= 17675.6
differential_evolution step 34: f(x)= 17675.6
differential_evolution step 35: f(x)= 17675.6
differential_evolution step 36: f(x)= 17675.6
differential_evolution step 37: f(x)= 17675.6
differential_evolution step 38: f(x)= 17517.9
differential_evolution step 39: f(x)= 17517.9
differential_evolution step 40: f(x)= 17517.9
differential_evolution step 41: f(x)= 17517.9
differential_evolution step 42: f(x)= 17517.9
differential_evolution step 43: f(x)= 17471.5
differential_evolution step 44: f(x)= 17471.5
differential_evolution step 45: f(x)= 17471.5
differential_evolution step 46: f(x)= 17454.3
differential_evolution step 47: f(x)= 17454.3
differential_evolution step 48: f(x)= 17416
differential_evolution step 49: f(x)= 17369.9
differential_evolution step 50: f(x)= 17369.9
differential_evolution step 51: f(x)= 17369.9
differential_evolution step 52: f(x)= 17361.7
differential_evolution step 53: f(x)= 17361.7
differential_evolution step 54: f(x)= 17330.1
differential_evolution step 55: f(x)= 17330.1
differential_evolution step 56: f(x)= 17280.6
differential_evolution step 57: f(x)= 17280.6
differential_evolution step 58: f(x)= 17280.6
differential_evolution step 59: f(x)= 17280.6
differential_evolution step 60: f(x)= 17280.6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>icmr_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<pre><code>     fun: 17221.459000970448
     jac: array([-34.70595385,  15.63421393,  22.91963017, 306.74091249,
       -33.19582901,   9.75414878, -11.35013015,   0.        ,
       -16.64921001,  71.7092917 , -10.55632317, -15.95180939])
 message: 'Optimization terminated successfully.'
    nfev: 12969
     nit: 60
 success: True
       x: array([8.32901225e-01, 2.08116235e-01, 9.60915690e-01, 3.05257500e-04,
       3.18582949e-02, 1.02883666e-01, 2.14975563e+00, 6.66001243e+01,
       2.05812661e-02, 1.09385203e-01, 1.35697460e+00, 9.42731805e-01])</code></pre>
</div>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>icmr_fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(icmr_result.x)):</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    icmr_fitted_parameters[icmr_free_parameters[j]] <span class="op">=</span> icmr_result.x[j]</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>icmr_fitted_parameters[<span class="st">'choice_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>icmr_fitted_parameters[<span class="st">'feature_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>icmr_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    init_icmr, icmr_fitted_parameters, presentations[list_types<span class="op">==</span>condition], experiment_count)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>icmr_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>condition], experiment_count, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'InstanceCMR'</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># spc</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>data_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>icmr_spc <span class="op">=</span> flex_mixed_spc(icmr_trials, icmr_presentations)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_spc)), data_spc, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(icmr_spc)), icmr_spc, label<span class="op">=</span>model_name)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>data_pfr <span class="op">=</span> flex_mixed_pfr(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>icmr_pfr <span class="op">=</span> flex_mixed_pfr(icmr_trials, icmr_presentations)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_pfr)), data_pfr, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(icmr_pfr)), icmr_pfr, label<span class="op">=</span>model_name)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># crp</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>lag_range <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>data_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>data_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>icmr_crp <span class="op">=</span> flex_mixed_crp(icmr_trials, icmr_presentations)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>icmr_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_crp)), data_crp, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(icmr_crp)), icmr_crp, label<span class="op">=</span>model_name)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>))</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>) <span class="op">-</span> lag_range)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'CRP'</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co"># rpl</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> data_rpl[<span class="dv">0</span>]</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> data_rpl[<span class="dv">1</span>]</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (data_rpl[<span class="dv">2</span>] <span class="op">+</span> data_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (data_rpl[<span class="dv">4</span>] <span class="op">+</span> data_rpl[<span class="dv">5</span>] <span class="op">+</span> data_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (data_rpl[<span class="dv">7</span>] <span class="op">+</span> data_rpl[<span class="dv">8</span>] <span class="op">+</span> data_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>icmr_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    icmr_trials, icmr_presentations, max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> icmr_rpl[<span class="dv">0</span>]</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> icmr_rpl[<span class="dv">1</span>]</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (icmr_rpl[<span class="dv">2</span>] <span class="op">+</span> icmr_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (icmr_rpl[<span class="dv">4</span>] <span class="op">+</span> icmr_rpl[<span class="dv">5</span>] <span class="op">+</span> icmr_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (icmr_rpl[<span class="dv">7</span>] <span class="op">+</span> icmr_rpl[<span class="dv">8</span>] <span class="op">+</span> icmr_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>icmr_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_rpl)), data_rpl, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(icmr_rpl)), icmr_rpl, label<span class="op">=</span>model_name)</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Recall Probability by Lag'</span>)</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'Repetition Contiguity -- Data'</span>)</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>icmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>    icmr_trials, icmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>icmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), icmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), icmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'Repetition Contiguity -- '</span> <span class="op">+</span> model_name)</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="trace_reinstatement_cmr" class="level3">
<h3 class="anchored" data-anchor-id="trace_reinstatement_cmr">Trace_Reinstatement_CMR</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remember to run nbdev_build_lib first! </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> compmemlearn</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> importlib</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>importlib.<span class="bu">reload</span>(compmemlearn.models)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.models <span class="im">import</span> Trace_Reinstatement_CMR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>trcmr_free_parameters <span class="op">=</span> (</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#    'choice_sensitivity',</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'context_sensitivity'</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#    'feature_sensitivity'</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'delay_drift_rate'</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'context_reinstatement'</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>trcmr_bounds <span class="op">=</span> [</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10),</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co">#    (lb, 10)</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_trcmr(item_count, presentation_count, parameters):</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Trace_Reinstatement_CMR(item_count, presentation_count, parameters)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> condition</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    init_trcmr,</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'choice_sensitivity'</span>: <span class="dv">1</span>, <span class="st">'feature_sensitivity'</span>: <span class="dv">1</span>}, </span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>    trcmr_free_parameters)</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="co"># will throw error if i haven't already fitted</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(init_trcmr(<span class="dv">20</span>, <span class="dv">20</span>, trcmr_fitted_parameters).items[<span class="dv">0</span>]) <span class="co"># to maybe avoid weird fitting failure -- we'll see if it works</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[0.         0.02499219 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.99968765
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>trcmr_result <span class="op">=</span> differential_evolution(cost_function, trcmr_bounds, disp<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>trcmr_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 38770.8
differential_evolution step 2: f(x)= 31970
differential_evolution step 3: f(x)= 28471.3
differential_evolution step 4: f(x)= 20224.9
differential_evolution step 5: f(x)= 20053.9
differential_evolution step 6: f(x)= 19901.2
differential_evolution step 7: f(x)= 19746.1
differential_evolution step 8: f(x)= 19671.3
differential_evolution step 9: f(x)= 19671.3
differential_evolution step 10: f(x)= 19671.3
differential_evolution step 11: f(x)= 19671.3
differential_evolution step 12: f(x)= 19671.3
differential_evolution step 13: f(x)= 19654.2
differential_evolution step 14: f(x)= 19625.7
differential_evolution step 15: f(x)= 19574.9
differential_evolution step 16: f(x)= 19574.9
differential_evolution step 17: f(x)= 19574.9
differential_evolution step 18: f(x)= 19574.9
differential_evolution step 19: f(x)= 19574.9
differential_evolution step 20: f(x)= 19373.8
differential_evolution step 21: f(x)= 19373.8
differential_evolution step 22: f(x)= 19373.8
differential_evolution step 23: f(x)= 19373.8
differential_evolution step 24: f(x)= 19373.8
differential_evolution step 25: f(x)= 19373.8
differential_evolution step 26: f(x)= 19373.8
differential_evolution step 27: f(x)= 19373.8
differential_evolution step 28: f(x)= 19373.8
differential_evolution step 29: f(x)= 19373.8
differential_evolution step 30: f(x)= 18841.3</code></pre>
</div>
<div class="cell-output-display">
<pre><code>     fun: 17059.651290065947
     jac: array([-3.95208188e+01, -4.22016456e+01, -1.21831908e+02,  5.78427716e+01,
       -1.35005394e+00,  1.87246768e+00, -1.51703717e-01,  0.00000000e+00,
       -8.20444256e+01,  1.97843110e+02,  1.71508874e+01, -6.52773448e+02,
       -6.14309105e+00])
 message: 'Optimization terminated successfully.'
    nfev: 12317
     nit: 30
 success: True
       x: array([8.32287621e-01, 6.19383237e-03, 9.14802390e-01, 6.03601368e-03,
       3.49635680e-01, 7.39360206e-01, 2.72092798e+00, 4.64522241e+01,
       1.91378214e-02, 1.14005522e-01, 2.29533351e+00, 9.99988823e-01,
       5.73518735e+00])</code></pre>
</div>
</div>
<section id="with-maxed-out-context-reinstatement" class="level4">
<h4 class="anchored" data-anchor-id="with-maxed-out-context-reinstatement">With Maxed Out Context Reinstatement</h4>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trcmr_result.x)):</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    trcmr_fitted_parameters[trcmr_free_parameters[j]] <span class="op">=</span> trcmr_result.x[j]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters[<span class="st">'choice_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters[<span class="st">'feature_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters[<span class="st">'context_reinstatement'</span>] <span class="op">=</span> <span class="dv">40</span> <span class="co"># hack to drive alternative contiguity effect</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># will throw error if i haven't already fitted</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(init_trcmr(<span class="dv">20</span>, <span class="dv">20</span>, trcmr_fitted_parameters).items[<span class="dv">0</span>]) <span class="co"># to maybe avoid weird fitting failure -- we'll see if it works</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>trcmr_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    init_trcmr, trcmr_fitted_parameters, presentations[list_types<span class="op">==</span>condition], experiment_count)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>trcmr_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>condition], experiment_count, <span class="dv">1</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'Trace Reinstatement CMR'</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># spc</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>data_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>trcmr_spc <span class="op">=</span> flex_mixed_spc(trcmr_trials, trcmr_presentations)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_spc)), data_spc, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(trcmr_spc)), trcmr_spc, label<span class="op">=</span>model_name)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>data_pfr <span class="op">=</span> flex_mixed_pfr(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>trcmr_pfr <span class="op">=</span> flex_mixed_pfr(trcmr_trials, trcmr_presentations)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_pfr)), data_pfr, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(trcmr_pfr)), trcmr_pfr, label<span class="op">=</span>model_name)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="co"># crp</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>lag_range <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>data_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>data_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>trcmr_crp <span class="op">=</span> flex_mixed_crp(trcmr_trials, trcmr_presentations)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>trcmr_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_crp)), data_crp, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(trcmr_crp)), trcmr_crp, label<span class="op">=</span>model_name)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>))</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>) <span class="op">-</span> lag_range)</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'CRP'</span>)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="co"># rpl</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> data_rpl[<span class="dv">0</span>]</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> data_rpl[<span class="dv">1</span>]</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (data_rpl[<span class="dv">2</span>] <span class="op">+</span> data_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (data_rpl[<span class="dv">4</span>] <span class="op">+</span> data_rpl[<span class="dv">5</span>] <span class="op">+</span> data_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (data_rpl[<span class="dv">7</span>] <span class="op">+</span> data_rpl[<span class="dv">8</span>] <span class="op">+</span> data_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>trcmr_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>    trcmr_trials, trcmr_presentations, max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> trcmr_rpl[<span class="dv">0</span>]</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> trcmr_rpl[<span class="dv">1</span>]</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">2</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">4</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">5</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">7</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">8</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>trcmr_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_rpl)), data_rpl, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(trcmr_rpl)), trcmr_rpl, label<span class="op">=</span>model_name)</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Recall Probability by Lag'</span>)</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'Repetition Contiguity -- Data'</span>)</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>trcmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>    trcmr_trials, trcmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>trcmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), trcmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), trcmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'Repetition Contiguity -- '</span> <span class="op">+</span> model_name)</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[0.         0.02499219 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.99968765
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="with-parametrized-amount" class="level4">
<h4 class="anchored" data-anchor-id="with-parametrized-amount">With Parametrized Amount</h4>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trcmr_result.x)):</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    trcmr_fitted_parameters[trcmr_free_parameters[j]] <span class="op">=</span> trcmr_result.x[j]</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters[<span class="st">'choice_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>trcmr_fitted_parameters[<span class="st">'feature_sensitivity'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># will throw error if i haven't already fitted</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(init_trcmr(<span class="dv">20</span>, <span class="dv">20</span>, trcmr_fitted_parameters).items[<span class="dv">0</span>]) <span class="co"># to maybe avoid weird fitting failure -- we'll see if it works</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>trcmr_trials <span class="op">=</span> simulate_array_from_presentations(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    init_trcmr, trcmr_fitted_parameters, presentations[list_types<span class="op">==</span>condition], experiment_count)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>trcmr_presentations <span class="op">=</span> np.matlib.repmat(presentations[list_types<span class="op">==</span>condition], experiment_count, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[0.         0.17177067 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.98513696
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model_name <span class="op">=</span> <span class="st">'Trace Reinstatement CMR'</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">3</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>), sharey<span class="op">=</span><span class="st">'row'</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># spc</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>data_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>trcmr_spc <span class="op">=</span> flex_mixed_spc(trcmr_trials, trcmr_presentations)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_spc)), data_spc, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(trcmr_spc)), trcmr_spc, label<span class="op">=</span>model_name)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'SPC'</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># pfr</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>data_pfr <span class="op">=</span> flex_mixed_pfr(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>trcmr_pfr <span class="op">=</span> flex_mixed_pfr(trcmr_trials, trcmr_presentations)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_pfr)), data_pfr, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(trcmr_pfr)), trcmr_pfr, label<span class="op">=</span>model_name)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">1</span>].set_title(<span class="st">'PFR'</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># crp</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>lag_range <span class="op">=</span> <span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>data_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition])</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>data_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>trcmr_crp <span class="op">=</span> flex_mixed_crp(trcmr_trials, trcmr_presentations)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>trcmr_crp[lag_range] <span class="op">=</span> np.nan</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(data_crp)), data_crp, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(trcmr_crp)), trcmr_crp, label<span class="op">=</span>model_name)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>))</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(data_crp), <span class="dv">4</span>) <span class="op">-</span> lag_range)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'CRP'</span>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="co"># rpl</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> data_rpl[<span class="dv">0</span>]</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> data_rpl[<span class="dv">1</span>]</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (data_rpl[<span class="dv">2</span>] <span class="op">+</span> data_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (data_rpl[<span class="dv">4</span>] <span class="op">+</span> data_rpl[<span class="dv">5</span>] <span class="op">+</span> data_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (data_rpl[<span class="dv">7</span>] <span class="op">+</span> data_rpl[<span class="dv">8</span>] <span class="op">+</span> data_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>data_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>trcmr_rpl <span class="op">=</span> fast_rpl(</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>    trcmr_trials, trcmr_presentations, max_lag<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">0</span>] <span class="op">=</span> trcmr_rpl[<span class="dv">0</span>]</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">1</span>] <span class="op">=</span> trcmr_rpl[<span class="dv">1</span>]</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">2</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">2</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">3</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">4</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">5</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>binned[<span class="dv">4</span>] <span class="op">=</span> (trcmr_rpl[<span class="dv">7</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">8</span>] <span class="op">+</span> trcmr_rpl[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>trcmr_rpl <span class="op">=</span> binned.copy()</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(data_rpl)), data_rpl, label<span class="op">=</span><span class="st">'Data'</span>)</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(trcmr_rpl)), trcmr_rpl, label<span class="op">=</span>model_name)</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].set_title(<span class="st">'Recall Probability by Lag'</span>)</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="co"># alt contiguity (data)</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>data_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition], presentations[list_types<span class="op">==</span>condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>data_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), data_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">0</span>].set_title(<span class="st">'Repetition Contiguity -- Data'</span>)</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>trcmr_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>    trcmr_trials, trcmr_presentations, <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>trcmr_altcrp[:, lag_range] <span class="op">=</span> np.nan</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), trcmr_altcrp[<span class="dv">0</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), trcmr_altcrp[<span class="dv">1</span>][lag_range<span class="op">-</span><span class="dv">3</span>:lag_range<span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span> <span class="dv">3</span>)</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].set_title(<span class="st">'Repetition Contiguity -- '</span> <span class="op">+</span> model_name)</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>, <span class="dv">1</span>].legend(bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="lag-connectivity" class="level2">
<h2 class="anchored" data-anchor-id="lag-connectivity">Lag-Connectivity</h2>
<p>To begin our analysis of model representations underlying this effect, we’ll develop an extension of the lag-connectivity analysis that tracks whether our memory representations similarly disfavor the repetition contiguity effect.</p>
<p>We’ll simulate each study sequence presented in the study. After each simulation, we’ll identify items that were presented repeatedly with some minimum spacing between repetitions (usually 6). Then we’ll track for lags in range [-3, 3] from each study position the mean connection weight between the focused item and item at the corresponding lag.</p>
<section id="functions" class="level3">
<h3 class="anchored" data-anchor-id="functions">Functions</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> matrix_heatmap(matrix, title<span class="op">=</span><span class="st">''</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span>), savefig<span class="op">=</span><span class="va">False</span>, axis<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">    **Arguments**:  </span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">    - matrix: an array of model states, ideally with columns representing unique feature indices and rows</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">        representing unique update indices  </span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">    - title: a title for the generated plot, ideally conveying what array values represent at each entry  </span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">    - savefig: boolean deciding whether generated figure is saved (True if Yes)</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>figsize)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(matrix, annot<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="fl">.5</span>, ax<span class="op">=</span>axis)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Feature Index'</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Update Index'</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> savefig:</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        plt.savefig(<span class="st">'figures/</span><span class="sc">{}</span><span class="st">.jpeg'</span>.<span class="bu">format</span>(title).replace(<span class="st">' '</span>, <span class="st">'_'</span>).lower(), bbox_inches<span class="op">=</span><span class="st">'tight'</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> icmr_memory_heatmap(model, just_experimental<span class="op">=</span><span class="va">False</span>, just_context<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    memory_shape <span class="op">=</span> np.shape(model.memory)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    fig_size <span class="op">=</span> <span class="bu">list</span>(<span class="bu">reversed</span>(memory_shape))</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    plotted_memory <span class="op">=</span> model.memory.copy()</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"Memory Traces"</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> just_context:</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>        fig_size[<span class="dv">0</span>] <span class="op">/=</span> <span class="dv">2</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        plotted_memory <span class="op">=</span> plotted_memory[:, <span class="bu">int</span>(memory_shape[<span class="dv">1</span>]<span class="op">/</span><span class="dv">2</span>):]</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> <span class="st">"Contextual "</span> <span class="op">+</span> title</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> just_experimental:</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>        fig_size[<span class="dv">1</span>] <span class="op">-=</span> model.item_count</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>        plotted_memory <span class="op">=</span> plotted_memory[model.item_count:]</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> <span class="st">"Experimental "</span> <span class="op">+</span> title</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    matrix_heatmap(plotted_memory, title, figsize<span class="op">=</span>fig_size)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mixed_connectivity_by_lag(item_connections, presentation):</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    lag_range <span class="op">=</span> <span class="bu">len</span>(presentation) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    total_connectivity <span class="op">=</span> np.zeros(lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    total_possible_lags <span class="op">=</span> np.zeros(lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    item_positions <span class="op">=</span> np.arange(<span class="bu">len</span>(presentation), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> item <span class="kw">in</span> <span class="bu">range</span>(item_count):</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only consider items that are repeated</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>        current_positions <span class="op">=</span> np.nonzero(presentation <span class="op">==</span> item)[<span class="dv">0</span>]</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we consider each study position of repeated items separately</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> position_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(current_positions)):</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># lag of each item from current item is item_positions - current_position, </span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and will always be in range [-lag_range, lag_range] so we keep position by adding lag_range</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>            item_lags <span class="op">=</span> item_positions <span class="op">-</span> current_positions[position_index] <span class="op">+</span> lag_range</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>            total_connectivity[item_lags[presentation <span class="op">!=</span> item]] <span class="op">+=</span> item_connections[item, presentation[presentation <span class="op">!=</span> item]]</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>            total_possible_lags[item_lags[presentation <span class="op">!=</span> item]] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># divide by possible lags to get average connectivity</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>    total_possible_lags[total_connectivity <span class="op">==</span> <span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    connectivity <span class="op">=</span> total_connectivity <span class="op">/</span> total_possible_lags</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> connectivity</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> alternative_connectivity_by_lag(item_connections, presentation, minimum_lag<span class="op">=</span><span class="dv">6</span>, max_repeats<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>    item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>    lag_range <span class="op">=</span> <span class="bu">len</span>(presentation) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>    total_connectivity <span class="op">=</span> np.zeros((max_repeats, lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>    total_possible_lags <span class="op">=</span> np.zeros((max_repeats, lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>    item_positions <span class="op">=</span> np.arange(<span class="bu">len</span>(presentation), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> item <span class="kw">in</span> <span class="bu">range</span>(item_count):</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only consider items that are repeated</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>        current_positions <span class="op">=</span> np.nonzero(presentation <span class="op">==</span> item)[<span class="dv">0</span>]</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(current_positions) <span class="op">&lt;</span> max_repeats:</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>        <span class="co"># only consider items with repeats of lag &gt;= minimum_lag</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">assert</span>(current_positions[<span class="dv">1</span>] <span class="op">&gt;</span> current_positions[<span class="dv">0</span>])</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_positions[<span class="dv">1</span>] <span class="op">-</span> current_positions[<span class="dv">0</span>] <span class="op">&lt;</span> minimum_lag:</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we consider each study position of repeated items separately</span></span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> position_index <span class="kw">in</span> <span class="bu">range</span>(max_repeats):</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>            <span class="co"># lag of each item from current item is item_positions - current_position, </span></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and will always be in range [-lag_range, lag_range] so we keep position by adding lag_range</span></span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>            item_lags <span class="op">=</span> item_positions <span class="op">-</span> current_positions[position_index] <span class="op">+</span> lag_range</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>            total_connectivity[position_index, item_lags] <span class="op">+=</span> item_connections[item, presentation]</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>            total_possible_lags[position_index, item_lags] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># divide by possible lags to get average connectivity</span></span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>    total_possible_lags[total_connectivity <span class="op">==</span> <span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>    connectivity <span class="op">=</span> total_connectivity <span class="op">/</span> total_possible_lags</span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> connectivity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="instancecmr-1" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr-1">InstanceCMR</h3>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Instance_CMR</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> icmr_fitted_parameters</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]:</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        lag_range <span class="op">=</span> item_count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>            latent_mfc, latent_mcf <span class="op">=</span> latent_mfc_mcf(model)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> latent_mcf[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mfc_alternative_connectivities += alternative_connectivity_by_lag(mfc_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mcf_alternative_connectivities += alternative_connectivity_by_lag(mcf_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[0].plot(np.arange(len(mcf_alternative_connectivity[1])), mcf_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[1].plot(np.arange(len(mfc_alternative_connectivity[1])), mfc_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-20-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-20-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-20-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="classic-cmr" class="level3">
<h3 class="anchored" data-anchor-id="classic-cmr">Classic CMR</h3>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Classic_CMR</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> cmr_fitted_parameters</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]:</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        lag_range <span class="op">=</span> item_count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>            latent_mfc, latent_mcf <span class="op">=</span> latent_mfc_mcf(model)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> latent_mcf[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mfc_alternative_connectivities += alternative_connectivity_by_lag(mfc_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mcf_alternative_connectivities += alternative_connectivity_by_lag(mcf_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[0].plot(np.arange(len(mcf_alternative_connectivity[1])), mcf_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[1].plot(np.arange(len(mfc_alternative_connectivity[1])), mfc_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-21-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-21-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-21-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="tr-cmr" class="level3">
<h3 class="anchored" data-anchor-id="tr-cmr">TR-CMR</h3>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Trace_Reinstatement_CMR</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> trcmr_fitted_parameters</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]:</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        lag_range <span class="op">=</span> item_count<span class="op">+</span><span class="dv">1</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>            latent_mfc, latent_mcf <span class="op">=</span> latent_mfc_mcf(model)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> latent_mcf[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities[<span class="dv">0</span>] <span class="op">+=</span> mixed_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mfc_alternative_connectivities += alternative_connectivity_by_lag(mfc_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">#mcf_alternative_connectivities += alternative_connectivity_by_lag(mcf_connections, presentation)[:, lag_range-3:lag_range+4]</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[0].plot(np.arange(len(mcf_alternative_connectivity[1])), mcf_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[1].plot(np.arange(len(mfc_alternative_connectivity[1])), mfc_alternative_connectivity[1], label='Second Presentation')</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> global_lag_range)</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-22-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-22-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="alternative-lag-connectivity" class="level2">
<h2 class="anchored" data-anchor-id="alternative-lag-connectivity">Alternative Lag-Connectivity</h2>
<section id="instancecmr-2" class="level3">
<h3 class="anchored" data-anchor-id="instancecmr-2">InstanceCMR</h3>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Instance_CMR</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> icmr_fitted_parameters</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">4</span>]:</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trial_index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mfc)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mcf)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(presentation)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>            latent_mfc, latent_mcf <span class="op">=</span> latent_mfc_mcf(model)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> latent_mcf[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trial_index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>                icmr_memory_heatmap(model, just_experimental<span class="op">=</span><span class="va">True</span>, just_context<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(presentation)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># focus on +/- 3 lags</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>    plotting_lag_range <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivity[:, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivity[:, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">1</span>])), mcf_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">1</span>])), mfc_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-stdout">
<pre><code>[ 0  1  2  3  4  5  6  7  8  9 10 11 11 12 13 14 15 16  9 17 18 19 18 20
 21 22 19 23 24 25 21 26 27 23 28 29 30 31 32 33]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-23-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="classic-cmr-1" class="level3">
<h3 class="anchored" data-anchor-id="classic-cmr-1">Classic CMR</h3>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Classic_CMR</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> cmr_fitted_parameters</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">4</span>]:</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trial_index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mfc)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mcf)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(presentation)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>            latent_mfc, latent_mcf <span class="op">=</span> latent_mfc_mcf(model)</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> latent_mcf[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trial_index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>                icmr_memory_heatmap(model, just_experimental<span class="op">=</span><span class="va">True</span>, just_context<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(presentation)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># focus on +/- 3 lags</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    plotting_lag_range <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivity[:, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivity[:, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">1</span>])), mcf_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">1</span>])), mfc_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-24-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output-stdout">
<pre><code>[ 0  1  2  3  4  5  6  7  8  9 10 11 11 12 13 14 15 16  9 17 18 19 18 20
 21 22 19 23 24 25 21 26 27 23 28 29 30 31 32 33]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-24-output-4.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="tr-cmr-1" class="level3">
<h3 class="anchored" data-anchor-id="tr-cmr-1">TR-CMR</h3>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># configure parameters</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>model_class <span class="op">=</span> Trace_Reinstatement_CMR</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="op">=</span> trcmr_fitted_parameters</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># track results</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>global_lag_range <span class="op">=</span> <span class="dv">39</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> list_type <span class="kw">in</span> [<span class="dv">4</span>]:</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivities <span class="op">=</span> np.zeros((<span class="dv">2</span>, global_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># loop through presentations</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, presentation <span class="kw">in</span> <span class="bu">enumerate</span>(presentations[list_types<span class="op">==</span>list_type]):</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># simulate list study</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), model_parameters)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        model.experience(model.items[presentation])</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># extract item connections</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model_class.<span class="va">__name__</span> <span class="op">==</span> <span class="st">'Classic_CMR'</span>:</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> model.mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> model.mcf[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>, :]</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trial_index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mfc)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>                mfc_heatmap(model.mcf)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(presentation)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>            latent_mfc, latent_mcf <span class="op">=</span> latent_mfc_mcf(model)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>            mfc_connections <span class="op">=</span> latent_mfc[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>            mcf_connections <span class="op">=</span> latent_mcf[:, <span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> trial_index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>                icmr_memory_heatmap(model, just_experimental<span class="op">=</span><span class="va">True</span>, just_context<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(presentation)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># track alternative connectivity</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        mfc_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mfc_connections, presentation)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>        mcf_alternative_connectivities <span class="op">+=</span> alternative_connectivity_by_lag(mcf_connections, presentation)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># reduce sum to mean</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivities <span class="op">/</span> (trial_index<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity[:, global_lag_range] <span class="op">=</span> np.nan</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># focus on +/- 3 lags</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>    plotting_lag_range <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>    mfc_alternative_connectivity <span class="op">=</span> mfc_alternative_connectivity[:, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>    mcf_alternative_connectivity <span class="op">=</span> mcf_alternative_connectivity[:, global_lag_range<span class="op">-</span>plotting_lag_range:global_lag_range<span class="op">+</span>plotting_lag_range<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot results</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">0</span>])), mcf_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(mcf_alternative_connectivity[<span class="dv">1</span>])), mcf_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].set_title(<span class="st">'MCF'</span>)</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># same for MFC</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">0</span>])), mfc_alternative_connectivity[<span class="dv">0</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(mfc_alternative_connectivity[<span class="dv">1</span>])), mfc_alternative_connectivity[<span class="dv">1</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, plotting_lag_range <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>, <span class="dv">2</span>) <span class="op">-</span> plotting_lag_range)</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].set_title(<span class="st">'MFC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-stdout">
<pre><code>[ 0  1  2  3  4  5  6  7  8  9 10 11 11 12 13 14 15 16  9 17 18 19 18 20
 21 22 19 23 24 25 21 26 27 23 28 29 30 31 32 33]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Alternative_Contiguity_Tracing_files\figure-html/cell-25-output-3.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</main> <!-- /main -->
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->


</body></html>