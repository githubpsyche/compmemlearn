<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.2.281">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>compmemlearn – measuring_repetition_effects</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../../">
  <script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../../site_libs/quarto-search/quarto-search.js"></script>
  <script src="../../site_libs/quarto-html/quarto.js"></script>
  <script src="../../site_libs/quarto-html/popper.min.js"></script>
  <script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
  <link rel="stylesheet" href="../../styles.css">
</head>
<body>
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-light ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">compmemlearn</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- toc -->
    <nav id="TOC" role="doc-toc" class="sidebar sidebar-toc">
<h2 id="toc-title">On this page</h2>
<ul>
<li><a href="#repetition-effects" class="nav-link active" data-scroll-target="#repetition-effects">Repetition Effects</a>
<ul class="collapse">
<li><a href="#controlling-for-serial-position" class="nav-link" data-scroll-target="#controlling-for-serial-position">Controlling for Serial Position</a></li>
<li><a href="#recall-probability-by-lag" class="nav-link" data-scroll-target="#recall-probability-by-lag">Recall Probability by Lag</a></li>
<li><a href="#or-score" class="nav-link" data-scroll-target="#or-score">OR Score</a></li>
<li><a href="#rate-of-transition-between-items-that-follow-presentation-of-the-same-item" class="nav-link" data-scroll-target="#rate-of-transition-between-items-that-follow-presentation-of-the-same-item">Rate of transition between items that follow presentation of the same item</a></li>
<li><a href="#how-do-values-of-zeta_s-configure-temporal-contiguity-with-secondary-item-presentations" class="nav-link" data-scroll-target="#how-do-values-of-zeta_s-configure-temporal-contiguity-with-secondary-item-presentations">How Do Values of <span class="math inline">\(\zeta_s\)</span> Configure Temporal Contiguity With Secondary Item Presentations?</a>
<ul class="collapse">
<li><a href="#control-version" class="nav-link" data-scroll-target="#control-version">Control Version</a></li>
</ul></li>
<li><a href="#recall-rate-by-lag-from-repetitions" class="nav-link" data-scroll-target="#recall-rate-by-lag-from-repetitions">Recall Rate by Lag From Repetitions</a></li>
</ul></li>
</ul>
</nav>
<!-- main -->
<main class="content">

<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default_exp analyses</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="repetition-effects" class="level1">
<h1>Repetition Effects</h1>
<p>When it comes to repetition effects, Lohnas (2014) and perhaps other sources establish a few other benchmark phenomena that deserve accounting for. We include functionality for measuring these phenomena here.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> prepare_lohnas2014_data, prepare_howakaha05_data</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_howakaha05_data(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../data/HowaKaha05.dat'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_lohnas2014_data(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../data/repFR.mat'</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>events.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>

<table class="dataframe table">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th>list</th>
      <th>item</th>
      <th>input</th>
      <th>output</th>
      <th>study</th>
      <th>recall</th>
      <th>repeat</th>
      <th>intrusion</th>
      <th>condition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1.0</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>False</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2.0</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>False</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3.0</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>False</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>4.0</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>False</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>5.0</td>
      <td>True</td>
      <td>True</td>
      <td>0</td>
      <td>False</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="controlling-for-serial-position" class="level2">
<h2 class="anchored" data-anchor-id="controlling-for-serial-position">Controlling for Serial Position</h2>
<p>To control for serial position effects of repeated items, analyses are often performed on randomized recall sequences with recall probabilities matched to the serial position curve of controls lists. Recall of each item is then calculated randomly and independently across trials.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># export</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit, prange</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(parallel<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> randomize_dataset(recall_rate_by_serial_position, sample_size):</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    To control for serial position effects of repeated items, </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">    analyses are often performed on randomized recall sequences with recall probabilities </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">    matched to the serial position curve of controls lists. Recall of each item is then </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">    calculated randomly and independently across trials. </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> np.random.rand(sample_size, <span class="bu">len</span>(recall_rate_by_serial_position)) <span class="op">&lt;</span> recall_rate_by_serial_position</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> np.zeros((sample_size, <span class="bu">len</span>(recall_rate_by_serial_position)))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> prange(sample_size):</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> samples[i].nonzero()[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        np.random.shuffle(sample)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        result[i, :<span class="bu">len</span>(sample)] <span class="op">=</span> sample</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>recall_rates <span class="op">=</span> events.pivot_table(index<span class="op">=</span><span class="st">'input'</span>, values<span class="op">=</span><span class="st">'recall'</span>).to_numpy().flatten()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>randomize_dataset(recall_rates, <span class="dv">10000000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="recall-probability-by-lag" class="level2">
<h2 class="anchored" data-anchor-id="recall-probability-by-lag">Recall Probability by Lag</h2>
<p>NOTE: this version is deprecated and only maintained to aid updating the codebase; see devoted notebook “recall probability by spacing” for the much (&gt;5x) faster replacement</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recall_probability_by_lag(presentations, study_positions_in_recall_order, experiment_count<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    presented, retrieved <span class="op">=</span> np.zeros(<span class="dv">5</span>), np.zeros(<span class="dv">5</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index, sequence <span class="kw">in</span> <span class="bu">enumerate</span>(presentations):</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> experiment <span class="kw">in</span> <span class="bu">range</span>(experiment_count):</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            <span class="co"># retrieve trial information</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            trial <span class="op">=</span> study_positions_in_recall_order[trial_index<span class="op">*</span>experiment_count <span class="op">+</span> experiment]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># extract list of recalled items</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>            recalled <span class="op">=</span> sequence[trial<span class="op">-</span><span class="dv">1</span>][trial <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> item <span class="kw">in</span> np.unique(sequence):</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                locations <span class="op">=</span> np.where(sequence <span class="op">==</span> item)[<span class="dv">0</span>]</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>                <span class="co"># presented just once</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">len</span>(locations) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>                    index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># no intervening items (massed)</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                    lag <span class="op">=</span> locations[<span class="dv">1</span>] <span class="op">-</span> locations[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> lag <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                        index <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 1-2 intervening items</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> lag <span class="op">&lt;=</span> <span class="dv">2</span>:</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>                        index <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 3-5</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">elif</span> lag <span class="op">&lt;=</span> <span class="dv">5</span>:</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                        index <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 6-8</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                        index <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>                presented[index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>                retrieved[index] <span class="op">+=</span> item <span class="kw">in</span> recalled</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> retrieved, presented, retrieved<span class="op">/</span>presented</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>config InlineBackend.figure_formats <span class="op">=</span> [<span class="st">'svg'</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"dark"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>source <span class="op">=</span> <span class="st">'Lohnas &amp; Kahana (2014)'</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> recall_probability_by_lag(presentations[list_types<span class="op">&gt;=</span>condition], trials[list_types<span class="op">&gt;=</span>condition])[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result[<span class="dv">1</span>:] <span class="op">-</span> result[:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.barplot(x<span class="op">=</span>[<span class="st">'N/A'</span>, <span class="st">'0'</span>, <span class="st">'1-2'</span>, <span class="st">'3-5'</span>, <span class="st">'6-8'</span>], </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                 y<span class="op">=</span>result)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of Intervening Items Between Repetitions'</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Recall Probability'</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Condition </span><span class="sc">{}</span><span class="st">, </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(condition, source))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stdout">
<pre><code>[0.37278912 0.43928571 0.47678571 0.55714286 0.57857143]
[0.0664966  0.0375     0.08035714 0.02142857]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Measuring_Repetition_Effects_files\figure-html/cell-7-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.models <span class="im">import</span> Classic_CMR</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> int64</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(fastmath<span class="op">=</span><span class="va">True</span>, nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sim_recall_probability_by_lag(presentations, experiment_count, model_class, parameters):</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Apply organizational analyses to visually compare the behavior of the model </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">    with these parameters against specified dataset.</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    max_lag <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    total_ratio <span class="op">=</span> np.zeros(max_lag<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate simulation data from model</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> experiment <span class="kw">in</span> <span class="bu">range</span>(experiment_count):</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>        sim <span class="op">=</span> np.zeros(np.shape(presentations), dtype<span class="op">=</span>int64) <span class="co"># set as int64 when using numba, int otherwise</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(presentations)):</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>            presentation <span class="op">=</span> presentations[trial_index]</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>            item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> model_class(item_count, <span class="bu">len</span>(presentation), parameters)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate study events</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>            model.experience(model.items[presentation])</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate and collect sequence of recalled item indices</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            recalled <span class="op">=</span> model.free_recall()</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>            xsorted <span class="op">=</span> np.argsort(presentation)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>            ypos <span class="op">=</span> np.searchsorted(presentation[xsorted], recalled)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>            sim[trial_index, :<span class="bu">len</span>(recalled)] <span class="op">=</span> xsorted[ypos]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>        total_ratio <span class="op">+=</span> recall_probability_by_lag(presentations, sim)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_ratio<span class="op">/</span>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="or-score" class="level2">
<h2 class="anchored" data-anchor-id="or-score">OR Score</h2>
<p>Given that the probability of recalling an item repeated in positions i and j is equivalent to the probability of recalling either the occurrence of the item in position i or the occurrence of the item in position j, contextual variability predicts that the probability of recalling either of two once-presented items in positions i and j, termed the OR score, should increase with their spacing |i - j|.</p>
<p>To control for serial position effects of repeated items, they determined OR scores from randomized recall sequences with recall probabilities matched to the serial position curve of controls lists. They subtracted the OR scores based on these randomized recall sequences from the observed OR scores, and for illustrative purposes added the mean randomized OR score at each lag.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TBD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="rate-of-transition-between-items-that-follow-presentation-of-the-same-item" class="level2">
<h2 class="anchored" data-anchor-id="rate-of-transition-between-items-that-follow-presentation-of-the-same-item">Rate of transition between items that follow presentation of the same item</h2>
<p>They considered transitions between items following a shared repeated item. They calculated the proportion of those items recalled in <span class="math inline">\(S_j = {j + 1, j + 2}\)</span> of which CMR then recalled an item in the set <span class="math inline">\(S_i = {i + 1, i + 2}\)</span>. They also calculated the proportion of recalls <span class="math inline">\(S_i\)</span> of which CMR then transitioned to an item in the set <span class="math inline">\(S_j\)</span>. They calculated the proportion of transitions for each of lags <span class="math inline">\(j - i &gt;= 4\)</span>, and represented the mean percent of transitions across these lags.</p>
<p>To estimate the proportion of transitions that CMR would make at these lags in the absence of repeated items, they considered transitions in control lists matched to the same serial positions considered in the mixed lists. They matched these serial positions to 100 random shuffles of the control lists, and took the mean across the reshuffled datasets.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TBD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="how-do-values-of-zeta_s-configure-temporal-contiguity-with-secondary-item-presentations" class="level2">
<h2 class="anchored" data-anchor-id="how-do-values-of-zeta_s-configure-temporal-contiguity-with-secondary-item-presentations">How Do Values of <span class="math inline">\(\zeta_s\)</span> Configure Temporal Contiguity With Secondary Item Presentations?</h2>
<p>Weights in <span class="math inline">\(M^{CF}\)</span> do not just configure the overall probability of recalling an item. Since the state of context depends on prior items encoded or retrieved and <span class="math inline">\(M^{CF}\)</span> encodes context-to-item associations, differences in <span class="math inline">\(M^{CF}\)</span> learning rates for presentations of an item as enforced by the differential encoding mechanism must also the rate of transition between different items during recall.</p>
<p>In particular, weaker learning for the second presentation of a repeated item compared to the first should enforce greater rate of transitions between the repeated item and other items presented near its first presentation.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># export</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> indices_of_repeated_items(presentation_sequence):</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    values, counts <span class="op">=</span> np.unique(presentation_sequence, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    repeated_items <span class="op">=</span> {v: np.where(presentation_sequence <span class="op">==</span> v)[<span class="dv">0</span>] <span class="cf">for</span> v <span class="kw">in</span> values <span class="cf">if</span> counts[v] <span class="op">&gt;</span> <span class="dv">1</span>}</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {key:repeated_items[key] <span class="cf">for</span> key <span class="kw">in</span> repeated_items}</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> alternative_contiguity_test(mixed_presentations, mixed_recalls, lag_threshold, repetition_count):</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    relevant_lags <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="op">-</span><span class="bu">int</span>(lag_threshold<span class="op">/</span><span class="dv">2</span>), <span class="bu">int</span>(lag_threshold<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> relevant_lags[<span class="bu">int</span>(lag_threshold<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    actual_lags <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> each <span class="kw">in</span> relevant_lags] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(repetition_count)]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    possible_lags <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> each <span class="kw">in</span> relevant_lags] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(repetition_count)]</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mixed_presentations)):</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of item indices ordered as they were studied</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        presentation <span class="op">=</span> mixed_presentations[trial_index]</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of initial study positions ordered as they were recalled</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        trial_by_study_position <span class="op">=</span> mixed_recalls[trial_index]</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of item indices ordered as they were recalled</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        trial_by_item_index <span class="op">=</span> presentation[trial_by_study_position<span class="op">-</span><span class="dv">1</span>][:np.size(np.nonzero(trial_by_study_position))]</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># {item_index: [presentation indices]} for each repeated item in presentation sequence spaced by &gt;4 items</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        i_and_j <span class="op">=</span> indices_of_repeated_items(presentation)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># then for each unique repeated item in the study list, </span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> repeated_item <span class="kw">in</span> i_and_j:</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># search for relevant item(s) in recall sequence and skip if not found </span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>            look_for <span class="op">=</span> trial_by_item_index <span class="op">==</span> presentation[i_and_j[repeated_item][<span class="dv">0</span>]]</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, repetition_count):</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>                look_for <span class="op">=</span> np.logical_or(</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>                    look_for, trial_by_item_index <span class="op">==</span> presentation[i_and_j[repeated_item][k]])</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>            recall_positions <span class="op">=</span> np.where(look_for)[<span class="dv">0</span>]</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> np.size(recall_positions) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>            <span class="co"># check each position the item was observed (always just 1 position; we loop for parallelism w control)</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> recall_position <span class="kw">in</span> recall_positions:</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>                <span class="co"># also skip if no successive recall was made, </span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> np.size(trial_by_item_index) <span class="op">==</span> recall_position <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>                <span class="co"># build list of study positions for items recalled up to repeated item</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>                prior_lags <span class="op">=</span> [[] <span class="cf">for</span> each <span class="kw">in</span> <span class="bu">range</span>(repetition_count)]</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(recall_position):</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># if considered item is also repeated, we track lags wrt to all presentations</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> trial_by_item_index[i] <span class="kw">in</span> i_and_j:</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> considered <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(i_and_j[trial_by_item_index[i]])):</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">for</span> focal <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>                                prior_lags[focal].append(</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                                    <span class="bu">int</span>(i_and_j[trial_by_item_index[i]][considered] <span class="op">-</span> i_and_j[repeated_item][focal]))</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>                            prior_lags[k].append(<span class="bu">int</span>(trial_by_study_position[i] <span class="op">-</span> i_and_j[repeated_item][k]))</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>                <span class="co"># transition of a given lag is possible if lag not present in prior_lags</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> lag <span class="kw">in</span> relevant_lags:</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># skip increment if i_and_j[repeated_item][k] - i_and_j[repeated_item][-1] &lt; lag_threshold</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (k <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (i_and_j[repeated_item][k] <span class="op">-</span> i_and_j[repeated_item][k<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> lag_threshold):</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">continue</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> lag <span class="kw">not</span> <span class="kw">in</span> prior_lags[k]:</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>                            possible_lags[k][relevant_lags.index(lag)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>                <span class="co"># track each serial lag of actually transitioned-to item</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> trial_by_item_index[recall_position<span class="op">+</span><span class="dv">1</span>] <span class="kw">in</span> i_and_j:</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>                    positions <span class="op">=</span> i_and_j[trial_by_item_index[recall_position<span class="op">+</span><span class="dv">1</span>]]</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> transition_study_position <span class="kw">in</span> positions:</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># skip increment if i_and_j[repeated_item][k] - i_and_j[repeated_item][k-1] &lt; lag_threshold</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> (k <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (i_and_j[repeated_item][k] <span class="op">-</span> i_and_j[repeated_item][k<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> lag_threshold):</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">continue</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>                            lag <span class="op">=</span> <span class="bu">int</span>(transition_study_position <span class="op">-</span> i_and_j[repeated_item][k])</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> lag <span class="kw">in</span> relevant_lags:</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>                                actual_lags[k][relevant_lags.index(lag)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>                    transition_study_position <span class="op">=</span> trial_by_study_position[recall_position<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># skip increment if i_and_j[repeated_item][k] - i_and_j[repeated_item][k-1] &lt; lag_threshold</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (k <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (i_and_j[repeated_item][k] <span class="op">-</span> i_and_j[repeated_item][k<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;</span> lag_threshold):</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">continue</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>                        lag <span class="op">=</span> <span class="bu">int</span>(transition_study_position<span class="op">-</span>i_and_j[repeated_item][k])</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> lag <span class="kw">in</span> relevant_lags:</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>                            actual_lags[k][relevant_lags.index(lag)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> []</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(possible_lags[k])):</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> possible_lags[k][i] <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>                possible_lags[k][i] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>        result.append(pd.DataFrame(</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'lag'</span>: relevant_lags, <span class="st">'prob'</span>: np.divide(actual_lags[k], possible_lags[k]), </span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>            <span class="st">'actual'</span>: actual_lags[k], <span class="st">'possible'</span>: possible_lags[k]}))</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat(result, keys<span class="op">=</span>[<span class="st">'From Position </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(i<span class="op">+</span><span class="dv">1</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(repetition_count)], names<span class="op">=</span>[<span class="st">'locus'</span>])</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> alternative_contiguity_control(</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>    mixed_presentations, control_presentations, control_recalls, lag_threshold, repetition_count):</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>    relevant_lags <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="op">-</span><span class="bu">int</span>(lag_threshold<span class="op">/</span><span class="dv">2</span>), <span class="bu">int</span>(lag_threshold<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)))</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> relevant_lags[<span class="bu">int</span>(lag_threshold<span class="op">/</span><span class="dv">2</span>)]</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>    actual_lags <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> each <span class="kw">in</span> relevant_lags] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(repetition_count)]</span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>    possible_lags <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> each <span class="kw">in</span> relevant_lags] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(repetition_count)]</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mixed_presentations)):</span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of item indices ordered as they were studied</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>        presentation <span class="op">=</span> mixed_presentations[trial_index]</span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>        control_presentation <span class="op">=</span> control_presentations[trial_index]</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of initial study positions ordered as they were recalled</span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>        trial_by_study_position <span class="op">=</span> control_recalls[trial_index]</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of item indices ordered as they were recalled</span></span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>        trial_by_item_index <span class="op">=</span> control_presentation[trial_by_study_position<span class="op">-</span><span class="dv">1</span>][:np.size(np.nonzero(trial_by_study_position))]</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>        <span class="co"># {item_index: [presentation indices]} for each repeated item in presentation sequence spaced by &gt;4 items</span></span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>        i_and_j <span class="op">=</span> indices_of_repeated_items(presentation)</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>        <span class="co"># then for each unique repeated item in the study list, </span></span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> repeated_item <span class="kw">in</span> i_and_j:</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>            <span class="co"># search for relevant item(s) in recall sequence and skip if not found </span></span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>            look_for <span class="op">=</span> trial_by_item_index <span class="op">==</span> control_presentation[i_and_j[repeated_item][<span class="dv">0</span>]]</span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, repetition_count):</span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>                look_for <span class="op">=</span> np.logical_or(</span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>                    look_for, trial_by_item_index <span class="op">==</span> control_presentation[i_and_j[repeated_item][k]])</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>            recall_positions <span class="op">=</span> np.where(look_for)[<span class="dv">0</span>]</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> recall_position <span class="kw">in</span> recall_positions:</span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>                <span class="co"># also skip if no successive recall was made, </span></span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> np.size(trial_by_item_index) <span class="op">==</span> recall_position <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>                <span class="co"># build list of study positions for items recalled up to repeated item</span></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>                prior_lags <span class="op">=</span> [[] <span class="cf">for</span> each <span class="kw">in</span> <span class="bu">range</span>(repetition_count)]</span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(recall_position):</span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> trial_by_item_index[i] <span class="kw">in</span> i_and_j:</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> considered <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(i_and_j[trial_by_item_index[i]])):</span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">for</span> focal <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>                                prior_lags[focal].append(</span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>                                    <span class="bu">int</span>(i_and_j[trial_by_item_index[i]][considered] <span class="op">-</span> i_and_j[repeated_item][focal]))</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>                            prior_lags[k].append(<span class="bu">int</span>(trial_by_study_position[i] <span class="op">-</span> i_and_j[repeated_item][k]))</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>                <span class="co"># transition of a given lag is possible if lag not present in prior_lags</span></span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> lag <span class="kw">in</span> relevant_lags:</span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> lag <span class="kw">not</span> <span class="kw">in</span> prior_lags[k]:</span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>                            possible_lags[k][relevant_lags.index(lag)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>                <span class="co"># track each serial lag of actually transitioned-to item</span></span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> trial_by_item_index[recall_position<span class="op">+</span><span class="dv">1</span>] <span class="kw">in</span> i_and_j:</span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>                    positions <span class="op">=</span> i_and_j[trial_by_item_index[recall_position<span class="op">+</span><span class="dv">1</span>]]</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> transition_study_position <span class="kw">in</span> positions:</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>                            lag <span class="op">=</span> <span class="bu">int</span>(transition_study_position <span class="op">-</span> i_and_j[repeated_item][k])</span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> lag <span class="kw">in</span> relevant_lags:</span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>                                actual_lags[k][relevant_lags.index(lag)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>                    transition_study_position <span class="op">=</span> trial_by_study_position[recall_position<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span></span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>                        lag <span class="op">=</span> <span class="bu">int</span>(transition_study_position<span class="op">-</span>i_and_j[repeated_item][k])</span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> lag <span class="kw">in</span> relevant_lags:</span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a>                            actual_lags[k][relevant_lags.index(lag)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> []</span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(repetition_count):</span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a>        result.append(pd.DataFrame(</span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>            {<span class="st">'lag'</span>: relevant_lags, <span class="st">'prob'</span>: np.divide(actual_lags[k], possible_lags[k]), </span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>            <span class="st">'actual'</span>: actual_lags[k], <span class="st">'possible'</span>: possible_lags[k]}))</span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat(result, keys<span class="op">=</span>[<span class="st">'From Position </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(i<span class="op">+</span><span class="dv">1</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(repetition_count)], names<span class="op">=</span>[<span class="st">'locus'</span>])</span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sim_alternative_contiguity_test(presentations, experiment_count, lag_threshold, repetition_count, encoding_drift_rate,         </span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a>    start_drift_rate, recall_drift_rate, shared_support, item_support, learning_rate, </span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>    primacy_scale, primacy_decay, stop_probability_scale, </span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>    stop_probability_growth, choice_sensitivity, delay_drift_rate, </span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a>    drift_familiarity_scale, mfc_familiarity_scale, mcf_familiarity_scale, sampling_rule):</span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a><span class="co">    Apply organizational analyses to visually compare the behavior of the model </span></span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a><span class="co">    with these parameters against specified dataset.</span></span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate simulation data from model</span></span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> experiment <span class="kw">in</span> <span class="bu">range</span>(experiment_count):</span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a>        sim <span class="op">=</span> np.zeros(np.shape(presentations), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(presentations)):</span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a>            presentation <span class="op">=</span> presentations[trial_index]</span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a>            item_count <span class="op">=</span> np.<span class="bu">max</span>(presentation)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> Classic_CMR( item_count, <span class="bu">len</span>(presentations),  encoding_drift_rate,         </span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a>                start_drift_rate, recall_drift_rate, shared_support, item_support, learning_rate, </span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a>                primacy_scale, primacy_decay, stop_probability_scale, </span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>                stop_probability_growth, choice_sensitivity, delay_drift_rate, drift_familiarity_scale, </span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a>                 mfc_familiarity_scale, mcf_familiarity_scale, sampling_rule)</span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate study events</span></span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a>            model.experience(np.eye(model.item_count, model.item_count)[presentation])</span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a>            <span class="co"># simulate and add recall events to trials array</span></span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a>            recalled <span class="op">=</span> model.free_recall()</span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a>            xsorted <span class="op">=</span> np.argsort(presentation)</span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a>            ypos <span class="op">=</span> np.searchsorted(presentation[xsorted], recalled)</span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a>            sim[trial_index, :<span class="bu">len</span>(recalled)] <span class="op">=</span> xsorted[ypos]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a>        <span class="co"># apply contiguity test</span></span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a>        results.append(alternative_contiguity_test(presentations, sim, lag_threshold, repetition_count))</span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat(results, keys<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(experiment_count)), names<span class="op">=</span>[<span class="st">'experiment'</span>]).reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>minimum_lag <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>repetition_count <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>individual_results <span class="op">=</span> []</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> subject <span class="kw">in</span> np.unique(subjects):</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> np.logical_and(list_types <span class="op">&gt;</span> <span class="dv">3</span>, subjects <span class="op">==</span> subject)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    individual_results.append(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        alternative_contiguity_test(presentations[selection], trials[selection], minimum_lag, repetition_count))</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat(individual_results, keys<span class="op">=</span>np.unique(subjects), names<span class="op">=</span>[<span class="st">'subject'</span>]).reset_index()</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>df.drop([<span class="st">'level_2'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>

<table class="dataframe table">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th>locus</th>
      <th>lag</th>
      <th>prob</th>
      <th>actual</th>
      <th>possible</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>From Position 1</td>
      <td>-3</td>
      <td>0.000000</td>
      <td>0</td>
      <td>27</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>From Position 1</td>
      <td>-2</td>
      <td>0.115385</td>
      <td>3</td>
      <td>26</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>From Position 1</td>
      <td>-1</td>
      <td>0.153846</td>
      <td>4</td>
      <td>26</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>From Position 1</td>
      <td>1</td>
      <td>0.200000</td>
      <td>8</td>
      <td>40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>From Position 1</td>
      <td>2</td>
      <td>0.314286</td>
      <td>11</td>
      <td>35</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>415</th>
      <td>37</td>
      <td>From Position 2</td>
      <td>-2</td>
      <td>0.125000</td>
      <td>1</td>
      <td>8</td>
    </tr>
    <tr>
      <th>416</th>
      <td>37</td>
      <td>From Position 2</td>
      <td>-1</td>
      <td>0.142857</td>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>417</th>
      <td>37</td>
      <td>From Position 2</td>
      <td>1</td>
      <td>0.333333</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>418</th>
      <td>37</td>
      <td>From Position 2</td>
      <td>2</td>
      <td>0.000000</td>
      <td>0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>419</th>
      <td>37</td>
      <td>From Position 2</td>
      <td>3</td>
      <td>0.111111</td>
      <td>1</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>420 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>max_lag <span class="op">=</span> minimum_lag<span class="op">/</span><span class="dv">2</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>max_lag<span class="sc">}</span><span class="ss"> &lt;= lag &lt; 0'</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; lag &lt;= </span><span class="sc">{</span>max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.FacetGrid(df, height<span class="op">=</span><span class="fl">4.5</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>g.map_dataframe(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> data, <span class="op">**</span>kws: sns.lineplot(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data.query(filt_neg), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, hue<span class="op">=</span><span class="st">'locus'</span>, err_style<span class="op">=</span><span class="va">None</span>,<span class="op">**</span>kws)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>g.map_dataframe(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> data, <span class="op">**</span>kws: sns.lineplot(</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data.query(filt_pos), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, hue<span class="op">=</span><span class="st">'locus'</span>, err_style<span class="op">=</span><span class="va">None</span>, <span class="op">**</span>kws)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'From Position </span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(i<span class="op">+</span><span class="dv">1</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(repetition_count)], loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.title('Stronger Contiguity For First Presentation of an Item\n(Minimum Lag = {})'.format(minimum_lag))</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Measuring_Repetition_Effects_files\figure-html/cell-13-output-1.svg" class="img-fluid"></p>
</div>
</div>
<section id="control-version" class="level3">
<h3 class="anchored" data-anchor-id="control-version">Control Version</h3>
<p>How do we modify this for control lists? - Still use presentation vectors from mixed lists to define i_and_j, but use control list presentations and data for trial_by_study_position and trial_by_item_index and recall_position (except for i_and_j keys and values) - Don’t continue if trial_by_item_index[recall_position+1] in i_and_j</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>individual_results <span class="op">=</span> []</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> iteration <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">1000</span>)):</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subject <span class="kw">in</span> np.unique(subjects):</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        mixed_selection <span class="op">=</span> np.logical_and(list_types <span class="op">==</span> <span class="dv">4</span>, subjects <span class="op">==</span> subject)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        control_selection <span class="op">=</span> np.logical_and(list_types <span class="op">==</span> <span class="dv">1</span>, subjects <span class="op">==</span> subject)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        shuffled_trials <span class="op">=</span> trials[control_selection]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>        np.random.shuffle(shuffled_trials)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        individual_results.append(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>            alternative_contiguity_control(presentations[mixed_selection], presentations[control_selection], shuffled_trials, minimum_lag))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat(individual_results, keys<span class="op">=</span>np.unique(subjects), names<span class="op">=</span>[<span class="st">'subject'</span>]).reset_index()</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>df.drop([<span class="st">'level_2'</span>], axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code> 77%|███████▋  | 766/1000 [01:58&lt;00:36,  6.37it/s]C:\Users\gunnj\AppData\Local\Temp/ipykernel_7552/90211409.py:169: RuntimeWarning: invalid value encountered in true_divide
  {'lag': relevant_lags, 'prob': np.divide(actual_lagsB, possible_lagsB),
 87%|████████▋ | 872/1000 [02:14&lt;00:19,  6.63it/s]C:\Users\gunnj\AppData\Local\Temp/ipykernel_7552/90211409.py:166: RuntimeWarning: invalid value encountered in true_divide
  {'lag': relevant_lags, 'prob': np.divide(actual_lagsA, possible_lagsA),
100%|██████████| 1000/1000 [02:33&lt;00:00,  6.50it/s]</code></pre>
</div>
<div class="cell-output-display">
<div>

<table class="dataframe table">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th>locus</th>
      <th>lag</th>
      <th>prob</th>
      <th>actual</th>
      <th>possible</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>From First Position</td>
      <td>-3</td>
      <td>0.000000</td>
      <td>0</td>
      <td>13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>From First Position</td>
      <td>-2</td>
      <td>0.047619</td>
      <td>1</td>
      <td>21</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>From First Position</td>
      <td>-1</td>
      <td>0.050000</td>
      <td>1</td>
      <td>20</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>From First Position</td>
      <td>1</td>
      <td>0.230769</td>
      <td>6</td>
      <td>26</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>From First Position</td>
      <td>2</td>
      <td>0.047619</td>
      <td>1</td>
      <td>21</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>415</th>
      <td>37</td>
      <td>From Second Position</td>
      <td>-2</td>
      <td>0.000000</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>416</th>
      <td>37</td>
      <td>From Second Position</td>
      <td>-1</td>
      <td>0.000000</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>417</th>
      <td>37</td>
      <td>From Second Position</td>
      <td>1</td>
      <td>0.000000</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>418</th>
      <td>37</td>
      <td>From Second Position</td>
      <td>2</td>
      <td>0.000000</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>419</th>
      <td>37</td>
      <td>From Second Position</td>
      <td>3</td>
      <td>0.000000</td>
      <td>0</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>420 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>max_lag <span class="op">=</span> minimum_lag<span class="op">/</span><span class="dv">2</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>filt_neg <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span><span class="op">-</span>max_lag<span class="sc">}</span><span class="ss"> &lt;= lag &lt; 0'</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>filt_pos <span class="op">=</span> <span class="ss">f'0 &lt; lag &lt;= </span><span class="sc">{</span>max_lag<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.FacetGrid(df, height<span class="op">=</span><span class="fl">4.5</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>g.map_dataframe(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> data, <span class="op">**</span>kws: sns.lineplot(</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data.query(filt_neg), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, hue<span class="op">=</span><span class="st">'locus'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, <span class="op">**</span>kws)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>g.map_dataframe(</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> data, <span class="op">**</span>kws: sns.lineplot(</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>data.query(filt_pos), x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>, hue<span class="op">=</span><span class="st">'locus'</span>, err_style<span class="op">=</span><span class="st">'bars'</span>, <span class="op">**</span>kws)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'First Presentation'</span>, <span class="st">'Second Presentation'</span>], loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Control Analysis </span><span class="ch">\n</span><span class="st">(Minimum Lag = </span><span class="sc">{}</span><span class="st">)'</span>.<span class="bu">format</span>(minimum_lag))</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Measuring_Repetition_Effects_files\figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="recall-rate-by-lag-from-repetitions" class="level2">
<h2 class="anchored" data-anchor-id="recall-rate-by-lag-from-repetitions">Recall Rate by Lag From Repetitions</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> recall_rate_by_lag(mixed_presentations, mixed_recalls, lag_threshold, lag):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Find each item repetition in mixed_presentations and compute the recall rate for items at specified lag from each presentation position. Return the rate relative to the first presentation of each item and relative to the second.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    recalls_A <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    recalls_B <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> trial_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(mixed_presentations)):</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of item indices ordered as they were studied</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>        presentation <span class="op">=</span> mixed_presentations[trial_index]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of initial study positions ordered as they were recalled</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        trial_by_study_position <span class="op">=</span> mixed_recalls[trial_index]</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sequence of item indices ordered as they were recalled</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        trial_by_item_index <span class="op">=</span> presentation[trial_by_study_position<span class="op">-</span><span class="dv">1</span>][:np.size(np.nonzero(trial_by_study_position))]</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># {item_index: [presentation indices]} for each repeated item in presentation sequence spaced by &gt;4 items</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>        i_and_j <span class="op">=</span> indices_of_repeated_items(presentation, lag_threshold)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># then for each unique repeated item in the study list, </span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> repeated_item <span class="kw">in</span> i_and_j:</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the indices of neighbors to each presentation</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>            neighborA <span class="op">=</span> presentation[i_and_j[repeated_item][<span class="dv">0</span>] <span class="op">+</span> lag]</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>            neighborB <span class="op">=</span> presentation[i_and_j[repeated_item][<span class="dv">1</span>] <span class="op">+</span> lag]</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># skip if the neighbor is also a repeatedly presented item</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (neighborA <span class="kw">in</span> i_and_j) <span class="kw">or</span> (neighborB <span class="kw">in</span> i_and_j):</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># track if they were recalled</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>            recalls_A <span class="op">+=</span> np.<span class="bu">any</span>(neighborA <span class="op">==</span> trial_by_item_index)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>            recalls_B <span class="op">+=</span> np.<span class="bu">any</span>(neighborB <span class="op">==</span> trial_by_item_index)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>            total <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> recalls_A<span class="op">/</span>total, recalls_B<span class="op">/</span>total, total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>individual_resultsA <span class="op">=</span> []</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>individual_resultsB <span class="op">=</span> []</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> subject <span class="kw">in</span> np.unique(subjects):</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    selection <span class="op">=</span> np.logical_and(list_types <span class="op">&gt;</span> <span class="dv">2</span>, subjects <span class="op">==</span> subject)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> recall_rate_by_lag(presentations[selection], trials[selection], <span class="dv">4</span>, <span class="dv">1</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    individual_resultsA.append(result[<span class="dv">0</span>])</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    individual_resultsB.append(result[<span class="dv">1</span>])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>np.mean(individual_resultsA), np.mean(individual_resultsB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<pre><code>(0.3857720129269049, 0.382558043145297)</code></pre>
</div>
</div>


</section>
</section>
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</main> <!-- /main -->
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->


</body></html>