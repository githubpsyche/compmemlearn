<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang=""><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.2.281">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>compmemlearn ‚Äì statistic_based_fitting_to_repetition_effects</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../../../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../../../">
  <script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../../../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../../../site_libs/quarto-search/quarto-search.js"></script>
  <script src="../../../site_libs/quarto-html/quarto.js"></script>
  <script src="../../../site_libs/quarto-html/popper.min.js"></script>
  <script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../../../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 2,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <link rel="stylesheet" href="../../../styles.css">
</head>
<body>
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-light ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">compmemlearn</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">About</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- toc -->
    <nav id="TOC" role="doc-toc" class="sidebar sidebar-toc">
<h2 id="toc-title">On this page</h2>
<ul>
<li><a href="#statistic-focused-fitting" class="nav-link active" data-scroll-target="#statistic-focused-fitting">Statistic-Focused Fitting</a>
<ul class="collapse">
<li><a href="#functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
</ul></li>
<li><a href="#export" class="nav-link" data-scroll-target="#export">export</a>
<ul class="collapse">
<li><a href="#fit-to-alternative-contiguity-effect" class="nav-link" data-scroll-target="#fit-to-alternative-contiguity-effect">Fit to Alternative Contiguity EFfect</a></li>
<li><a href="#fit-to-spacing-effect" class="nav-link" data-scroll-target="#fit-to-spacing-effect">Fit to Spacing Effect</a></li>
<li><a href="#alternative-contiguity-omnibus" class="nav-link" data-scroll-target="#alternative-contiguity-omnibus">Alternative Contiguity Omnibus</a></li>
<li><a href="#spacing-omnibus" class="nav-link" data-scroll-target="#spacing-omnibus">Spacing Omnibus</a></li>
<li><a href="#omnibus" class="nav-link" data-scroll-target="#omnibus">Omnibus</a></li>
</ul></li>
</ul>
</nav>
<!-- main -->
<main class="content">

<section id="statistic-focused-fitting" class="level2">
<h2 class="anchored" data-anchor-id="statistic-focused-fitting">Statistic-Focused Fitting</h2>
<blockquote class="blockquote">
<p>Example driven review and analysis fo how fitting model to a specific selection of phenomena helps clarify model limitations. Useful for establishing that model can or cannot account for the considered effect in principle. But limited, even in aggregate, as measure of overall performance.</p>
</blockquote>
<p>When fitting across an array of phenomena results in a poor account of one or more of them, it‚Äôs possible to systematically sleuth for more specific tension-points in our model by fitting the model to each possible combination of 1 or more phenomena in the array, effectively isolating the patterns proving problematic for the model. This approach identifies patterns cannot account for individually, but also those it can account for only when at least one other relevant pattern is ignored. We‚Äôve done a demo-driven explanation of all this using the PFR plateau. Now we extend the method to clarify just how hard it is for CMR to account for the alternative contiguity effect we‚Äôve been scratching our heads about for so long now.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.datasets <span class="im">import</span> prepare_lohnas2014_data, simulate_array_from_presentations</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.fitting <span class="im">import</span> lohnas_objective_function</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.models <span class="im">import</span> Classic_CMR</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> differential_evolution</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> int32</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.typed <span class="im">import</span> List, Dict</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba.core <span class="im">import</span> types</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numba <span class="im">import</span> njit, literal_unroll, prange</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> compmemlearn.analyses <span class="im">import</span> flex_mixed_spc, flex_mixed_crp, flex_mixed_pfr, fast_csp, alternative_contiguity, rpl, fast_rpl</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [<span class="st">'Control'</span>, <span class="st">'Massed'</span>, <span class="st">'Spaced'</span>, <span class="st">'Mixed'</span>]</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>trials, events, list_length, presentations, list_types, rep_data, subjects <span class="op">=</span> prepare_lohnas2014_data(</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'../../../data/repFR.mat'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="functions" class="level3">
<h3 class="anchored" data-anchor-id="functions">Functions</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lohnas_mse(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    trials, presentations, statistics, model_class, parameters):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># generate simulation data from model</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    sim_trials <span class="op">=</span> simulate_array_from_presentations(model_class, parameters, presentations, <span class="dv">1</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># collect MSE for each relevant statistic</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> statistic <span class="kw">in</span> literal_unroll(statistics):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        simulation_outcome <span class="op">=</span> statistic(sim_trials, presentations)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        data_outcome <span class="op">=</span> statistic(trials, presentations)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> np.nanmean(np.square(simulation_outcome <span class="op">-</span> data_outcome))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return mean of results across statistics</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">/</span><span class="bu">len</span>(statistics)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lohnas_mse_objective_function(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    data_to_fit, presentations, statistics, model_class, fixed_parameters, free_parameters):</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    parameters <span class="op">=</span> Dict.empty(key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, value <span class="kw">in</span> fixed_parameters.items():</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        parameters[name] <span class="op">=</span> value</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> objective_function(x):</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(free_parameters)):</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>            parameters[free_parameters[i]] <span class="op">=</span> x[i]</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> lohnas_mse(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            data_to_fit, presentations, statistics, model_class, parameters)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> objective_function</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="export" class="level1">
<h1>export</h1>
<p>from numba import njit from numba import int32 import numpy as np from compmemlearn.analyses import recall_by_all_study_positions</p>
<p>int32 = int #<span class="citation" data-cites="njit">@njit</span>(nogil=True) def alternative_contiguity(trials, presentations, lag_threshold = 3, max_repeats = 2):</p>
<pre><code>list_length = len(presentations[0])
lag_range = list_length - 1
total_actual_lags = np.zeros((max_repeats, lag_range * 2 + 1)) # extended dimension to split by pres positions
total_possible_lags = np.zeros((max_repeats, lag_range * 2 + 1))
terminus = np.sum(trials != 0, axis=1) # number of recalls per trial
recall_by_study_position = recall_by_all_study_positions(trials, presentations, max_repeats)

for trial_index in range(len(trials)):
    previous_item = 0
    item_count = np.max(presentations[trial_index]) + 1
    possible_items = np.arange(item_count) # initial pool of possible recalls, 1-indexed
    possible_positions = np.zeros((item_count, max_repeats), dtype=int32)
    
    # we track possible positions using presentations and alt_presentations
    for item in range(item_count):
        pos = np.nonzero(presentations[trial_index] == item)[0] + 1
        possible_positions[item, :len(pos)] = pos
        
    for recall_index in range(terminus[trial_index]):

        current_item = presentations[trial_index][trials[trial_index, recall_index]-1]
        
        # track possible and actual lags; 
        # focus only on transitions from items with &gt; 1 study positions
        # and only when those multiple study positions have lag over lag
        if recall_index &gt; 0 and np.count_nonzero(
            possible_positions[previous_item]) &gt; 1 and (
            possible_positions[previous_item][1] - possible_positions[previous_item][0] &gt;= lag_threshold):
            
            # item indices don't help track lags anymore
            # so more complex calculation needed to identify possible lags given previous item
            current_index = np.nonzero(possible_items==current_item)[0]

            index = 0
            for x in range(len(recall_by_study_position)):
                for y in range(len(recall_by_study_position)):
                    if possible_positions[previous_item, y] &gt; 0:
                    
                        possible_lags = possible_positions[
                            possible_items, x] - possible_positions[previous_item, y]
                        
                        # if tracked position is 0, then we don't actually want to count it in our lags
                        possible_lags[possible_positions[possible_items, x] == 0] = 0
                        
                        # we track actual lag at each iteration
                        actual_lag = possible_lags[current_index] + lag_range
                        total_actual_lags[y][actual_lag] += 1

                        # we track possible lag at each iteration
                        possible_lags += lag_range
                        total_possible_lags[y][possible_lags] += 1
                    
                    index += 1

        # update pool to exclude recalled item (updated to still identify 1-indexed item)
        previous_item = current_item
        possible_items = possible_items[possible_items != previous_item]


# small correction to avoid nans and commit to excluding multiply-tracked single presentations 
total_actual_lags[:, lag_range] = 0
for i in range(max_repeats):
    total_possible_lags[i][total_actual_lags[i]==0] += 1

return total_actual_lags/total_possible_lags</code></pre>
<p>#<span class="citation" data-cites="njit">@njit</span>(nogil=True) def simulate_array_from_presentations(model_class, parameters, presentations, experiment_count):</p>
<pre><code># simulate retrieval for the specified number of times, tracking results in trials array
trials = np.zeros((experiment_count * len(presentations), np.max(presentations)+1), dtype=int32)

for experiment in range(experiment_count):
    for trial_index in range(len(presentations)):
    
        # retrieve presentation sequence for this trial and measure number of unique items
        presentation = presentations[trial_index]
        item_count = np.max(presentation)+1
        
        # simulate recall and identify first study position of each recalled item
        model = model_class(item_count, len(presentation), parameters)
        model.experience(model.items[presentation])
        recalled = model.free_recall()
        
        for i in range(len(recalled)):
            trials[experiment*len(presentations) + trial_index, i] = find_first(recalled[i], presentation) + 1

return trials</code></pre>
<p>#<span class="citation" data-cites="njit">@njit</span>(nogil=True) def find_first(item, vec): ‚Äú‚Äú‚Äúreturn the index of the first occurence of item in vec‚Äù‚Äú‚Äù for i in range(len(vec)): if item == vec[i]: return i return -1</p>
<section id="fit-to-alternative-contiguity-effect" class="level3">
<h3 class="anchored" data-anchor-id="fit-to-alternative-contiguity-effect">Fit to Alternative Contiguity EFfect</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cmr_free_parameters <span class="op">=</span> (</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'encoding_drift_rate'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'start_drift_rate'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'recall_drift_rate'</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'shared_support'</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'item_support'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'learning_rate'</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_scale'</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'primacy_decay'</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_scale'</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'stop_probability_growth'</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'choice_sensitivity'</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>ub <span class="op">=</span> <span class="dv">1</span><span class="op">-</span>np.finfo(<span class="bu">float</span>).eps</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>cmr_bounds <span class="op">=</span> [</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">100</span>),</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    (lb, ub),</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    (lb, <span class="dv">10</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_cmr(item_count, presentation_count, parameters):</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Classic_CMR(item_count, presentation_count, parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> <span class="dv">4</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_mse_objective_function(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    (alternative_contiguity, ), </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'delay_drift_rate'</span>:<span class="dv">0</span>, <span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    cmr_free_parameters)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>cmr_result <span class="op">=</span> differential_evolution(cost_function, cmr_bounds, disp<span class="op">=</span><span class="va">True</span>, atol<span class="op">=</span><span class="fl">.0001</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.matlib</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>sim_trials <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>sim_presentations <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">3</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cmr_result.x)):</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[cmr_free_parameters[j]] <span class="op">=</span> cmr_result.x[j]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'delay_drift_rate'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>sim_trials.append(simulate_array_from_presentations(</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    init_cmr, fitted_parameters, presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>sim_presentations.append(np.matlib.repmat(presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="16">
<div class="sourceCode" id="cb8"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>test_altcrp<span class="op">=</span> alternative_contiguity(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>test_altcrp[:, list_length<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), test_altcrp[<span class="dv">0</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), test_altcrp[<span class="dv">1</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span><span class="dv">3</span>) </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>sim_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    sim_trials[condition], sim_presentations[condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>sim_altcrp[:, list_length<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), sim_altcrp[<span class="dv">0</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), sim_altcrp[<span class="dv">1</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Alternative Contiguity, '</span> <span class="op">+</span> conditions[condition] <span class="op">+</span> <span class="st">' Condition'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.xlabel('Lag')</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.ylabel('Conditional Response Probability') `  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistic_Based_Fitting_to_Repetition_Effects_files\figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="fit-to-spacing-effect" class="level3">
<h3 class="anchored" data-anchor-id="fit-to-spacing-effect">Fit to Spacing Effect</h3>
<div class="cell" data-execution_count="27">
<div class="sourceCode" id="cb9"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> <span class="dv">4</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_mse_objective_function(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    (fast_rpl, ), </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'delay_drift_rate'</span>:<span class="dv">0</span>, <span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    cmr_free_parameters)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>cmr_result <span class="op">=</span> differential_evolution(cost_function, cmr_bounds, disp<span class="op">=</span><span class="va">True</span>, atol<span class="op">=</span><span class="fl">.001</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>C:\ProgramData\Miniconda3\lib\site-packages\numba\core\utils.py:544: NumbaExperimentalFeatureWarning: [1mFirst-class function type feature is experimental[0m
  warnings.warn("First-class function type feature is experimental",</code></pre>
</div>
<div class="cell-output-stdout">
<pre><code>differential_evolution step 1: f(x)= 0.0444259
differential_evolution step 2: f(x)= 0.0133843
differential_evolution step 3: f(x)= 0.012045
differential_evolution step 4: f(x)= 0.012045
differential_evolution step 5: f(x)= 0.00545723
differential_evolution step 6: f(x)= 0.00473103
differential_evolution step 7: f(x)= 0.00257982
differential_evolution step 8: f(x)= 0.00257982
differential_evolution step 9: f(x)= 0.00257982
differential_evolution step 10: f(x)= 0.00257982
differential_evolution step 11: f(x)= 0.00257982
differential_evolution step 12: f(x)= 0.00201231
differential_evolution step 13: f(x)= 0.00201231
differential_evolution step 14: f(x)= 0.00155401
differential_evolution step 15: f(x)= 0.00155401
differential_evolution step 16: f(x)= 0.00155401
differential_evolution step 17: f(x)= 0.00155401
differential_evolution step 18: f(x)= 0.00155401
differential_evolution step 19: f(x)= 0.00146618
differential_evolution step 20: f(x)= 0.00125419
differential_evolution step 21: f(x)= 0.00125419
differential_evolution step 22: f(x)= 0.00125419
differential_evolution step 23: f(x)= 0.00125419
differential_evolution step 24: f(x)= 0.00125419
differential_evolution step 25: f(x)= 0.00125419
differential_evolution step 26: f(x)= 0.00125419
differential_evolution step 27: f(x)= 0.00125419
differential_evolution step 28: f(x)= 0.00125419
differential_evolution step 29: f(x)= 0.00125419
differential_evolution step 30: f(x)= 0.00125419
differential_evolution step 31: f(x)= 0.00125419
differential_evolution step 32: f(x)= 0.00125419
differential_evolution step 33: f(x)= 0.00125419
differential_evolution step 34: f(x)= 0.00125419
differential_evolution step 35: f(x)= 0.00125419
differential_evolution step 36: f(x)= 0.00125419
differential_evolution step 37: f(x)= 0.00125419
differential_evolution step 38: f(x)= 0.00125419
differential_evolution step 39: f(x)= 0.00125419
differential_evolution step 40: f(x)= 0.00125419
differential_evolution step 41: f(x)= 0.000702002
differential_evolution step 42: f(x)= 0.000702002
differential_evolution step 43: f(x)= 0.000702002
differential_evolution step 44: f(x)= 0.000702002</code></pre>
</div>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.matlib</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>sim_trials <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>sim_presentations <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">3</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cmr_result.x)):</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[cmr_free_parameters[j]] <span class="op">=</span> cmr_result.x[j]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'delay_drift_rate'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>sim_trials.append(simulate_array_from_presentations(</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    init_cmr, fitted_parameters, presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count))</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>sim_presentations.append(np.matlib.repmat(presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rpl(presentations, trials, subjects, trial_count, list_length, max_lag<span class="op">=</span><span class="dv">8</span>):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#subjects = len(np.unique(events.subject))</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#trial_count = np.max(events.list)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#list_length = np.max(events.input)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#lags = ['N/A'] + list(range(max_lag+1))</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    lags <span class="op">=</span> [<span class="st">'N/A'</span>, <span class="st">'0'</span>, <span class="st">'1-2'</span>, <span class="st">'3-5'</span>, <span class="st">'6-8'</span>]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> {<span class="st">'subject'</span>: [], <span class="st">'lag'</span>: [], <span class="st">'prob'</span>: []}</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subject <span class="kw">in</span> <span class="bu">range</span>(subjects):</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        subject_result <span class="op">=</span> fast_rpl(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            trials[subject<span class="op">*</span>trial_count:(subject<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>trial_count], presentations[subject<span class="op">*</span>trial_count:(subject<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>trial_count], max_lag)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        binned <span class="op">=</span> np.zeros(<span class="dv">5</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">0</span>] <span class="op">=</span> subject_result[<span class="dv">0</span>]</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">1</span>] <span class="op">=</span> subject_result[<span class="dv">1</span>]</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">2</span>] <span class="op">=</span> (subject_result[<span class="dv">2</span>] <span class="op">+</span> subject_result[<span class="dv">3</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">3</span>] <span class="op">=</span> (subject_result[<span class="dv">4</span>] <span class="op">+</span> subject_result[<span class="dv">5</span>] <span class="op">+</span> subject_result[<span class="dv">6</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        binned[<span class="dv">4</span>] <span class="op">=</span> (subject_result[<span class="dv">7</span>] <span class="op">+</span> subject_result[<span class="dv">8</span>] <span class="op">+</span> subject_result[<span class="dv">9</span>])<span class="op">/</span><span class="dv">3</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        result[<span class="st">'subject'</span>] <span class="op">+=</span> [subject<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span><span class="bu">len</span>(lags)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        result[<span class="st">'lag'</span>] <span class="op">+=</span> lags</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        result[<span class="st">'prob'</span>] <span class="op">+=</span> binned.tolist()</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="30">
<div class="sourceCode" id="cb14"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>subject_count <span class="op">=</span> <span class="bu">len</span>(np.unique(events.subject))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>trial_count <span class="op">=</span> <span class="bu">int</span>(np.<span class="bu">max</span>(events.<span class="bu">list</span>)<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> rpl(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    presentations[list_types<span class="op">==</span>condition], trials[list_types<span class="op">==</span>condition], </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    subject_count, trial_count, list_length)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>sns.barplot(ax<span class="op">=</span>axes[<span class="dv">0</span>], data<span class="op">=</span>data, x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>sim_data <span class="op">=</span> rpl(</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    sim_presentations[<span class="dv">3</span>], sim_trials[<span class="dv">3</span>],</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    subject_count, trial_count, list_length)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>sns.barplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>sim_data, x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Recall Probability by Spacing"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Statistic_Based_Fitting_to_Repetition_Effects_files\figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="alternative-contiguity-omnibus" class="level3">
<h3 class="anchored" data-anchor-id="alternative-contiguity-omnibus">Alternative Contiguity Omnibus</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_cmr(item_count, presentation_count, parameters):</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Classic_CMR(item_count, presentation_count, parameters)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> <span class="dv">4</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    (flex_mixed_spc, flex_mixed_crp, alternative_contiguity), </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'delay_drift_rate'</span>:<span class="dv">0</span>, <span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    cmr_free_parameters)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>cmr_result <span class="op">=</span> differential_evolution(cost_function, cmr_bounds, disp<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sim_trials <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>sim_presentations <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">3</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cmr_result.x)):</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[cmr_free_parameters[j]] <span class="op">=</span> cmr_result.x[j]</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'delay_drift_rate'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>sim_trials.append(simulate_array_from_presentations(</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    init_cmr, fitted_parameters, presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count))</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>sim_presentations.append(np.matlib.repmat(presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition <span class="kw">in</span> [<span class="dv">3</span>]:</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    test_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(test_spc)), test_spc, label<span class="op">=</span>conditions[condition])</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    sim_spc <span class="op">=</span> flex_mixed_spc(sim_trials[condition], sim_presentations[condition])</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(sim_spc)), sim_spc, label<span class="op">=</span>conditions[condition])</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#axes[0].set(xlabel='Presentation Position', ylabel='Recall Rate') </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#axes[1].set(xlabel='Presentation Position', ylabel='Recall Rate') </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Serial Position Curve"</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition <span class="kw">in</span> [<span class="dv">3</span>]:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    test_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    test_crp[<span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(test_crp)), test_crp, label<span class="op">=</span>conditions[condition])</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    sim_crp <span class="op">=</span> flex_mixed_crp(sim_trials[condition], sim_presentations[condition])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    sim_crp[<span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(sim_crp)), sim_crp, label<span class="op">=</span>conditions[condition])</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.xlabel('Lag')</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.ylabel('Conditional Response Probability')   </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(test_crp), <span class="dv">4</span>))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(test_crp), <span class="dv">4</span>) <span class="op">-</span> <span class="dv">39</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(sim_crp), <span class="dv">4</span>))</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(sim_crp), <span class="dv">4</span>) <span class="op">-</span> <span class="dv">39</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Lag-CRP'</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>test_altcrp<span class="op">=</span> alternative_contiguity(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>test_altcrp[:, list_length<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), test_altcrp[<span class="dv">0</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), test_altcrp[<span class="dv">1</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span><span class="dv">3</span>) </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>sim_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    sim_trials[condition], sim_presentations[condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>sim_altcrp[:, list_length<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), sim_altcrp[<span class="dv">0</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), sim_altcrp[<span class="dv">1</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Alternative Contiguity, '</span> <span class="op">+</span> conditions[condition] <span class="op">+</span> <span class="st">' Condition'</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.xlabel('Lag')</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.ylabel('Conditional Response Probability') `  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="spacing-omnibus" class="level3">
<h3 class="anchored" data-anchor-id="spacing-omnibus">Spacing Omnibus</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_cmr(item_count, presentation_count, parameters):</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Classic_CMR(item_count, presentation_count, parameters)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> <span class="dv">4</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    (flex_mixed_spc, flex_mixed_crp, fast_rpl), </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'delay_drift_rate'</span>:<span class="dv">0</span>, <span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    cmr_free_parameters)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>cmr_result <span class="op">=</span> differential_evolution(cost_function, cmr_bounds, disp<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sim_trials <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>sim_presentations <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">3</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cmr_result.x)):</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[cmr_free_parameters[j]] <span class="op">=</span> cmr_result.x[j]</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'delay_drift_rate'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>sim_trials.append(simulate_array_from_presentations(</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    init_cmr, fitted_parameters, presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count))</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>sim_presentations.append(np.matlib.repmat(presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition <span class="kw">in</span> [<span class="dv">3</span>]:</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    test_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(test_spc)), test_spc, label<span class="op">=</span>conditions[condition])</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    sim_spc <span class="op">=</span> flex_mixed_spc(sim_trials[condition], sim_presentations[condition])</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(sim_spc)), sim_spc, label<span class="op">=</span>conditions[condition])</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#axes[0].set(xlabel='Presentation Position', ylabel='Recall Rate') </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#axes[1].set(xlabel='Presentation Position', ylabel='Recall Rate') </span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Serial Position Curve"</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition <span class="kw">in</span> [<span class="dv">3</span>]:</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    test_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    test_crp[<span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(test_crp)), test_crp, label<span class="op">=</span>conditions[condition])</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    sim_crp <span class="op">=</span> flex_mixed_crp(sim_trials[condition], sim_presentations[condition])</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    sim_crp[<span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(sim_crp)), sim_crp, label<span class="op">=</span>conditions[condition])</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.xlabel('Lag')</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.ylabel('Conditional Response Probability')   </span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(test_crp), <span class="dv">4</span>))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(test_crp), <span class="dv">4</span>) <span class="op">-</span> <span class="dv">39</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(sim_crp), <span class="dv">4</span>))</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(sim_crp), <span class="dv">4</span>) <span class="op">-</span> <span class="dv">39</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Lag-CRP'</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>subject_count <span class="op">=</span> <span class="bu">len</span>(np.unique(events.subject))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>trial_count <span class="op">=</span> <span class="bu">int</span>(np.<span class="bu">max</span>(events.<span class="bu">list</span>)<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> rpl(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    presentations[list_types<span class="op">==</span>condition], trials[list_types<span class="op">==</span>condition], </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    subject_count, trial_count, list_length)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>sns.barplot(ax<span class="op">=</span>axes[<span class="dv">0</span>], data<span class="op">=</span>data, x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>sim_data <span class="op">=</span> rpl(</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    sim_presentations[<span class="dv">3</span>], sim_trials[<span class="dv">3</span>],</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    subject_count, trial_count, list_length)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>sns.barplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>sim_data, x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Recall Probability by Spacing"</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="omnibus" class="level3">
<h3 class="anchored" data-anchor-id="omnibus">Omnibus</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cost function to be minimized</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ours scales inversely with the probability that the data could have been </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generated using the specified parameters and our model</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="at">@njit</span>(nogil<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> init_cmr(item_count, presentation_count, parameters):</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Classic_CMR(item_count, presentation_count, parameters)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> list_types <span class="op">==</span> <span class="dv">4</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>cost_function <span class="op">=</span> lohnas_objective_function(</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    trials[selection], </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    presentations[selection],</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    (flex_mixed_spc, flex_mixed_crp, alternative_contiguity, fast_rpl), </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    init_cmr,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    {<span class="st">'delay_drift_rate'</span>:<span class="dv">0</span>, <span class="st">'sampling_rule'</span>: <span class="dv">0</span>, <span class="st">'mfc_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'drift_familiarity_scale'</span>: <span class="dv">0</span>, <span class="st">'mcf_familiarity_scale'</span>: <span class="dv">0</span>}, </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    cmr_free_parameters)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>cmr_result <span class="op">=</span> differential_evolution(cost_function, cmr_bounds, disp<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>experiment_count <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>sim_trials <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>sim_presentations <span class="op">=</span> [<span class="st">'dummy'</span>]<span class="op">*</span><span class="dv">3</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>fitted_parameters <span class="op">=</span> Dict.empty(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        key_type<span class="op">=</span>types.unicode_type, value_type<span class="op">=</span>types.float64)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>i<span class="op">=</span><span class="dv">3</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cmr_result.x)):</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    fitted_parameters[cmr_free_parameters[j]] <span class="op">=</span> cmr_result.x[j]</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'sampling_rule'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mfc_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'mcf_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'drift_familiarity_scale'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>fitted_parameters[<span class="st">'delay_drift_rate'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>sim_trials.append(simulate_array_from_presentations(</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    init_cmr, fitted_parameters, presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count))</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>sim_presentations.append(np.matlib.repmat(presentations[list_types<span class="op">==</span>i<span class="op">+</span><span class="dv">1</span>], experiment_count, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition <span class="kw">in</span> [<span class="dv">3</span>]:</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    test_spc<span class="op">=</span> flex_mixed_spc(trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(test_spc)), test_spc, label<span class="op">=</span>conditions[condition])</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    sim_spc <span class="op">=</span> flex_mixed_spc(sim_trials[condition], sim_presentations[condition])</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(sim_spc)), sim_spc, label<span class="op">=</span>conditions[condition])</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">#axes[0].set(xlabel='Presentation Position', ylabel='Recall Rate') </span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">#axes[1].set(xlabel='Presentation Position', ylabel='Recall Rate') </span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Serial Position Curve"</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition <span class="kw">in</span> [<span class="dv">3</span>]:</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    test_crp<span class="op">=</span> flex_mixed_crp(trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    test_crp[<span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].plot(np.arange(<span class="bu">len</span>(test_crp)), test_crp, label<span class="op">=</span>conditions[condition])</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    sim_crp <span class="op">=</span> flex_mixed_crp(sim_trials[condition], sim_presentations[condition])</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    sim_crp[<span class="bu">len</span>(presentations[<span class="dv">0</span>])<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].plot(np.arange(<span class="bu">len</span>(sim_crp)), sim_crp, label<span class="op">=</span>conditions[condition])</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.xlabel('Lag')</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.ylabel('Conditional Response Probability')   </span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(test_crp), <span class="dv">4</span>))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(test_crp), <span class="dv">4</span>) <span class="op">-</span> <span class="dv">39</span>)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(sim_crp), <span class="dv">4</span>))</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">0</span>, <span class="bu">len</span>(sim_crp), <span class="dv">4</span>) <span class="op">-</span> <span class="dv">39</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Lag-CRP'</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>test_altcrp<span class="op">=</span> alternative_contiguity(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    trials[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], presentations[list_types<span class="op">==</span>condition<span class="op">+</span><span class="dv">1</span>], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>test_altcrp[:, list_length<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), test_altcrp[<span class="dv">0</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].plot(np.arange(<span class="dv">7</span>), test_altcrp[<span class="dv">1</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span><span class="dv">3</span>) </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>sim_altcrp <span class="op">=</span> alternative_contiguity(</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    sim_trials[condition], sim_presentations[condition], <span class="dv">6</span>, <span class="dv">2</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>sim_altcrp[:, list_length<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), sim_altcrp[<span class="dv">0</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'First Presentation'</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(np.arange(<span class="dv">7</span>), sim_altcrp[<span class="dv">1</span>][list_length<span class="op">-</span><span class="dv">1</span><span class="op">-</span><span class="dv">3</span>:list_length<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="dv">4</span>], label<span class="op">=</span><span class="st">'Second Presentation'</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticks(np.arange(<span class="dv">7</span>))</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xticklabels(np.arange(<span class="dv">7</span>) <span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].legend(title<span class="op">=</span><span class="st">'Condition'</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Alternative Contiguity, '</span> <span class="op">+</span> conditions[condition] <span class="op">+</span> <span class="st">' Condition'</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.xlabel('Lag')</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.ylabel('Conditional Response Probability') `  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode python cell-code code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>condition <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span><span class="op">/</span><span class="dv">2</span>), sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>subject_count <span class="op">=</span> <span class="bu">len</span>(np.unique(events.subject))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>trial_count <span class="op">=</span> <span class="bu">int</span>(np.<span class="bu">max</span>(events.<span class="bu">list</span>)<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> rpl(</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    presentations[list_types<span class="op">==</span>condition], trials[list_types<span class="op">==</span>condition], </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    subject_count, trial_count, list_length)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>sns.barplot(ax<span class="op">=</span>axes[<span class="dv">0</span>], data<span class="op">=</span>data, x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>sim_data <span class="op">=</span> rpl(</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    sim_presentations[<span class="dv">3</span>], sim_trials[<span class="dv">3</span>],</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    subject_count, trial_count, list_length)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>sns.barplot(ax<span class="op">=</span>axes[<span class="dv">1</span>], data<span class="op">=</span>sim_data, x<span class="op">=</span><span class="st">'lag'</span>, y<span class="op">=</span><span class="st">'prob'</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Recall Probability by Spacing"</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</main> <!-- /main -->
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->


</body></html>